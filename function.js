🔁 書籤資料轉程式碼段

請從 Excel 複製並貼上資料（第一行為：title url category tag note）：


⚙️ 轉換
輸出結果：

＊＊＊＊＊第1段程式碼開始/A17.06ok /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const TOKEN_STORAGE_KEY='euisToken';const A17_TEXT_SETTINGS_STORAGE_KEY='kgilifeQueryTool_A17TextSettings_v3';const TOOL_MAIN_CONTAINER_ID='kgilifeQueryToolMainContainer_vFinal';const Z_INDEX_OVERLAY=2147483640;const Z_INDEX_MAIN_UI=2147483630;const Z_INDEX_NOTIFICATION=2147483647;const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}];const%20FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8',_queriedValue_:'%E6%9F%A5%E8%A9%A2%E5%80%BC',NO:'%E5%BA%8F%E8%99%9F',_apiQueryStatus:'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C'};const%20ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'];const%20UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'};const%20A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1%E5%96%AE%E4%BD%8D',color:'#546e7a'}];const%20UNIT_MAP_FIELD_API_KEY='uwApproverUnit';const%20A17_DEFAULT_TEXT_CONTENT=%22DEAR,\n\n%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E4%BB%A5%E5%8F%8A%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82\n\n%E6%9C%AC%E9%80%B1%E6%88%91%E5%80%91%E5%B7%B2%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E8%A9%B2%E7%AD%89%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%EF%BC%8C%E7%B5%90%E6%9E%9C%E9%A1%AF%E7%A4%BA%EF%BC%8C%E9%80%99%E4%BA%9B%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%E3%80%82%E7%82%BA%E5%88%A9%E5%BE%8C%E7%BA%8C%E5%B8%B3%E5%8B%99%E8%99%95%E7%90%86%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%AF%A6%E9%9A%9B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E4%B8%A6%E5%A6%82%E6%9C%89%E9%9C%80%E8%AA%BF%E6%95%B4%E6%88%96%E8%99%95%E7%90%86%E4%BA%8B%E9%A0%85%EF%BC%8C%E8%AB%8B%E4%B8%80%E4%BD%B5%E5%8D%94%E5%8A%A9%E8%BE%A6%E7%90%86%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;let%20CURRENT_API_URL='';let%20apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY);let%20selectedQueryDefinitionGlobal=QUERYABLE_FIELD_DEFINITIONS[0];let%20originalQueryResults=[];let%20baseA17MasterData=[];let%20currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:!1,mainUIElement:null,tableBodyElement:null,tableHeadElement:null,a17UnitButtonsContainer:null,};let%20a17ModeState={isActive:!1,selectedUnits:new%20Set(),textSettings:{mainContent:A17_DEFAULT_TEXT_CONTENT,mainFontSize:12,mainLineHeight:1.5,mainFontColor:'#333333',dateFontSize:8,dateLineHeight:1.2,dateFontColor:'#555555',genDateOffset:-3,compDateOffset:0,},};let%20csvImportState={fileName:'',rawHeaders:[],rawData:[],selectedColForQueryName:null,selectedColsForA17Merge:[],isA17CsvPrepared:!1,};let%20isEditMode=!1;let%20dragState={dragging:!1,startX:0,startY:0,initialX:0,initialY:0};let%20a17ButtonLongPressTimer=null;function%20escapeHtml(unsafe){if(typeof%20unsafe!=='string')return%20unsafe===null||unsafe===undefined?'':String(unsafe);return%20unsafe.replace(/[&%3C%3E%22']/g,m=%3E({'&':'&','%3C':'<','%3E':'>','%22':'
＊＊＊＊＊第1段程式碼結束/A17.06ok /＊＊＊＊＊




＊＊＊＊＊第2段程式碼開始/A17.06 /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',TOKEN_STORAGE_KEY='euisToken',Z_INDEX_DIALOG=2147483640,Z_INDEX_MAIN_UI=2147483630,Z_INDEX_NOTIFICATION=2147483647;let CURRENT_API_URL='',apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY),selectedQueryDefinitionGlobal=null,originalQueryResults=[],baseA17MasterData=[],isEditMode=false,currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,isCSVImportModeGlobal:false},a17ModeState={isActive:false,selectedUnits:new Set(),sortedData:[]},csvImportState={isImported:false,headers:[],selectedColumn:null,fileName:'',csvHeaders:[]};const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}],ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'],FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8'},UNIT_MAP_FIELD_API_KEY='uwApproverUnit',UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}],A17_CSV_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'],A17_API_DATA_DISPLAY_HEADERS=['%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1'],A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''],A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22,A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22,A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;let%20textSettings={content:A17_PARA1+'\n\n'+A17_PARA2_TEMPLATE+'\n\n'+A17_PARA3,fontSize:10.5,lineHeight:1.5};function%20loadTextSettings(){const%20saved=localStorage.getItem('qt_a17_text_settings');if(saved)try{textSettings={...textSettings,...JSON.parse(saved)}}catch(e){}}function%20saveTextSettings(){localStorage.setItem('qt_a17_text_settings',JSON.stringify(textSettings))}function%20escapeHtml(s){return%20s===undefined||s===null?'':String(s).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第2段程式碼結束/A17.06 /＊＊＊＊＊




＊＊＊＊＊第3段程式碼開始/Goog /＊＊＊＊＊
javascript:(async()=>{ const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query'; const API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query'; let CURRENT_API_URL=''; const TOKEN_STORAGE_KEY='euisToken'; const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}];%20let%20selectedQueryDefinitionGlobal=null;%20const%20ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'];%20const%20FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B'};%20const%20UNIT_MAP_FIELD_API_KEY='uwApproverUnit';%20const%20UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'};%20const%20APPROVER_FIELD_API_KEY='uwApprover';%20const%20APPROVAL_USER_FIELD_API_KEY='approvalUser';%20const%20SPECIAL_QUERIED_VALUE_KEY='_queriedValue_';%20const%20A17_BUTTON_TEXT=%22A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%22;%20const%20A17_REPORT_NAME=%22A17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%22;%20const%20A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22;%20const%20A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9A{{REPORT_NAME}}%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22;%20const%20A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;%20const%20A17_GEN_DATE_OFFSET_DAYS=-3;%20const%20A17_COMP_DATE_OFFSET_DAYS=0;%20const%20A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}];%20const%20A17_CSV_DATA_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'];%20const%20A17_API_DATA_DISPLAY_HEADERS=['%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1'];%20const%20A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''];%20let%20baseA17MasterData=[];%20let%20activeA17UnitButtonElement=null;%20let%20apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY);%20let%20originalQueryResults=[];%20let%20currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,mainTableSortState:{columnIndex:1,direction:'asc'},isCSVImportModeGlobal:false};%20let%20importedCSVRawData=null;%20const%20V_SUFFIX='_vFinal';%20const%20sleep=t=%3Enew%20Promise(r=%3EsetTimeout(r,t));%20const%20escapeHtml=unsafe=%3Eunsafe===undefined||unsafe===null?'':String(unsafe).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第3段程式碼結束/Goog /＊＊＊＊＊




＊＊＊＊＊第4段程式碼開始/NewA17序號 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),API_URL='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'],fieldNames={receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},uwApprover:'%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1',approvalUser:'%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'};let token=localStorage.getItem('euisToken');while(!token){token=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E8%BC%B8%E5%85%A5');if(!token)return alert('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2');localStorage.setItem('euisToken',token);}const input=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%88%E7%94%A8%E7%A9%BA%E6%A0%BC%E3%80%81%E9%80%97%E8%99%9F%E3%80%81%E5%88%86%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89');if(!input)return;const numbers=input.split(/[\s,;\n]+/).map(x=>x.trim()).filter(Boolean);if(numbers.length===0)return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E5%96%AE%E8%99%9F');let results=[],counter=1;for(const num of numbers){let retries=3,success=false;while(retries-->0&&!success)try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,receiptNumber:num})}),data=await res.json();if(data.records&&data.records.length){data.records.forEach(record=>{const row={'%E5%BA%8F%E8%99%9F':counter++,'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=>{if(f==='uwApproverUnit'){const apiValue=record[f]||'';let firstLetter='';for(let i=0;i<apiValue.length;i++){if(/[A-Za-z]/.test(apiValue.charAt(i))){firstLetter=apiValue.charAt(i).toUpperCase();break;}}const mappedValue=firstLetter&&fieldNames[f][firstLetter]?fieldNames[f][firstLetter]:apiValue;row[%27%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D%27]=firstLetter?firstLetter+%27-%27+mappedValue.replace(/^[A-Za-z]-/,%27%27):mappedValue;}else{row[fieldNames[f]]=record[f]||%27%27}});results.push(row)});success=true}else{const%20row={%27%E5%BA%8F%E8%99%9F%27:counter++,%27%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%27:num};fields.slice(1).forEach(f=%3Erow[f===%27uwApproverUnit%27?%27%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D%27:fieldNames[f]]=%27%27);results.push(row);success=true}}catch(e){console.error(`%E9%8C%AF%E8%AA%A4%EF%BC%9A${num}`,e);await%20sleep(1000);}await%20sleep(1000);}let%20container=document.getElementById(%27queryPreviewContainer%27);if(container)container.remove();container=document.createElement(%27div%27);container.id=%27queryPreviewContainer%27;container.style=%27position:fixed;top:30px;left:30px;z-index:99999;background:#fff;padding:18px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;max-height:80vh;overflow:auto;font-size:14px;';const%20table=document.createElement('table');table.style='border-collapse:collapse;min-width:900px;';const%20headers=['%E5%BA%8F%E8%99%9F','%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])],trh=document.createElement('tr');headers.forEach(h=%3E{const%20th=document.createElement('th');th.textContent=h;th.style='border:1px%20solid%20#ccc;padding:4px%208px;background:#f6f6f6;';trh.appendChild(th);});table.appendChild(trh);results.forEach(row=%3E{const%20tr=document.createElement('tr');headers.forEach(h=%3E{const%20td=document.createElement('td');td.textContent=row[h]||'';td.style='border:1px%20solid%20#ccc;padding:4px%208px;';tr.appendChild(td)});table.appendChild(tr)});container.innerHTML='%3Cdiv%20style=%22font-weight:bold;margin-bottom:8px;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E9%A0%90%E8%A6%BD%3C/div%3E';container.appendChild(table);const%20btnCopy=document.createElement('button'),btnExcel=document.createElement('button'),btnClose=document.createElement('button');btnCopy.textContent='%E8%A4%87%E8%A3%BD';btnExcel.textContent='%E4%B8%8B%E8%BC%89%20Excel';btnClose.textContent='%E9%97%9C%E9%96%89';[btnCopy,btnExcel,btnClose].forEach(btn=%3Ebtn.style='margin:12px%208px%200%200;font-size:14px;');btnCopy.onclick=()=%3E{const%20rows=[headers,...results.map(row=%3Eheaders.map(h=%3Erow[h]||''))];navigator.clipboard.writeText(rows.map(r=%3Er.join('\t')).join('\n')).then(()=%3E{btnCopy.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';setTimeout(()=%3EbtnCopy.textContent='%E8%A4%87%E8%A3%BD',1200);})};btnExcel.onclick=async()=%3E{if(!window.XLSX){const%20s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';document.body.appendChild(s);await%20new%20Promise(r=%3Es.onload=r);}const%20wb=XLSX.utils.book_new(),ws=XLSX.utils.json_to_sheet(results);XLSX.utils.book_append_sheet(wb,ws,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C');XLSX.writeFile(wb,%60%E9%80%81%E9%87%91%E5%96%AE%E6%9F%A5%E8%A9%A2_${new%20Date().toISOString().slice(0,10)}.xlsx%60)};btnClose.onclick=()=%3Econtainer.remove();container.appendChild(document.createElement('br'));container.appendChild(btnCopy);container.appendChild(btnExcel);container.appendChild(btnClose);document.body.appendChild(container);})();
＊＊＊＊＊第4段程式碼結束/NewA17序號 /＊＊＊＊＊




＊＊＊＊＊第5段程式碼開始/FinaA17 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),API_URL='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'],fieldNames={receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},uwApprover:'%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1',approvalUser:'%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1'};let token=localStorage.getItem('euisToken');while(!token){token=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E8%BC%B8%E5%85%A5');if(!token)return alert('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2');localStorage.setItem('euisToken',token);}const input=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%88%E7%94%A8%E7%A9%BA%E6%A0%BC%E3%80%81%E9%80%97%E8%99%9F%E3%80%81%E5%88%86%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89');if(!input)return;const numbers=input.split(/[\s,;\n]+/).map(x=>x.trim()).filter(Boolean);if(numbers.length===0)return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E5%96%AE%E8%99%9F');let results=[],counter=1;for(const num of numbers){let retries=3,success=false;while(retries-->0&&!success)try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,receiptNumber:num})}),data=await res.json();if(data.records&&data.records.length){data.records.forEach(record=>{const row={'%E5%BA%8F%E8%99%9F':counter++,'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=>{if(f==='uwApproverUnit'){const apiValue=record[f]||'';let firstLetter='';for(let i=0;i<apiValue.length;i++){if(/[A-Za-z]/.test(apiValue.charAt(i))){firstLetter=apiValue.charAt(i).toUpperCase();break;}}const mappedValue=firstLetter&&fieldNames[f][firstLetter]?fieldNames[f][firstLetter]:apiValue;row[%27%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D%27]=firstLetter?firstLetter+%27-%27+mappedValue.replace(/^[A-Za-z]-/,%27%27):mappedValue;}else{row[fieldNames[f]]=record[f]||%27%27}});results.push(row)});success=true}else{const%20row={%27%E5%BA%8F%E8%99%9F%27:counter++,%27%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%27:num};fields.slice(1).forEach(f=%3Erow[f===%27uwApproverUnit%27?%27%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D%27:fieldNames[f]]=%27%27);results.push(row);success=true}}catch(e){console.error(`%E9%8C%AF%E8%AA%A4%EF%BC%9A${num}`,e);await%20sleep(1000);}await%20sleep(1000);}let%20container=document.getElementById(%27queryPreviewContainer%27);if(container)container.remove();container=document.createElement(%27div%27);container.id=%27queryPreviewContainer%27;container.style=%27position:fixed;top:30px;left:30px;z-index:99999;background:#f9f9f9;padding:18px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;max-height:80vh;overflow:auto;font-size:14px;font-family:Arial,sans-serif;';const%20table=document.createElement('table');table.style='border-collapse:collapse;min-width:900px;width:100%;';const%20headers=['%E5%BA%8F%E8%99%9F','%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])],trh=document.createElement('tr');headers.forEach(h=%3E{const%20th=document.createElement('th');th.textContent=h;th.style='border:1px%20solid%20#ccc;padding:8px%2012px;background:#f0f0f0;text-align:left;font-weight:bold;';trh.appendChild(th);});table.appendChild(trh);results.forEach(row=%3E{const%20tr=document.createElement('tr');headers.forEach(h=%3E{const%20td=document.createElement('td');td.textContent=row[h]||'';td.style='border:1px%20solid%20#ddd;padding:8px%2012px;background:#fff;font-size:13px;';tr.appendChild(td)});table.appendChild(tr)});container.innerHTML='%3Cdiv%20style=%22font-weight:bold;margin-bottom:8px;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E9%A0%90%E8%A6%BD%3C/div%3E';container.appendChild(table);const%20btnCopy=document.createElement('button'),btnExcel=document.createElement('button'),btnClose=document.createElement('button');btnCopy.textContent='%E8%A4%87%E8%A3%BD';btnExcel.textContent='%E4%B8%8B%E8%BC%89%20Excel';btnClose.textContent='%E9%97%9C%E9%96%89';[btnCopy,btnExcel,btnClose].forEach(btn=%3Ebtn.style='margin:12px%208px%200%200;font-size:14px;padding:8px%2012px;border-radius:4px;border:none;background-color:#007BFF;color:#fff;cursor:pointer;');btnCopy.onmouseover=()=%3EbtnCopy.style.backgroundColor='#0056b3';btnCopy.onmouseout=()=%3EbtnCopy.style.backgroundColor='#007BFF';btnClose.style='background-color:#007BFF;';btnClose.onmouseover=()=%3EbtnClose.style.backgroundColor='#0056b3';btnClose.onmouseout=()=%3EbtnClose.style.backgroundColor='#007BFF';btnCopy.onclick=()=%3E{const%20rows=[headers,...results.map(row=%3Eheaders.map(h=%3Erow[h]||''))];navigator.clipboard.writeText(rows.map(r=%3Er.join('\t')).join('\n')).then(()=%3E{btnCopy.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';setTimeout(()=%3EbtnCopy.textContent='%E8%A4%87%E8%A3%BD',1200);})};btnExcel.onclick=async()=%3E{if(!window.XLSX){const%20s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';document.body.appendChild(s);await%20new%20Promise(r=%3Es.onload=r);}const%20wb=XLSX.utils.book_new(),ws=XLSX.utils.json_to_sheet(results);XLSX.utils.book_append_sheet(wb,ws,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C');XLSX.writeFile(wb,%60%E9%80%81%E9%87%91%E5%96%AE%E6%9F%A5%E8%A9%A2_${new%20Date().toISOString().slice(0,10)}.xlsx%60)};btnClose.onclick=()=%3Econtainer.remove();container.appendChild(document.createElement('br'));container.appendChild(btnCopy);container.appendChild(btnExcel);container.appendChild(btnClose);document.body.appendChild(container);})();
＊＊＊＊＊第5段程式碼結束/FinaA17 /＊＊＊＊＊




＊＊＊＊＊第6段程式碼開始/選單A17U查無 /＊＊＊＊＊
javascript:(async()=>{const c={u:'https://euisv-uat.tapps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',t:1000,q:{'1':{l:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',k:'receiptNumber'},'2':{l:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',k:'applyNumber'},'3':{l:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',k:'policyNumber'}},m:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'}},u={d:t=>new Promise(r=>setTimeout(r,t)),t:()=>{let t=localStorage.getItem('euisToken');return t||(t=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E8%BC%B8%E5%85%A5'))&&localStorage.setItem('euisToken',t),t},p:t=>(t||'').match(/[\u4e00-\u9fa5]+/)?.[0]||%27%27,f:t=%3Et?`${t}-${c.m[t]||t}`:%27%27},q=async(t,n)=%3E{const%20o=u.t();if(!o)return%20alert(%27%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2%27),[],[];const%20r=[];for(const[e,a]of%20n.entries())try{const%20n=await%20fetch(c.u,{method:%27POST%27,headers:{%27Content-Type%27:%27application/json%27,%27SSO-TOKEN%27:o},body:JSON.stringify({currentPage:1,pageSize:10,[t.k]:a})}),l=await%20n.json(),s=l.records?.[0]||{};r.push({%E5%BA%8F%E8%99%9F:e+1,[t.l]:a,%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC:s.policyNumber||%27%27,%E4%B8%BB%E7%8B%80%E6%85%8B:s.mainStatus||%27%27,%E6%AC%A1%E7%8B%80%E6%85%8B:s.subStatus||%27%27,%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D:u.f(s.uwApproverUnit),%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1:u.p(s.uwApprover),%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1:u.p(s.approvalUser)})}catch(t){console.error(`%E6%9F%A5%E8%A9%A2%20${a}%20%E5%A4%B1%E6%95%97%EF%BC%9A`,t),r.push({%E5%BA%8F%E8%99%9F:e+1,[t.l]:a,%E9%8C%AF%E8%AA%A4:%27%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97%27})}return%20await%20u.d(c.t),r},m=async()=%3E{const%20t=prompt(Object.entries(c.q).map(([t,{l:n}])=%3E`${t}:%20${n}`).join(%27\n%27)+%27\n%E8%AB%8B%E9%81%B8%E6%93%87%E6%9F%A5%E8%A9%A2%E6%AC%84%E4%BD%8D:%27),n=c.q[t];if(!n)return%20void%20alert(%27%E7%84%A1%E6%95%88%E7%9A%84%E6%9F%A5%E8%A9%A2%E6%AC%84%E4%BD%8D%27);const%20o=prompt(`%E8%AB%8B%E8%BC%B8%E5%85%A5${n.l}%EF%BC%88%E7%94%A8%E7%A9%BA%E6%A0%BC%E3%80%81%E9%80%97%E8%99%9F%E3%80%81%E5%88%86%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89`);if(!o)return;const%20r=o.split(/[\s,;\n]+/).filter(Boolean);if(0===r.length)return%20void%20alert(%27%E6%9C%AA%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E7%9A%84%E6%9F%A5%E8%A9%A2%E5%80%BC%27);const%20e=await%20q(n,r),a=document.createElement(%27div%27);a.id=%27queryPreviewContainer%27,a.style=`position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:99999;background:#f9f9f9;padding:12px;border-radius:8px;box-shadow:0%202px%2010px%20rgba(0,0,0,0.1);min-width:400px;max-width:90%;overflow:auto;font-family:Arial;%60;const%20l=document.createElement('table');l.style='border-collapse:collapse;width:100%;',l.innerHTML=%60%3Cthead%3E%3Ctr%20style=%22background:#f0f0f0;%22%3E${['%E5%BA%8F%E8%99%9F',n.l,'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E4%B8%BB%E7%8B%80%E6%85%8B','%E6%AC%A1%E7%8B%80%E6%85%8B','%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D','%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1','%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'].map(t=%3E%60%3Cth%20style=%22padding:6px%208px;text-align:left;%22%3E${t}%3C/th%3E%60).join('')}%3C/tr%3E%3C/thead%3E%3Ctbody%3E${e.map((t,o)=%3E%60%3Ctr%20style=%22background:${o%2==0?'#fff':'#f8f8f8'};%22%3E${['%E5%BA%8F%E8%99%9F',n.l,'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E4%B8%BB%E7%8B%80%E6%85%8B','%E6%AC%A1%E7%8B%80%E6%85%8B','%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D','%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1','%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'].map(n=%3E%60%3Ctd%20style=%22padding:6px%208px;%22%3E${t[n]||''}%3C/td%3E%60).join('')}%3C/tr%3E%60).join('')}%3C/tbody%3E%60;const%20s=document.createElement('div');s.style='display:flex;justify-content:flex-end;gap:6px;margin-top:8px;';['%E8%A4%87%E8%A3%BD','Excel','%E9%97%9C%E9%96%89'].forEach((t,o)=%3E{const%20r=document.createElement('button');r.textContent=t,r.style='padding:4px%208px;border:none;color:white;border-radius:3px;cursor:pointer;',r.style.background=0===o?'#4CAF50':1===o?'#2196F3':'#f44336',r.onclick=0===o?()=%3E{const%20t=[['%E5%BA%8F%E8%99%9F',n.l,'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E4%B8%BB%E7%8B%80%E6%85%8B','%E6%AC%A1%E7%8B%80%E6%85%8B','%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D','%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1','%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'],...e.map(t=%3E['%E5%BA%8F%E8%99%9F',n.l,'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E4%B8%BB%E7%8B%80%E6%85%8B','%E6%AC%A1%E7%8B%80%E6%85%8B','%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D','%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1','%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'].map(n=%3Et[n]||''))];navigator.clipboard.writeText(t.map(t=%3Et.join('\t')).join('\n')).then(()=%3E{r.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!'});}:1===o?async()=%3E{window.XLSX||(await%20new%20Promise(t=%3E{const%20n=document.createElement('script');n.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js',document.body.appendChild(n),n.onload=t}));const%20t=XLSX.utils.book_new(),n=XLSX.utils.json_to_sheet(e);XLSX.utils.book_append_sheet(t,n,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C'),XLSX.writeFile(t,%60%E6%9F%A5%E8%A9%A2_${new%20Date().toISOString().slice(0,10)}.xlsx%60)}:()=%3Ea.remove(),s.appendChild(r)});a.appendChild(l),a.appendChild(s),document.body.appendChild(a)};m()})();
＊＊＊＊＊第6段程式碼結束/選單A17U查無 /＊＊＊＊＊




＊＊＊＊＊第7段程式碼開始/A17QQ /＊＊＊＊＊
javascript:(async()=>{%C2%A0%C2%A0%C2%A0 const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';%C2%A0 const API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';%C2%A0 const TOKEN_STORAGE_KEY='euisToken';%C2%A0 const A17_TEXT_SETTINGS_STORAGE_KEY='kgilifeQueryTool_A17TextSettings_v3';%C2%A0 const TOOL_MAIN_CONTAINER_ID='kgilifeQueryToolMainContainer_vFinal';%C2%A0 const Z_INDEX_OVERLAY=2147483640;%C2%A0 const Z_INDEX_MAIN_UI=2147483630;%C2%A0 const Z_INDEX_NOTIFICATION=2147483647;%C2%A0 const QUERYABLE_FIELD_DEFINITIONS=[%C2%A0 %C2%A0{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#5c9ded'},%C2%A0%20%C2%A0{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#a08cd0'},%C2%A0%20%C2%A0{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#67c17f'},%C2%A0%20%C2%A0{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fca855'},%C2%A0%20%C2%A0{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#5bb9c8'}%C2%A0];%C2%A0%20const%20FIELD_DISPLAY_NAMES_MAP={%C2%A0%20%C2%A0%20applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',%C2%A0%20%C2%A0%20receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',%C2%A0%20%C2%A0%20mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',%C2%A0%20%C2%A0%20uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8',_queriedValue_:'%E6%9F%A5%E8%A9%A2%E5%80%BC',%C2%A0%20%C2%A0%20NO:'%E5%BA%8F%E8%99%9F',_apiQueryStatus:'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C'%C2%A0};%C2%A0%20const%20ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'];%C2%A0%20const%20UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'};%C2%A0%20const%20A17_UNIT_BUTTONS_DEFS=[%C2%A0%20%C2%A0{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},%C2%A0%20%C2%A0{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},%C2%A0%20%C2%A0{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},%C2%A0%20%C2%A0{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1%E5%96%AE%E4%BD%8D',color:'#546e7a'}%C2%A0];%C2%A0%20const%20UNIT_MAP_FIELD_API_KEY='uwApproverUnit';%C2%A0%20const%20A17_DEFAULT_TEXT_CONTENT=%22DEAR,\n\n%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E4%BB%A5%E5%8F%8A%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82\n\n%E6%9C%AC%E9%80%B1%E6%88%91%E5%80%91%E5%B7%B2%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E8%A9%B2%E7%AD%89%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%EF%BC%8C%E7%B5%90%E6%9E%9C%E9%A1%AF%E7%A4%BA%EF%BC%8C%E9%80%99%E4%BA%9B%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%E3%80%82%E7%82%BA%E5%88%A9%E5%BE%8C%E7%BA%8C%E5%B8%B3%E5%8B%99%E8%99%95%E7%90%86%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%AF%A6%E9%9A%9B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E4%B8%A6%E5%A6%82%E6%9C%89%E9%9C%80%E8%AA%BF%E6%95%B4%E6%88%96%E8%99%95%E7%90%86%E4%BA%8B%E9%A0%85%EF%BC%8C%E8%AB%8B%E4%B8%80%E4%BD%B5%E5%8D%94%E5%8A%A9%E8%BE%A6%E7%90%86%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;%C2%A0%C2%A0%20let%20CURRENT_API_URL='';%C2%A0%20let%20apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY);%C2%A0%20let%20selectedQueryDefinitionGlobal=QUERYABLE_FIELD_DEFINITIONS[0];%C2%A0%20let%20originalQueryResults=[];%C2%A0%20let%20baseA17MasterData=[];%C2%A0%20let%20currentTableInstance={%C2%A0%20%C2%A0%20sortDirections:{},currentHeaders:[],isA17Mode:!1,mainUIElement:null,%C2%A0%20%C2%A0%20tableBodyElement:null,tableHeadElement:null,a17UnitButtonsContainer:null,%C2%A0};%C2%A0%20let%20a17ModeState={%C2%A0%20%C2%A0%20isActive:!1,selectedUnits:new%20Set(),%C2%A0%20%C2%A0%20textSettings:{%C2%A0%20%C2%A0%20%C2%A0%20mainContent:A17_DEFAULT_TEXT_CONTENT,mainFontSize:12,mainLineHeight:1.5,mainFontColor:'#333333',%C2%A0%20%C2%A0%20%C2%A0%20dateFontSize:8,dateLineHeight:1.2,dateFontColor:'#555555',%C2%A0%20%C2%A0%20%C2%A0%20genDateOffset:-3,compDateOffset:0,%C2%A0%20%C2%A0},%C2%A0};%C2%A0%20let%20csvImportState={%C2%A0%20%C2%A0%20fileName:'',rawHeaders:[],rawData:[],%C2%A0%20%C2%A0%20selectedColForQueryName:null,%C2%A0%C2%A0%20%C2%A0%20selectedColsForA17Merge:[],isA17CsvPrepared:!1,%C2%A0};%C2%A0%20let%20isEditMode=!1;%C2%A0%20let%20dragState={dragging:!1,startX:0,startY:0,initialX:0,initialY:0};%C2%A0%20let%20a17ButtonLongPressTimer=null;%C2%A0%C2%A0%C2%A0%C2%A0%20function%20escapeHtml(unsafe){if(typeof%20unsafe!=='string')return%20unsafe===null||unsafe===undefined?'':String(unsafe);return%20unsafe.replace(/[&%3C%3E%22']/g,m=%3E({'&':'&','%3C':'<','%3E':'>','%22':'
＊＊＊＊＊第7段程式碼結束/A17QQ /＊＊＊＊＊




＊＊＊＊＊第8段程式碼開始/多選單>>但無法執行 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),loadSheetJS=()=>new Promise((r,o)=>{if(window.XLSX)return r();const s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';s.onload=r;s.onerror=o;document.body.appendChild(s);});await loadSheetJS();const token=localStorage.getItem('euisToken');if(!token)return alert('%E6%89%BE%E4%B8%8D%E5%88%B0token%EF%BC%8C%E8%AB%8B%E5%85%88%E7%99%BB%E5%85%A5%E7%B3%BB%E7%B5%B1%EF%BC%81');const queryFields=[{key:'receiptNumber',label:'%E6%94%B6%E6%93%9A%E8%99%9F%E7%A2%BC'},{key:'applyNumber',label:'%E7%94%B3%E8%AB%8B%E7%B7%A8%E8%99%9F'},{key:'policyNumber',label:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC'},{key:'approvalNumber',label:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F'}],dataFields=[
＊＊＊＊＊第8段程式碼結束/多選單>>但無法執行 /＊＊＊＊＊




＊＊＊＊＊第9段程式碼開始/UI查詢功能增強>>選單多但查無+預覽 /＊＊＊＊＊
javascript:(async()=>{   const sleep = t => new Promise(r => setTimeout(r, t));   const loadSheetJS = () => new Promise((r, o) => {     if (window.XLSX) return r();     const s = document.createElement('script');     s.src = 'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';     s.onload = r;     s.onerror = o;     document.body.appendChild(s);   });   await loadSheetJS();    const token = localStorage.getItem('euisToken');   if (!token) return void alert('%E6%89%BE%E4%B8%8D%E5%88%B0token%EF%BC%8C%E8%AB%8B%E5%85%88%E7%99%BB%E5%85%A5%E7%B3%BB%E7%B5%B1%EF%BC%81');    const queryType = prompt('%E8%AB%8B%E9%81%B8%E6%93%87%E6%9F%A5%E8%A9%A2%E9%A1%9E%E5%9E%8B%EF%BC%9A\n1. %E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC (receiptNumber)\n2. %E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC (applyNumber)\n3. %E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F (approvalNumber)\n4. %E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC (policyNumber)\n\n%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%95%B8%E5%AD%97 (1~4)%EF%BC%9A');   if (!queryType) return;    const queryFieldMap = {     '1': 'receiptNumber',     '2': 'applyNumber',     '3': 'approvalNumber',     '4': 'policyNumber'   };   const field = queryFieldMap[queryType.trim()];   if (!field) return void alert('%E7%84%A1%E6%95%88%E7%9A%84%E9%81%B8%E9%A0%85%EF%BC%81');    const input = prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2%E8%B3%87%E6%96%99%EF%BC%88%E9%80%97%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89%EF%BC%9A');   if (!input) return;    const inputs = input.split(/\n|,/).map(x => x.trim()).filter(Boolean);   const fields = [
＊＊＊＊＊第9段程式碼結束/UI查詢功能增強>>選單多但查無+預覽 /＊＊＊＊＊




＊＊＊＊＊第10段程式碼開始/A17 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t));let API_URL='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'];const fieldNames={receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},uwApprover:'%E6%89%BF%E8%BE%A6',approvalUser:'%E8%A6%86%E6%A0%B8'};let token=localStorage.getItem('euisToken'),originalResults=[];function createInputDialog(title,placeholder,isPassword=false,isTextarea=true){return new Promise(resolve=>{const overlay=document.createElement('div');overlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:999999;display:flex;align-items:center;justify-content:center;';const dialog=document.createElement('div');dialog.style.cssText='background:white;padding:30px;border-radius:15px;box-shadow:0 15px 50px rgba(0,0,0,0.4);min-width:500px;max-width:80vw;';dialog.innerHTML=`<h3 style=
＊＊＊＊＊第10段程式碼結束/A17 /＊＊＊＊＊




＊＊＊＊＊第11段程式碼開始/A17(O) /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t));const API_URL='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'];const fieldNames={receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},uwApprover:'%E6%89%BF%E8%BE%A6',approvalUser:'%E8%A6%86%E6%A0%B8'};let token=localStorage.getItem('euisToken'),originalResults=[];function createInputDialog(title,placeholder,isPassword=false){return new Promise(resolve=>{const overlay=document.createElement('div');overlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:999999;display:flex;align-items:center;justify-content:center;';const dialog=document.createElement('div');dialog.style.cssText='background:white;padding:30px;border-radius:15px;box-shadow:0 15px 50px rgba(0,0,0,0.4);min-width:500px;max-width:80vw;';dialog.innerHTML=`<h3 style=
＊＊＊＊＊第11段程式碼結束/A17(O) /＊＊＊＊＊




＊＊＊＊＊第12段程式碼開始/A17.1 /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let CURRENT_API_URL='';const TOKEN_STORAGE_KEY='euisToken';const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}];let%20selectedQueryDefinitionGlobal=null;const%20ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'];const%20FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B'};const%20UNIT_MAP_FIELD_API_KEY='uwApproverUnit';const%20UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'};const%20APPROVER_FIELD_API_KEY='uwApprover';const%20APPROVAL_USER_FIELD_API_KEY='approvalUser';const%20SPECIAL_QUERIED_VALUE_KEY='_queriedValue_';const%20A17_BUTTON_TEXT=%22A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%22;const%20A17_REPORT_NAME=%22A17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%22;const%20A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22;const%20A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9A{{REPORT_NAME}}%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22;const%20A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;const%20A17_GEN_DATE_OFFSET_DAYS=-3;const%20A17_COMP_DATE_OFFSET_DAYS=0;const%20A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}];const%20A17_CSV_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'];const%20A17_API_DATA_DISPLAY_HEADERS=['%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1'];const%20A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''];let%20baseA17MasterData=[];let%20activeA17UnitButtonElement=null;let%20apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY);let%20originalQueryResults=[];let%20currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,mainTableSortState:{columnIndex:1,direction:'asc'},isCSVImportModeGlobal:false};let%20importedCSVRawData=null;const%20sleep=t=%3Enew%20Promise(r=%3EsetTimeout(r,t));const%20escapeHtml=unsafe=%3Eunsafe===undefined||unsafe===null?'':String(unsafe).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第12段程式碼結束/A17.1 /＊＊＊＊＊




＊＊＊＊＊第13段程式碼開始/A17.2 /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let CURRENT_API_URL='';const TOKEN_STORAGE_KEY='euisToken';const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}];let%20selectedQueryDefinitionGlobal=null;const%20ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'];const%20FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B'};const%20UNIT_MAP_FIELD_API_KEY='uwApproverUnit';const%20UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'};const%20APPROVER_FIELD_API_KEY='uwApprover';const%20APPROVAL_USER_FIELD_API_KEY='approvalUser';const%20SPECIAL_QUERIED_VALUE_KEY='_queriedValue_';const%20A17_BUTTON_TEXT=%22A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%22;const%20A17_REPORT_NAME=%22A17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%22;const%20A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22;const%20A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9A{{REPORT_NAME}}%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22;const%20A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;const%20A17_GEN_DATE_OFFSET_DAYS=-3;const%20A17_COMP_DATE_OFFSET_DAYS=0;const%20A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}];const%20A17_CSV_DATA_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'];const%20A17_API_DATA_DISPLAY_HEADERS=['%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1'];const%20A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''];let%20baseA17MasterData=[];let%20activeA17UnitButtonElement=null;let%20apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY);let%20originalQueryResults=[];let%20currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,mainTableSortState:{columnIndex:1,direction:'asc'},isCSVImportModeGlobal:false};let%20importedCSVRawData=null;const%20sleep=t=%3Enew%20Promise(r=%3EsetTimeout(r,t));const%20escapeHtml=unsafe=%3Eunsafe===undefined||unsafe===null?'':String(unsafe).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第13段程式碼結束/A17.2 /＊＊＊＊＊




＊＊＊＊＊第14段程式碼開始/A17.4 /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let CURRENT_API_URL='';const TOKEN_STORAGE_KEY='euisToken';const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}];let%20selectedQueryDefinitionGlobal=null;const%20ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'];const%20FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B'};const%20UNIT_MAP_FIELD_API_KEY='uwApproverUnit';const%20UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'};const%20APPROVER_FIELD_API_KEY='uwApprover';const%20APPROVAL_USER_FIELD_API_KEY='approvalUser';const%20SPECIAL_QUERIED_VALUE_KEY='_queriedValue_';const%20A17_BUTTON_TEXT=%22A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%22;const%20A17_REPORT_NAME=%22A17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%22;const%20A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22;const%20A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9A{REPORT_NAME}%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22;const%20A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;const%20A17_GEN_DATE_OFFSET_DAYS=-3;const%20A17_COMP_DATE_OFFSET_DAYS=0;const%20A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}];const%20A17_CSV_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'];const%20A17_API_DATA_DISPLAY_HEADERS=['%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1'];const%20A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''];let%20baseA17MasterData=[];let%20activeA17UnitButtonElement=null;let%20apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY);let%20originalQueryResults=[];let%20currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,mainTableSortState:{columnIndex:1,direction:'asc'},isCSVImportModeGlobal:false};let%20importedCSVRawData=null;let%20longPressTimer=null;let%20isLongPress=false;const%20LONG_PRESS_DURATION=800;let%20textSettings={content:A17_PARA1+'\n\n'+A17_PARA2_TEMPLATE+'\n\n'+A17_PARA3,fontSize:10.5,lineHeight:1.5};let%20a17ModeState={isActive:false,selectedUnits:new%20Set(),sortedData:[]};const%20sleep=t=%3Enew%20Promise(r=%3EsetTimeout(r,t));const%20escapeHtml=unsafe=%3Eunsafe===undefined||unsafe===null?'':String(unsafe).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第14段程式碼結束/A17.4 /＊＊＊＊＊




＊＊＊＊＊第15段程式碼開始/單條件保守-A17 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t));let API_URL='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'];const fieldNames={receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},uwApprover:'%E6%89%BF%E8%BE%A6',approvalUser:'%E8%A6%86%E6%A0%B8'};let token=localStorage.getItem('euisToken'),originalResults=[];function createInputDialog(title,placeholder,isPassword=false,isTextarea=true){return new Promise(resolve=>{const overlay=document.createElement('div');overlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:999999;display:flex;align-items:center;justify-content:center;';const dialog=document.createElement('div');dialog.style.cssText='background:#ffffff;padding:25px;border-radius:10px;box-shadow:0%208px%2020px%20rgba(0,0,0,0.2);min-width:350px;max-width:500px;width:85vw;';dialog.innerHTML=%60%3Ch3%20style=%22margin:0%200%2015px%200;color:#333333;font-size:16px;text-align:center;font-weight:600;%22%3E${title}%3C/h3%3E%3C${isPassword?'input%20type=%22password%22':(isTextarea?'textarea':'input')}%20id=%22dialog-input%22%20style=%22width:calc(100%%20-%2020px);padding:10px;border:1px%20solid%20#cccccc;border-radius:5px;font-size:14px;margin-bottom:15px;color:#333333;${isTextarea&&!isPassword?'min-height:80px;resize:vertical;':''}%22%20placeholder=%22${placeholder}%22%3E%3C/${isPassword?'input':(isTextarea?'textarea':'input')}%3E%3Cdiv%20style=%22text-align:center;%22%3E%3Cbutton%20id=%22dialog-cancel%22%20style=%22background:#868e96;color:white;border:none;padding:8px%2016px;border-radius:5px;font-size:14px;cursor:pointer;margin-right:8px;transition:background%200.2s%20ease;%22%3E%E5%8F%96%E6%B6%88%3C/button%3E%3Cbutton%20id=%22dialog-ok%22%20style=%22background:#007bff;color:white;border:none;padding:8px%2016px;border-radius:5px;font-size:14px;cursor:pointer;transition:background%200.2s%20ease;%22%3E%E7%A2%BA%E5%AE%9A%3C/button%3E%3C/div%3E%60;overlay.appendChild(dialog);document.body.appendChild(overlay);const%20input=document.getElementById('dialog-input');input.focus();const%20handleKeyDown=(e)=%3E{if(e.key==='Escape'){document.body.removeChild(overlay);resolve(null);}else%20if(e.key==='Enter'&&!e.shiftKey&&(isPassword||!isTextarea)){e.preventDefault();const%20value=input.value.trim();document.body.removeChild(overlay);resolve(value);}};document.addEventListener('keydown',handleKeyDown);document.getElementById('dialog-ok').onclick=()=%3E{document.removeEventListener('keydown',handleKeyDown);const%20value=input.value.trim();document.body.removeChild(overlay);resolve(value);};document.getElementById('dialog-cancel').onclick=()=%3E{document.removeEventListener('keydown',handleKeyDown);document.body.removeChild(overlay);resolve(null);};document.getElementById('dialog-ok').onmouseover=(e)=%3Ee.target.style.background='#0056b3';document.getElementById('dialog-ok').onmouseout=(e)=%3Ee.target.style.background='#007bff';document.getElementById('dialog-cancel').onmouseover=(e)=%3Ee.target.style.background='#6c757d';document.getElementById('dialog-cancel').onmouseout=(e)=%3Ee.target.style.background='#868e96';});}function%20createEnvironmentDialog(){return%20new%20Promise(resolve=%3E{const%20overlay=document.createElement('div');overlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:999999;display:flex;align-items:center;justify-content:center;';const%20dialog=document.createElement('div');dialog.style.cssText='background:#ffffff;padding:25px;border-radius:10px;box-shadow:0%208px%2020px%20rgba(0,0,0,0.2);min-width:350px;max-width:450px;width:85vw;';dialog.innerHTML=%60%3Ch3%20style=%22margin:0%200%2020px%200;color:#333333;font-size:16px;text-align:center;font-weight:600;%22%3E%E8%AB%8B%E9%81%B8%E6%93%87%E8%A6%81%E5%9F%B7%E8%A1%8C%E7%9A%84%E7%92%B0%E5%A2%83%EF%BC%9A%3C/h3%3E%3Cdiv%20style=%22display:flex;gap:12px;%22%3E%3Cbutton%20id=%22env-test%22%20style=%22flex:1;background:#20c997;color:white;border:none;padding:25px%2012px;border-radius:8px;font-size:18px;font-weight:bold;cursor:pointer;box-shadow:0%202px%208px%20rgba(32,201,151,0.2);transition:all%200.2s%20ease;%22%3E%E6%B8%AC%E8%A9%A6%20(UAT)%3C/button%3E%3Cbutton%20id=%22env-prod%22%20style=%22flex:1;background:#fd7e14;color:white;border:none;padding:25px%2012px;border-radius:8px;font-size:18px;font-weight:bold;cursor:pointer;box-shadow:0%202px%208px%20rgba(253,126,20,0.2);transition:all%200.2s%20ease;%22%3E%E6%AD%A3%E5%BC%8F%20(PROD)%3C/button%3E%3C/div%3E%60;overlay.appendChild(dialog);document.body.appendChild(overlay);const%20handleKeyDown=(e)=%3E{if(e.key==='Escape'){document.body.removeChild(overlay);resolve(null);}};document.addEventListener('keydown',handleKeyDown);document.getElementById('env-test').onclick=()=%3E{document.removeEventListener('keydown',handleKeyDown);document.body.removeChild(overlay);resolve('test');};document.getElementById('env-prod').onclick=()=%3E{document.removeEventListener('keydown',handleKeyDown);document.body.removeChild(overlay);resolve('prod');};document.getElementById('env-test').onmouseover=(e)=%3E{e.target.style.transform='translateY(-1px)';e.target.style.boxShadow='0%204px%2012px%20rgba(32,201,151,0.3)';};document.getElementById('env-test').onmouseout=(e)=%3E{e.target.style.transform='translateY(0)';e.target.style.boxShadow='0%202px%208px%20rgba(32,201,151,0.2)';};document.getElementById('env-prod').onmouseover=(e)=%3E{e.target.style.transform='translateY(-1px)';e.target.style.boxShadow='0%204px%2012px%20rgba(253,126,20,0.3)';};document.getElementById('env-prod').onmouseout=(e)=%3E{e.target.style.transform='translateY(0)';e.target.style.boxShadow='0%202px%208px%20rgba(253,126,20,0.2)';};});}function%20showNotification(message,isError=false){const%20notification=document.createElement('div');notification.style.cssText=%60position:fixed;top:20px;right:20px;background:${isError?'#dc3545':'#20c997'};color:white;padding:10px%2016px;border-radius:6px;z-index:1000000;font-weight:500;font-size:13px;transform:translateX(300px);transition:transform%200.3s%20ease-out;box-shadow:0%203px%2010px%20rgba(0,0,0,0.2);font-family:'Microsoft%20JhengHei',%20Arial,%20sans-serif;display:flex;align-items:center;gap:6px;%60;notification.innerHTML=%60${isError?'%3Cspan%20style=%22font-size:16px;%22%3E✖%3C/span%3E':'%3Cspan%20style=%22font-size:16px;%22%3E✔%3C/span%3E'}%3Cspan%3E${message}%3C/span%3E%60;document.body.appendChild(notification);setTimeout(()=%3Enotification.style.transform='translateX(0)',50);setTimeout(()=%3E{notification.style.transform='translateX(300px)';setTimeout(()=%3Enotification.remove(),300);},3000);}async%20function%20performQuery(){const%20env=await%20createEnvironmentDialog();if(!env){showNotification('%E6%9F%A5%E8%A9%A2%E5%B7%B2%E5%8F%96%E6%B6%88',true);return;}API_URL=env==='prod'?'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query':'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';showNotification(%60%E5%B7%B2%E9%81%B8%E6%93%87${env==='prod'?'%E6%AD%A3%E5%BC%8F':'%E6%B8%AC%E8%A9%A6'}%E7%92%B0%E5%A2%83%60,false);if(!token){token=await%20createInputDialog('API%20TOKEN%20%E8%A8%AD%E5%AE%9A','%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%82%A8%E7%9A%84API%20TOKEN',true,false);if(!token){showNotification('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2%EF%BC%8C%E6%9C%AA%E6%8F%90%E4%BE%9BTOKEN',true);return;}localStorage.setItem('euisToken',token);}const%20input=await%20createInputDialog('%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%E6%9F%A5%E8%A9%A2','%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E5%8F%AF%E8%BC%B8%E5%85%A5%E5%A4%9A%E7%AD%86%EF%BC%8C%E4%B8%A6%E7%94%A8%E7%A9%BA%E6%A0%BC%E3%80%81%E9%80%97%E8%99%9F%E3%80%81%E5%88%86%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%E3%80%82\n%E4%BE%8B%E5%A6%82%EF%BC%9AABC123%20DEF456');if(!input){showNotification('%E6%9F%A5%E8%A9%A2%E5%B7%B2%E5%8F%96%E6%B6%88',true);return;}const%20numbers=input.split(/[\s,;\n]+/).map(x=%3Ex.trim().toUpperCase()).filter(Boolean);if(numbers.length===0){showNotification('%E6%9C%AA%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E7%9A%84%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',true);return;}const%20loadingOverlay=document.createElement('div');loadingOverlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:999998;display:flex;align-items:center;justify-content:center;';loadingOverlay.innerHTML=%60%3Cdiv%20style=%22background:#ffffff;padding:35px;border-radius:10px;text-align:center;box-shadow:0%208px%2025px%20rgba(0,0,0,0.3);animation:fadeIn%200.3s%20ease-out;%22%3E%3Cdiv%20style=%22width:50px;height:50px;border:4px%20solid%20#e9ecef;border-top:4px%20solid%20#007bff;border-radius:50%;animation:spin%201s%20linear%20infinite;margin:0%20auto%2020px;%22%3E%3C/div%3E%3Cp%20style=%22margin:0;color:#333333;font-size:16px;font-weight:500;%22%3E%E8%B3%87%E6%96%99%E6%9F%A5%E8%A9%A2%E4%B8%AD%EF%BC%8C%E8%AB%8B%E7%A8%8D%E5%80%99...%3C/p%3E%3C/div%3E%3Cstyle%3E@keyframes%20fadeIn%20{%20from%20{%20opacity:%200;%20}%20to%20{%20opacity:%201;%20}%20}@keyframes%20spin%20{%200%%20{%20transform:%20rotate(0deg);%20}%20100%%20{%20transform:%20rotate(360deg);%20}%20}%3C/style%3E%60;document.body.appendChild(loadingOverlay);let%20results=[],counter=1;function%20getName(str){if(!str)return'';const%20m=str.match(/^([\u4e00-\u9fa5\uff0a*\u00b7\uff0e]+)(?=\s)/);return%20m?m[1]:str.split('%20')[0];}for(const%20num%20of%20numbers){let%20retries=3,success=false,hasData=false;while(retries%3E0&&!success){try{const%20res=await%20fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,receiptNumber:num})});const%20data=await%20res.json();if(res.status===401){showNotification('TOKEN%E7%84%A1%E6%95%88%E6%88%96%E5%B7%B2%E9%81%8E%E6%9C%9F%EF%BC%8C%E8%AB%8B%E9%87%8D%E6%96%B0%E8%A8%AD%E5%AE%9A',true);token=null;localStorage.removeItem('euisToken');document.body.removeChild(loadingOverlay);return;}if(data.records&&data.records.length){hasData=true;data.records.forEach(record=%3E{const%20row={'%E5%BA%8F%E8%99%9F':counter++,'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=%3E{if(f==='uwApproverUnit'){const%20apiValue=record[f]||'';let%20firstLetter='';for(let%20i=0;i%3CapiValue.length;i++){if(/[A-Za-z]/.test(apiValue.charAt(i))){firstLetter=apiValue.charAt(i).toUpperCase();break;}}const%20mappedValue=firstLetter&&fieldNames[f][firstLetter]?fieldNames[f][firstLetter]:apiValue;row['%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D']=firstLetter?%60${firstLetter}-${mappedValue.replace(/^[A-Za-z]-/,'')}%60:mappedValue;}else%20if(f==='uwApprover'||f==='approvalUser'){row[fieldNames[f]]=getName(record[f]||'');}else{row[fieldNames[f]]=record[f]||'';}});row['%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C']='%E2%9C%93%20%E6%88%90%E5%8A%9F';results.push(row);});success=true;}else{hasData=false;const%20row={'%E5%BA%8F%E8%99%9F':counter++,'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=%3Erow[f==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f]]='-');row['%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C']='%E2%9C%97%20%E6%9F%A5%E7%84%A1%E8%B3%87%E6%96%99';results.push(row);success=true;}}catch(e){console.error(%60%E6%9F%A5%E8%A9%A2%20${num}%20%E6%99%82%E7%99%BC%E7%94%9F%E9%8C%AF%E8%AA%A4%EF%BC%9A%60,e);retries--;if(retries%3E0)await%20sleep(1500);}await%20sleep(500);}if(!success){showNotification(%60%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%20${num}%20%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97%EF%BC%8C%E8%AB%8B%E7%A8%8D%E5%BE%8C%E5%86%8D%E8%A9%A6%E3%80%82%60,true);const%20row={'%E5%BA%8F%E8%99%9F':counter++,'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=%3Erow[f==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f]]='-');row['%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C']='%E2%9C%97%20%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97';results.push(row);}}document.body.removeChild(loadingOverlay);originalResults=[...results];displayResults(results);}function%20displayResults(results){document.getElementById('defaultMainContainer')?.remove();const%20container=document.createElement('div');container.id='defaultMainContainer';const%20headers=['%E5%BA%8F%E8%99%9F','%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f]),'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C'];container.innerHTML=%60%3Cdiv%20id=%22defaultControlsHeader%22%3E%3Cdiv%20id=%22defaultSummarySection%22%3E%3Cspan%20id=%22defaultInfoSummary%22%20style=%22font-size:15px;font-weight:bold;color:#333;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%EF%BC%9A%E5%85%B1%20%3Cstrong%3E${originalResults.length}%3C/strong%3E%20%E7%AD%86%3C/span%3E%3C/div%3E%3Cdiv%20id=%22defaultButtonsGroup%22%3E%3Cinput%20type=%22text%22%20id=%22table-filter%22%20placeholder=%22%E6%90%9C%E5%B0%8B%E8%A1%A8%E6%A0%BC%E5%85%A7%E5%AE%B9...%22%20style=%22padding:8px%2012px;border:1px%20solid%20#ced4da;border-radius:5px;margin-right:8px;font-size:13px;width:200px;box-shadow:inset%200%201px%202px%20rgba(0,0,0,0.1);color:#333333;%22%3E%3Cbutton%20class=%22default-clear-search-btn%22%20id=%22clearSearch%22%3E%E6%B8%85%E9%99%A4%E6%90%9C%E5%B0%8B%3C/button%3E%3Cbutton%20class=%22default-requery-btn%22%20id=%22reQuery%22%3E%E9%87%8D%E6%96%B0%E6%9F%A5%E8%A9%A2%3C/button%3E%3Cbutton%20class=%22default-text-gen-btn%22%20id=%22textGen%22%3EA17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%3C/button%3E%3Cbutton%20class=%22default-copy-btn%22%20id=%22defaultCopyAll%22%3E%E4%B8%80%E9%8D%B5%E8%A4%87%E8%A3%BD%3C/button%3E%3C/div%3E%3Cdiv%20id=%22closeButtonContainer%22%3E%3Cbutton%20class=%22default-close-btn%22%20id=%22defaultClose%22%3E%E9%97%9C%E9%96%89%3C/button%3E%3C/div%3E%3C/div%3E%60;container.style=%60position:fixed;z-index:99999;left:50%;top:15px;transform:translateX(-50%);background:#ffffff;border-radius:10px;box-shadow:0%208px%2025px%20rgba(0,0,0,.25);padding:20px;max-width:96vw;width:auto;min-width:900px;max-height:92vh;overflow:auto;font-family:'Microsoft%20JhengHei',%20Arial,%20sans-serif;font-size:13px;animation:scaleIn%200.3s%20ease-out;%60;const%20table=document.createElement('table');table.id='sortable-table';table.style='width:100%;border-collapse:separate;border-spacing:0;font-size:13px;margin-top:15px;border-radius:6px;overflow:hidden;';const%20thead=document.createElement('thead');thead.style='position:sticky;top:0;z-index:10;background:#34495e;';const%20headerRow=document.createElement('tr');let%20sortDirection={};headers.forEach((headerText,index)=%3E{const%20th=document.createElement('th');th.innerHTML=%60${headerText}%20%3Cspan%20class=%22sort-arrow%22%3E%E2%87%85%3C/span%3E%60;th.style=%60background:#34495e;color:#fff;text-align:center;padding:10px%208px;font-size:13px;border:1px%20solid%20#34495e;white-space:nowrap;cursor:pointer;user-select:none;font-weight:bold;border-bottom:2px%20solid%20#2c3e50;%60;if%20(index%20===%200)%20th.style.borderTopLeftRadius%20=%20'6px';if%20(index%20===%20headers.length%20-%201)%20th.style.borderTopRightRadius%20=%20'6px';th.onclick=()=%3EsortTable(index);sortDirection[index]='asc';headerRow.appendChild(th);});thead.appendChild(headerRow);table.appendChild(thead);const%20tbody=document.createElement('tbody');tbody.id='table-body';function%20renderTable(data){tbody.innerHTML='';data.forEach((row,index)=%3E{const%20tr=document.createElement('tr');tr.style.display='';headers.forEach(field=%3E{const%20td=document.createElement('td');const%20cellValue=row[field]||'';td.textContent=cellValue;td.style=%60padding:8px%208px;text-align:center;border:1px%20solid%20#e9ecef;white-space:nowrap;vertical-align:middle;font-size:13px;color:#333333;${index%2?'background:#fcfcfc;':'background:#ffffff;'}%60;if(field==='%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C'){if(cellValue.includes('%E6%88%90%E5%8A%9F')){td.style.color='#20c997';td.style.fontWeight='bold';}else{td.style.color='#dc3545';td.style.fontWeight='bold';}}tr.appendChild(td);});tbody.appendChild(tr);});}function%20sortTable(columnIndex){const%20rows=Array.from(tbody.querySelectorAll('tr:not([style*=%22display:%20none%22])'));const%20isNumeric=columnIndex===0;rows.sort((a,b)=%3E{const%20aVal=a.cells[columnIndex].textContent.trim();const%20bVal=b.cells[columnIndex].textContent.trim();if(isNumeric){const%20aNum=parseInt(aVal)||0;const%20bNum=parseInt(bVal)||0;return%20sortDirection[columnIndex]==='asc'?aNum-bNum:bNum-aNum;}else{return%20sortDirection[columnIndex]==='asc'?aVal.localeCompare(bVal,'zh-TW'):bVal.localeCompare(aVal,'zh-TW');}});sortDirection[columnIndex]=sortDirection[columnIndex]==='asc'?'desc':'asc';document.querySelectorAll('.sort-arrow').forEach(arrow=%3Earrow.textContent='%E2%87%85');headerRow.children[columnIndex].querySelector('.sort-arrow').textContent=sortDirection[columnIndex]==='desc'?'%E2%86%91':'%E2%86%93';tbody.innerHTML='';rows.forEach(row=%3Etbody.appendChild(row));}function%20filterTable(){const%20filterValue=document.getElementById('table-filter').value.toLowerCase();const%20rows=tbody.querySelectorAll('tr');let%20visibleCount=0;rows.forEach(row=%3E{let%20shouldShow=false;for(let%20i=1;i%3Crow.cells.length;i++){if(row.cells[i].textContent.toLowerCase().includes(filterValue)){shouldShow=true;break;}}if(shouldShow){row.style.display='';visibleCount++;}else{row.style.display='none';}});document.getElementById('defaultInfoSummary').innerHTML=%60%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%EF%BC%9A%E5%85%B1%20%3Cstrong%3E${originalResults.length}%3C/strong%3E%20%E7%AD%86%EF%BC%8C%E9%A1%AF%E7%A4%BA%20%3Cstrong%3E${visibleCount}%3C/strong%3E%20%E7%AD%86%60;}renderTable(results);table.appendChild(tbody);container.appendChild(table);document.body.appendChild(container);const%20handleKeyDown=(e)=%3E{if(e.key==='Escape'){container.remove();document.removeEventListener('keydown',handleKeyDown);}};document.addEventListener('keydown',handleKeyDown);document.getElementById('table-filter').oninput=filterTable;document.getElementById('clearSearch').onclick=()=%3E{document.getElementById('table-filter').value='';filterTable();showNotification('%E6%90%9C%E5%B0%8B%E5%B7%B2%E6%B8%85%E9%99%A4');};document.getElementById('reQuery').onclick=()=%3E{document.removeEventListener('keydown',handleKeyDown);container.remove();performQuery();};document.getElementById('textGen').onclick=()=%3E{const%20today=new%20Date();const%20generateDate=new%20Date(today);generateDate.setDate(today.getDate()-3);const%20compareDate=today;const%20generateDateStr=%60${generateDate.getFullYear()}${(generateDate.getMonth()+1).toString().padStart(2,'0')}${generateDate.getDate().toString().padStart(2,'0')}%60;const%20compareDateStr=%60${compareDate.getFullYear()}${(compareDate.getMonth()+1).toString().padStart(2,'0')}${compareDate.getDate().toString().padStart(2,'0')}%60;const%20visibleRows=Array.from(tbody.querySelectorAll('tr:not([style*=%22display:%20none%22])'));const%20htmlTable=%60%3Ctable%20style=%22border-collapse:%20collapse;%20font-family:%20'Microsoft%20JhengHei',%20'%E5%BE%AE%E8%BB%9F%E6%AD%A3%E9%BB%91%E9%AB%94',%20Arial,%20sans-serif;%20font-size:%2011pt;%20width:%20100%;%22%3E%3Cthead%3E%3Ctr%20style=%22background-color:%20#34495e;%20color:%20white;%22%3E${headers.map(h=%3E%60%3Cth%20style=%22border:%201px%20solid%20#333;%20padding:%206px;%20text-align:%20center;%20font-weight:%20bold;%22%3E${h}%3C/th%3E%60).join('')}%3C/tr%3E%3C/thead%3E%3Ctbody%3E${visibleRows.map((row,index)=%3E%60%3Ctr%20style=%22${index%2?'background-color:%20#fcfcfc;':''}}%22%3E${headers.map((h,i)=%3E%60%3Ctd%20style=%22border:%201px%20solid%20#333;%20padding:%206px;%20text-align:%20center;%20color:%20#333333;%22%3E${row.cells[i].textContent}%3C/td%3E%60).join('')}%3C/tr%3E%60).join('')}%3C/tbody%3E%3C/table%3E%60;const%20htmlContent=%60%3Cdiv%20style=%22font-family:%20'Microsoft%20JhengHei',%20'%E5%BE%AE%E8%BB%9F%E6%AD%A3%E9%BB%91%E9%AB%94',%20Arial,%20sans-serif;%20font-size:%2011pt;%20line-height:%201.5;%22%3E%3Cp%3E%E6%82%A8%E5%A5%BD%EF%BC%8C%3C/p%3E%3Cp%3E%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%3C/p%3E%3Cp%3E%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%3C/p%3E%3Cp%3E%E7%94%A2%E6%AA%94%E6%99%82%E9%96%93${generateDateStr}%3Cbr%3E%E6%AF%94%E5%B0%8D%E6%99%82%E9%96%93${compareDateStr}%3C/p%3E${htmlTable}%3C/div%3E%60;const%20textContent=visibleRows.map(row=%3Eheaders.map((h,i)=%3Erow.cells[i].textContent).join('\t')).join('\n');const%20fixedText=%60%E6%82%A8%E5%A5%BD%EF%BC%8C\n\n%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82\n\n%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82\n\n%E7%94%A2%E6%AA%94%E6%99%82%E9%96%93${generateDateStr}\n%E6%AF%94%E5%B0%8D%E6%99%82%E9%96%93${compareDateStr}\n\n${headers.join('\t')}\n${textContent}%60;try{const%20clipboardItem=new%20ClipboardItem({'text/html':new%20Blob([htmlContent],{type:'text/html'}),'text/plain':new%20Blob([fixedText],{type:'text/plain'})});navigator.clipboard.write([clipboardItem]).then(()=%3EshowNotification('A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%E5%B7%B2%E8%A4%87%E8%A3%BD%EF%BC%88HTML%E6%A0%BC%E5%BC%8F%EF%BC%89')).catch(()=%3E{navigator.clipboard.writeText(fixedText);showNotification('A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%E5%B7%B2%E8%A4%87%E8%A3%BD%EF%BC%88%E7%B4%94%E6%96%87%E5%AD%97%E6%A0%BC%E5%BC%8F%EF%BC%89');});}catch(e){navigator.clipboard.writeText(fixedText);showNotification('A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%E5%B7%B2%E8%A4%87%E8%A3%BD%EF%BC%88%E7%B4%94%E6%96%87%E5%AD%97%E6%A0%BC%E5%BC%8F%EF%BC%89');}};document.getElementById('defaultCopyAll').onclick=()=%3E{const%20visibleRows=Array.from(tbody.querySelectorAll('tr:not([style*=%22display:%20none%22])'));const%20textTable=[headers,...visibleRows.map(row=%3Eheaders.map((h,i)=%3Erow.cells[i].textContent))].map(r=%3Er.join('\t')).join('\n');navigator.clipboard.writeText(textTable);showNotification('%E8%A1%A8%E6%A0%BC%E5%85%A7%E5%AE%B9%E5%B7%B2%E8%A4%87%E8%A3%BD%EF%BC%88%E7%B4%94%E6%96%87%E5%AD%97%E6%A0%BC%E5%BC%8F%EF%BC%89');};document.getElementById('defaultClose').onclick=()=%3E{document.removeEventListener('keydown',handleKeyDown);container.remove();};const%20style=document.createElement('style');style.textContent='@keyframes%20scaleIn{0%{transform:translateX(-50%)%20scale(0.95);opacity:0;}100%{transform:translateX(-50%)%20scale(1);opacity:1;}}@keyframes%20fadeIn{from{opacity:0;}to{opacity:1;}}@keyframes%20spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}#defaultMainContainer{font-family:%22Microsoft%20JhengHei%22,Arial,sans-serif;}#defaultControlsHeader{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding:8px%200;}#defaultSummarySection{flex:1;}#defaultButtonsGroup{display:flex;align-items:center;gap:8px;}#closeButtonContainer{margin-left:15px;}#defaultMainContainer%20table%20thead%20th{background:#34495e;color:#fff;text-align:center;padding:10px%208px;font-size:13px;border:1px%20solid%20#34495e;white-space:nowrap;cursor:pointer;user-select:none;font-weight:bold;}#defaultMainContainer%20table{width:100%;border-collapse:separate;border-spacing:0;font-size:13px;margin-top:15px;border-radius:6px;overflow:hidden;}#defaultMainContainer%20td{padding:8px%208px;text-align:center;border:1px%20solid%20#e9ecef;white-space:nowrap;vertical-align:middle;font-size:13px;color:#333333;}#defaultMainContainer%20th{padding:10px%208px;text-align:center;border:1px%20solid%20#34495e;white-space:nowrap;font-size:13px;font-weight:bold;}#defaultMainContainer%20tr:nth-child(even)%20td{background:#fcfcfc;}#defaultMainContainer%20tr:nth-child(odd)%20td{background:#ffffff;}#defaultMainContainer%20.default-copy-btn,#defaultMainContainer%20.default-close-btn,#defaultMainContainer%20.default-clear-search-btn,#defaultMainContainer%20.default-requery-btn,#defaultMainContainer%20.default-text-gen-btn{border:none;padding:6px%2012px;border-radius:6px;cursor:pointer;font-family:%22Microsoft%20JhengHei%22,Arial,sans-serif;font-size:13px;font-weight:bold;box-shadow:0%202px%205px%20rgba(0,0,0,.12);white-space:nowrap;transition:all%200.2s%20ease;}#defaultMainContainer%20.default-copy-btn{background:#20c997;color:#fff;}#defaultMainContainer%20.default-close-btn{background:#dc3545;color:#fff;}#defaultMainContainer%20.default-clear-search-btn{background:#17a2b8;color:#fff;}#defaultMainContainer%20.default-requery-btn{background:#ffc107;color:#000;}#defaultMainContainer%20.default-text-gen-btn{background:#6f42c1;color:#fff;}#defaultMainContainer%20.default-copy-btn:hover,#defaultMainContainer%20.default-close-btn:hover,#defaultMainContainer%20.default-clear-search-btn:hover,#defaultMainContainer%20.default-requery-btn:hover,#defaultMainContainer%20.default-text-gen-btn:hover{opacity:.9;transform:translateY(-1px);}#table-filter{padding:8px%2012px;border:1px%20solid%20#ced4da;border-radius:5px;margin-right:8px;font-size:13px;width:200px;color:#333333;}';document.head.appendChild(style);showNotification(%60%E6%9F%A5%E8%A9%A2%E5%AE%8C%E6%88%90%EF%BC%81%E5%85%B1${originalResults.length}%E7%AD%86%60);}await%20performQuery();})();
＊＊＊＊＊第15段程式碼結束/單條件保守-A17 /＊＊＊＊＊




＊＊＊＊＊第16段程式碼開始/ＡPPU /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),API_URL='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'],fieldNames={receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},uwApprover:'%E6%A0%B8%E4%BF%9D%E6%A0%B8%E5%87%86%E4%BA%BA%E5%93%A1',approvalUser:'%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'};let token=localStorage.getItem('euisToken');while(!token){token=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E8%BC%B8%E5%85%A5');if(!token)return alert('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2');localStorage.setItem('euisToken',token);}const input=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%88%E7%94%A8%E7%A9%BA%E6%A0%BC%E3%80%81%E9%80%97%E8%99%9F%E3%80%81%E5%88%86%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89');if(!input)return;const numbers=input.split(/[\s,;\n]+/).map(x=>x.trim()).filter(Boolean);if(numbers.length===0)return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E5%96%AE%E8%99%9F');let results=[];for(const num of numbers){let retries=3,success=!1;while(retries-->0&&!success)try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,receiptNumber:num})}),data=await res.json();if(data.records&&data.records.length){data.records.forEach(record=>{const row={'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=>{if(f==='uwApproverUnit'){const code=record[f]||'';row['%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D']=fieldNames[f][code]||code}else row[fieldNames[f]]=record[f]||''});results.push(row)});success=!0}else{const row={'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=>row[f==='uwApproverUnit'?%27%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D%27:fieldNames[f]]=%27%27);results.push(row);success=!0}}catch(e){console.error(`%E9%8C%AF%E8%AA%A4%EF%BC%9A${num}`,e);await%20sleep(1000);}await%20sleep(1000);}let%20container=document.getElementById(%27queryPreviewContainer%27);if(container)container.remove();container=document.createElement(%27div%27);container.id=%27queryPreviewContainer%27;container.style=%27position:fixed;top:30px;left:30px;z-index:99999;background:#fff;padding:18px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;max-height:80vh;overflow:auto;font-size:14px;';const%20table=document.createElement('table');table.style='border-collapse:collapse;min-width:900px;';const%20headers=['%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])],trh=document.createElement('tr');headers.forEach(h=%3E{const%20th=document.createElement('th');th.textContent=h;th.style='border:1px%20solid%20#ccc;padding:4px%208px;background:#f6f6f6;';trh.appendChild(th);});table.appendChild(trh);results.forEach(row=%3E{const%20tr=document.createElement('tr');headers.forEach(h=%3E{const%20td=document.createElement('td');td.textContent=row[h]||'';td.style='border:1px%20solid%20#ccc;padding:4px%208px;';tr.appendChild(td)});table.appendChild(tr)});container.innerHTML='%3Cdiv%20style=%22font-weight:bold;margin-bottom:8px;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E9%A0%90%E8%A6%BD%3C/div%3E';container.appendChild(table);const%20btnCopy=document.createElement('button'),btnExcel=document.createElement('button'),btnClose=document.createElement('button');btnCopy.textContent='%E8%A4%87%E8%A3%BD';btnExcel.textContent='%E4%B8%8B%E8%BC%89%20Excel';btnClose.textContent='%E9%97%9C%E9%96%89';[btnCopy,btnExcel,btnClose].forEach(btn=%3Ebtn.style='margin:12px%208px%200%200;font-size:14px;');btnCopy.onclick=()=%3E{const%20rows=[headers,...results.map(row=%3Eheaders.map(h=%3Erow[h]||''))];navigator.clipboard.writeText(rows.map(r=%3Er.join('\t')).join('\n')).then(()=%3E{btnCopy.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';setTimeout(()=%3EbtnCopy.textContent='%E8%A4%87%E8%A3%BD',1200);})};btnExcel.onclick=async()=%3E{if(!window.XLSX){const%20s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';document.body.appendChild(s);await%20new%20Promise(r=%3Es.onload=r);}const%20wb=XLSX.utils.book_new(),ws=XLSX.utils.json_to_sheet(results);XLSX.utils.book_append_sheet(wb,ws,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C');XLSX.writeFile(wb,%60%E9%80%81%E9%87%91%E5%96%AE%E6%9F%A5%E8%A9%A2_${new%20Date().toISOString().slice(0,10)}.xlsx%60)};btnClose.onclick=()=%3Econtainer.remove();container.appendChild(document.createElement('br'));container.appendChild(btnCopy);container.appendChild(btnExcel);container.appendChild(btnClose);document.body.appendChild(container);})();
＊＊＊＊＊第16段程式碼結束/ＡPPU /＊＊＊＊＊




＊＊＊＊＊第17段程式碼開始/單多U /＊＊＊＊＊
javascript:(async()=>{const fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'],fieldNames={'receiptNumber':'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC','applyNumber':'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','policyNumber':'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','approvalNumber':'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','mainStatus':'%E4%B8%BB%E7%8B%80%E6%85%8B','subStatus':'%E6%AC%A1%E7%8B%80%E6%85%8B','uwApproverUnit':{'H':'H-%E6%A0%B8%E4%BF%9D%E9%83%A8','B':'B-%E5%8C%97%E4%B8%80','C':'C-%E5%8F%B0%E4%B8%AD','F':'F-%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)','K':'K-%E9%AB%98%E9%9B%84','N':'N-%E5%8F%B0%E5%8D%97','P':'P-%E5%8C%97%E4%BA%8C','T':'T-%E6%A1%83%E7%AB%B9','G':'G-%E4%BF%9D%E4%BD%9C'},'uwApprover':'%E6%A0%B8%E4%BF%9D%E6%A0%B8%E5%87%86%E4%BA%BA%E5%93%A1','approvalUser':'%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'};const API_URL='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let token=localStorage.getItem('euisToken');while(!token){token=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5%EF%BC%9A');if(token)localStorage.setItem('euisToken',token);else return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5TOKEN%EF%BC%8C%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2%EF%BC%81');}const queryFields=[{key:'receiptNumber',label:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',checked:true},{key:'applyNumber',label:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC'},{key:'policyNumber',label:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC'},{key:'approvalNumber',label:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F'}];let selectedField=queryFields.find(f=>f.checked);const fieldSelector=document.createElement('div');fieldSelector.style='position:fixed;top:30px;left:30px;z-index:99999;background:#fff;padding:20px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;';fieldSelector.innerHTML=%60%3Cdiv%20style=%22margin-bottom:12px;font-weight:bold;%22%3E%E9%81%B8%E6%93%87%E6%9F%A5%E8%A9%A2%E6%AC%84%E4%BD%8D%EF%BC%9A%3C/div%3E%60;queryFields.forEach(f=%3E{const%20div=document.createElement('div');div.innerHTML=%60%3Clabel%3E%3Cinput%20type=%22radio%22%20name=%22queryField%22%20${f.checked?'checked':''}%20value=%22${f.key}%22%3E%20${f.label}%3C/label%3E%60;div.querySelector('input').onchange=()=%3E{selectedField=queryFields.find(x=%3Ex.key===f.key);};fieldSelector.appendChild(div);});document.body.appendChild(fieldSelector);const%20waitForInput=()=%3Enew%20Promise(r=%3E{const%20btn=document.createElement('button');btn.textContent='%E9%96%8B%E5%A7%8B%E6%9F%A5%E8%A9%A2';btn.style='margin-top:12px;';btn.onclick=()=%3E{document.body.removeChild(fieldSelector);r();};fieldSelector.appendChild(btn);});await%20waitForInput();const%20input=prompt(%60%E8%AB%8B%E8%BC%B8%E5%85%A5${selectedField.label}%EF%BC%9A%60);if(!input)return;const%20query={[selectedField.key]:input},start=Date.now();let%20results=[];try{const%20res=await%20fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,...query})}),data=await%20res.json();if(data.records&&data.records.length%3E0){data.records.forEach(record=%3E{const%20row={};fields.forEach(f=%3E{if(f==='uwApproverUnit'){const%20code=record[f]||'';row[fieldNames[f]]=fieldNames[f][code]?%60${code}-${fieldNames[f][code]}%60:code;}else{row[fieldNames[f]]=record[f]||'';}});results.push(row);});}else{const%20row={};fields.forEach(f=%3Erow[fieldNames[f]]=f===selectedField.key?input:'');results.push(row);}}catch(e){const%20row={};fields.forEach(f=%3Erow[fieldNames[f]]=f===selectedField.key?input:'');results.push(row);}const%20elapsed=((Date.now()-start)/1000).toFixed(2);let%20container=document.getElementById('queryPreviewContainer');if(container)container.remove();container=document.createElement('div');container.id='queryPreviewContainer';container.style='position:fixed;top:30px;left:30px;z-index:99999;background:#fff;padding:18px%2024px%2024px%2024px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;max-width:90vw;max-height:80vh;overflow:auto;font-size:15px;';container.innerHTML=%60%3Cdiv%20style=%22margin-bottom:8px;font-weight:bold;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%EF%BC%88${selectedField.label}=${input}%EF%BC%8C%E8%8A%B1%E8%B2%BB${elapsed}%E7%A7%92%EF%BC%89%3C/div%3E%60;const%20table=document.createElement('table');table.style='border-collapse:collapse;min-width:900px;max-width:100%;overflow-x:auto;';const%20trh=document.createElement('tr');fields.map(f=%3EfieldNames[f]).forEach(h=%3E{const%20th=document.createElement('th');th.textContent=h;th.style='border:1px%20solid%20#ccc;padding:4px%208px;background:#f6f6f6;';trh.appendChild(th);});table.appendChild(trh);results.forEach(row=%3E{const%20tr=document.createElement('tr');fields.map(f=%3EfieldNames[f]).forEach(h=%3E{const%20td=document.createElement('td');td.textContent=row[h]||'';td.style='border:1px%20solid%20#ccc;padding:4px%208px;max-width:200px;overflow-x:auto;';tr.appendChild(td);});table.appendChild(tr);});container.appendChild(table);const%20btnCopy=document.createElement('button'),btnExcel=document.createElement('button'),btnClose=document.createElement('button');btnCopy.textContent='%E8%A4%87%E8%A3%BD';btnExcel.textContent='%E4%B8%8B%E8%BC%89%20Excel';btnClose.textContent='%E9%97%9C%E9%96%89';btnCopy.style='margin:12px%208px%200%200;font-size:15px;';btnExcel.style='margin:12px%208px%200%200;font-size:15px;';btnClose.style='margin:12px%200%200%200;font-size:15px;';btnCopy.onclick=()=%3E{const%20rows=[fields.map(f=%3EfieldNames[f]),...results.map(row=%3Efields.map(f=%3EfieldNames[f]).map(h=%3Erow[h]||''))];navigator.clipboard.writeText(rows.map(r=%3Er.join('\t')).join('\n'));btnCopy.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';setTimeout(()=%3EbtnCopy.textContent='%E8%A4%87%E8%A3%BD',1200);};btnExcel.onclick=async()=%3E{if(!window.XLSX){const%20s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';document.body.appendChild(s);await%20new%20Promise(r=%3Es.onload=r);}const%20wb=XLSX.utils.book_new(),ws=XLSX.utils.json_to_sheet(results);XLSX.utils.book_append_sheet(wb,ws,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C');XLSX.writeFile(wb,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C.xlsx');};btnClose.onclick=()=%3Econtainer.remove();container.appendChild(document.createElement('br'));container.appendChild(btnCopy);container.appendChild(btnExcel);container.appendChild(btnClose);document.body.appendChild(container);})();
＊＊＊＊＊第17段程式碼結束/單多U /＊＊＊＊＊




＊＊＊＊＊第18段程式碼開始/Ｎ /＊＊＊＊＊
javascript:(async()=>{const API_URL='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'],fieldNames={'receiptNumber':'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC','applyNumber':'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','policyNumber':'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','approvalNumber':'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','mainStatus':'%E4%B8%BB%E7%8B%80%E6%85%8B','subStatus':'%E6%AC%A1%E7%8B%80%E6%85%8B','uwApproverUnit':{'H':'H-%E6%A0%B8%E4%BF%9D%E9%83%A8','B':'B-%E5%8C%97%E4%B8%80','C':'C-%E5%8F%B0%E4%B8%AD','F':'F-%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)','K':'K-%E9%AB%98%E9%9B%84','N':'N-%E5%8F%B0%E5%8D%97','P':'P-%E5%8C%97%E4%BA%8C','T':'T-%E6%A1%83%E7%AB%B9','G':'G-%E4%BF%9D%E4%BD%9C'},'uwApprover':'%E6%A0%B8%E4%BF%9D%E6%A0%B8%E5%87%86%E4%BA%BA%E5%93%A1','approvalUser':'%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'};let token=localStorage.getItem('euisToken');while(!token){token=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5%EF%BC%9A');if(!token)return alert('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2%EF%BC%81');localStorage.setItem('euisToken',token);}const input=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%88%E5%A4%9A%E7%AD%86%E5%8F%AF%E7%94%A8%E7%A9%BA%E6%A0%BC/%E9%80%97%E8%99%9F/%E5%88%86%E8%99%9F/%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89%EF%BC%9A');if(!input)return;const numbers=input.split(/[\s,;\n]+/).map(x=>x.trim()).filter(Boolean);if(numbers.length===0)return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E5%96%AE%E8%99%9F%EF%BC%81');let results=[];for(const num of numbers){try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,receiptNumber:num})}),data=await res.json();if(data.records&&data.records.length>0){data.records.forEach(record=>{const row={'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=>{if(f==='uwApproverUnit'){const code=record[f]||'';row['%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D']=fieldNames[f][code]?fieldNames[f][code]:code;}else%20if(f===%27uwApprover%27||f===%27approvalUser%27){row[fieldNames[f]]=record[f]||%27%27;}else{row[fieldNames[f]]=record[f]||%27%27;}});results.push(row);});}else{const%20row={%27%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%27:num};fields.slice(1).forEach(f=%3Erow[fieldNames[f]]=%27%27);results.push(row);}}catch(e){const%20row={%27%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%27:num};fields.slice(1).forEach(f=%3Erow[fieldNames[f]]=%27%27);results.push(row);}}let%20container=document.getElementById(%27queryPreviewContainer%27);if(container)container.remove();container=document.createElement(%27div%27);container.id=%27queryPreviewContainer%27;container.style=%27position:fixed;top:30px;left:30px;z-index:99999;background:#fff;padding:18px%2024px%2024px%2024px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;max-width:90vw;max-height:80vh;overflow:auto;font-size:15px;';container.innerHTML=%60%3Cdiv%20style=%22margin-bottom:8px;font-weight:bold;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E9%A0%90%E8%A6%BD%3C/div%3E%60;const%20table=document.createElement('table');table.style='border-collapse:collapse;min-width:900px;max-width:100%;overflow-x:auto;';const%20trh=document.createElement('tr');['%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])].forEach(h=%3E{const%20th=document.createElement('th');th.textContent=h;th.style='border:1px%20solid%20#ccc;padding:4px%208px;background:#f6f6f6;';trh.appendChild(th);});table.appendChild(trh);results.forEach(row=%3E{const%20tr=document.createElement('tr');['%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])].forEach(h=%3E{const%20td=document.createElement('td');td.textContent=row[h]||'';td.style='border:1px%20solid%20#ccc;padding:4px%208px;max-width:200px;overflow-x:auto;';tr.appendChild(td);});table.appendChild(tr);});container.appendChild(table);const%20btnCopy=document.createElement('button'),btnExcel=document.createElement('button'),btnClose=document.createElement('button');btnCopy.textContent='%E8%A4%87%E8%A3%BD';btnExcel.textContent='%E4%B8%8B%E8%BC%89%20Excel';btnClose.textContent='%E9%97%9C%E9%96%89';btnCopy.style='margin:12px%208px%200%200;font-size:15px;';btnExcel.style='margin:12px%208px%200%200;font-size:15px;';btnClose.style='margin:12px%200%200%200;font-size:15px;';btnCopy.onclick=()=%3E{const%20rows=[['%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])],...results.map(row=%3E['%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])].map(h=%3Erow[h]||''))];navigator.clipboard.writeText(rows.map(r=%3Er.join('\t')).join('\n'));btnCopy.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';setTimeout(()=%3EbtnCopy.textContent='%E8%A4%87%E8%A3%BD',1200);};btnExcel.onclick=async()=%3E{if(!window.XLSX){const%20s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';document.body.appendChild(s);await%20new%20Promise(r=%3Es.onload=r);}const%20wb=XLSX.utils.book_new(),ws=XLSX.utils.json_to_sheet(results);XLSX.utils.book_append_sheet(wb,ws,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C');XLSX.writeFile(wb,%60%E9%80%81%E9%87%91%E5%96%AE%E6%9F%A5%E8%A9%A2_${new%20Date().toISOString().slice(0,10)}.xlsx%60);};btnClose.onclick=()=%3Econtainer.remove();container.appendChild(document.createElement('br'));container.appendChild(btnCopy);container.appendChild(btnExcel);container.appendChild(btnClose);document.body.appendChild(container);})();
＊＊＊＊＊第18段程式碼結束/Ｎ /＊＊＊＊＊




＊＊＊＊＊第19段程式碼開始/多單U /＊＊＊＊＊
javascript:(async()=>{const fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'],fieldNames={'receiptNumber':'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC','applyNumber':'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','policyNumber':'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','approvalNumber':'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','mainStatus':'%E4%B8%BB%E7%8B%80%E6%85%8B','subStatus':'%E6%AC%A1%E7%8B%80%E6%85%8B','uwApproverUnit':'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D','uwApprover':'%E6%A0%B8%E4%BF%9D%E6%A0%B8%E5%87%86%E4%BA%BA%E5%93%A1','approvalUser':'%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'};const API_URL='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let token=localStorage.getItem('euisToken');while(!token){token=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5%EF%BC%9A');if(token)localStorage.setItem('euisToken',token);else return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5TOKEN%EF%BC%8C%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2%EF%BC%81');}const fieldPrompts=[{key:'receiptNumber',label:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC'},{key:'applyNumber',label:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC'},{key:'policyNumber',label:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC'},{key:'approvalNumber',label:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F'}];let query={},conditionStrs=[];for(const f of fieldPrompts){const val=prompt(`%E8%AB%8B%E8%BC%B8%E5%85%A5${f.label}%EF%BC%88%E5%8F%AF%E7%95%99%E7%A9%BA%EF%BC%89:`);if(val&&val.trim()){query[f.key]=val.trim();conditionStrs.push(`${f.label}=${val.trim()}`);}}if(Object.keys(query).length===0)return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5%E4%BB%BB%E4%BD%95%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6%EF%BC%8C%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2%EF%BC%81');const start=Date.now();let results=[],success=0;try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,...query})}),data=await res.json();if(data.records&&data.records.length>0){data.records.forEach(record=>{const row={'%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6':conditionStrs.join(', ')};fields.forEach(f=>row[fieldNames[f]]=record[f]||'');results.push(row);});success=data.records.length;}else{const row={'%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6':conditionStrs.join(', ')};fields.forEach(f=>row[fieldNames[f]]=query[f]||'');results.push(row);}}catch(e){const row={'%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6':conditionStrs.join(', ')};fields.forEach(f=>row[fieldNames[f]]=query[f]||'');results.push(row);}const elapsed=((Date.now()-start)/1000).toFixed(2);let container=document.getElementById('queryPreviewContainer');if(container)container.remove();container=document.createElement('div');container.id='queryPreviewContainer';container.style='position:fixed;top:30px;left:30px;z-index:99999;background:#fff;padding:18px%2024px%2024px%2024px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;max-width:90vw;max-height:80vh;overflow:auto;font-size:15px;';container.innerHTML=%60%3Cdiv%20style=%22margin-bottom:8px;font-weight:bold;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%EF%BC%88%E5%85%B1%20${results.length}%20%E7%AD%86%EF%BC%89%3C/div%3E%60;const%20table=document.createElement('table');table.style='border-collapse:collapse;min-width:900px;max-width:100%;overflow-x:auto;';const%20trh=document.createElement('tr');['%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6',...fields.map(f=%3EfieldNames[f])].forEach(h=%3E{const%20th=document.createElement('th');th.textContent=h;th.style='border:1px%20solid%20#ccc;padding:4px%208px;background:#f6f6f6;';trh.appendChild(th);});table.appendChild(trh);results.forEach(row=%3E{const%20tr=document.createElement('tr');['%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6',...fields.map(f=%3EfieldNames[f])].forEach(h=%3E{const%20td=document.createElement('td');td.textContent=row[h]||'';td.style='border:1px%20solid%20#ccc;padding:4px%208px;max-width:200px;overflow-x:auto;';tr.appendChild(td);});table.appendChild(tr);});container.appendChild(table);const%20btnCopy=document.createElement('button'),btnExcel=document.createElement('button'),btnClose=document.createElement('button');btnCopy.textContent='%E8%A4%87%E8%A3%BD';btnExcel.textContent='%E4%B8%8B%E8%BC%89%20Excel';btnClose.textContent='%E9%97%9C%E9%96%89';btnCopy.style='margin:12px%208px%200%200;font-size:15px;';btnExcel.style='margin:12px%208px%200%200;font-size:15px;';btnClose.style='margin:12px%200%200%200;font-size:15px;';btnCopy.onclick=()=%3E{const%20rows=[['%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6',...fields.map(f=%3EfieldNames[f])],...results.map(row=%3E['%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6',...fields.map(f=%3EfieldNames[f])].map(h=%3Erow[h]||''))];navigator.clipboard.writeText(rows.map(r=%3Er.join('\t')).join('\n'));btnCopy.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';setTimeout(()=%3EbtnCopy.textContent='%E8%A4%87%E8%A3%BD',1200);};btnExcel.onclick=async()=%3E{if(!window.XLSX){const%20s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';document.body.appendChild(s);await%20new%20Promise(r=%3Es.onload=r);}const%20wb=XLSX.utils.book_new(),ws=XLSX.utils.json_to_sheet(results);XLSX.utils.book_append_sheet(wb,ws,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C');XLSX.writeFile(wb,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C.xlsx');};btnClose.onclick=()=%3Econtainer.remove();container.appendChild(document.createElement('br'));container.appendChild(btnCopy);container.appendChild(btnExcel);container.appendChild(btnClose);document.body.appendChild(container);})();
＊＊＊＊＊第19段程式碼結束/多單U /＊＊＊＊＊




＊＊＊＊＊第20段程式碼開始/P-A17 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),API_URL='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',fields=['receiptNumber','applyNumber','policyNumber','approvalNumber','mainStatus','subStatus','uwApproverUnit','uwApprover','approvalUser'],fieldNames={receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B',uwApproverUnit:{H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},uwApprover:'%E6%A0%B8%E4%BF%9D%E4%BA%BA%E5%93%A1',approvalUser:'%E5%AF%A9%E6%A0%B8%E4%BA%BA%E5%93%A1'};let token=localStorage.getItem('euisToken');while(!token){token=prompt('%E6%89%BE%E4%B8%8D%E5%88%B0TOKEN%EF%BC%8C%E8%AB%8B%E8%BC%B8%E5%85%A5');if(!token)return alert('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E6%AD%A2');localStorage.setItem('euisToken',token);}const input=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%88%E7%94%A8%E7%A9%BA%E6%A0%BC%E3%80%81%E9%80%97%E8%99%9F%E3%80%81%E5%88%86%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89');if(!input)return;const numbers=input.split(/[\s,;\n]+/).map(x=>x.trim()).filter(Boolean);if(numbers.length===0)return alert('%E6%9C%AA%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E5%96%AE%E8%99%9F');let results=[];for(const num of numbers){let retries=3,success=!1;while(retries-->0&&!success)try{const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':token},body:JSON.stringify({currentPage:1,pageSize:10,receiptNumber:num})}),data=await res.json();if(data.records&&data.records.length){data.records.forEach(record=>{const row={'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=>{if(f==='uwApproverUnit'){const code=record[f]||'';row['%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D']=fieldNames[f][code]||code}else row[fieldNames[f]]=record[f]||''});results.push(row)});success=!0}else{const row={'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC':num};fields.slice(1).forEach(f=>row[f==='uwApproverUnit'?%27%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D%27:fieldNames[f]]=%27%27);results.push(row);success=!0}}catch(e){console.error(`%E9%8C%AF%E8%AA%A4%EF%BC%9A${num}`,e);await%20sleep(1000);}await%20sleep(1000);}let%20container=document.getElementById(%27queryPreviewContainer%27);if(container)container.remove();container=document.createElement(%27div%27);container.id=%27queryPreviewContainer%27;container.style=%27position:fixed;top:30px;left:30px;z-index:99999;background:#fff;padding:18px;border-radius:8px;box-shadow:0%204px%2016px%20#0002;max-height:80vh;overflow:auto;font-size:14px;';const%20table=document.createElement('table');table.style='border-collapse:collapse;min-width:900px;';const%20headers=['%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',...fields.slice(1).map(f=%3Ef==='uwApproverUnit'?'%E6%A0%B8%E4%BF%9D%E5%96%AE%E4%BD%8D':fieldNames[f])],trh=document.createElement('tr');headers.forEach(h=%3E{const%20th=document.createElement('th');th.textContent=h;th.style='border:1px%20solid%20#ccc;padding:4px%208px;background:#f6f6f6;';trh.appendChild(th);});table.appendChild(trh);results.forEach(row=%3E{const%20tr=document.createElement('tr');headers.forEach(h=%3E{const%20td=document.createElement('td');td.textContent=row[h]||'';td.style='border:1px%20solid%20#ccc;padding:4px%208px;';tr.appendChild(td)});table.appendChild(tr)});container.innerHTML='%3Cdiv%20style=%22font-weight:bold;margin-bottom:8px;%22%3E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E9%A0%90%E8%A6%BD%3C/div%3E';container.appendChild(table);const%20btnCopy=document.createElement('button'),btnExcel=document.createElement('button'),btnClose=document.createElement('button');btnCopy.textContent='%E8%A4%87%E8%A3%BD';btnExcel.textContent='%E4%B8%8B%E8%BC%89%20Excel';btnClose.textContent='%E9%97%9C%E9%96%89';[btnCopy,btnExcel,btnClose].forEach(btn=%3Ebtn.style='margin:12px%208px%200%200;font-size:14px;');btnCopy.onclick=()=%3E{const%20rows=[headers,...results.map(row=%3Eheaders.map(h=%3Erow[h]||''))];navigator.clipboard.writeText(rows.map(r=%3Er.join('\t')).join('\n')).then(()=%3E{btnCopy.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';setTimeout(()=%3EbtnCopy.textContent='%E8%A4%87%E8%A3%BD',1200);})};btnExcel.onclick=async()=%3E{if(!window.XLSX){const%20s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';document.body.appendChild(s);await%20new%20Promise(r=%3Es.onload=r);}const%20wb=XLSX.utils.book_new(),ws=XLSX.utils.json_to_sheet(results);XLSX.utils.book_append_sheet(wb,ws,'%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C');XLSX.writeFile(wb,%60%E9%80%81%E9%87%91%E5%96%AE%E6%9F%A5%E8%A9%A2_${new%20Date().toISOString().slice(0,10)}.xlsx%60)};btnClose.onclick=()=%3Econtainer.remove();container.appendChild(document.createElement('br'));container.appendChild(btnCopy);container.appendChild(btnExcel);container.appendChild(btnClose);document.body.appendChild(container);})();
＊＊＊＊＊第20段程式碼結束/P-A17 /＊＊＊＊＊




＊＊＊＊＊第21段程式碼開始/new /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';const API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let CURRENT_API_URL='';const TOKEN_STORAGE_KEY='euisToken';const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}];let%20selectedQueryDefinitionGlobal=null;const%20ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'];const%20FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8',mainStatus:'%E4%B8%BB%E7%8B%80%E6%85%8B',subStatus:'%E6%AC%A1%E7%8B%80%E6%85%8B'};const%20UNIT_MAP_FIELD_API_KEY='uwApproverUnit';const%20UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',F:'%E5%8F%B0%E4%B8%AD(%E5%98%89%E7%BE%A9)',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'};const%20APPROVER_FIELD_API_KEY='uwApprover';const%20APPROVAL_USER_FIELD_API_KEY='approvalUser';const%20SPECIAL_QUERIED_VALUE_KEY='_queriedValue_';const%20A17_BUTTON_TEXT=%22A17%E4%BD%9C%E6%A5%AD%E9%80%9A%E7%9F%A5%22;const%20A17_REPORT_NAME=%22A17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%22;const%20A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22;const%20A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9A{REPORT_NAME}%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22;const%20A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;const%20A17_GEN_DATE_OFFSET_DAYS=-3;const%20A17_COMP_DATE_OFFSET_DAYS=0;const%20A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}];const%20A17_CSV_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'];const%20A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''];let%20baseA17MasterData=[];let%20apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY);let%20originalQueryResults=[];let%20currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,mainTableSortState:{columnIndex:1,direction:'asc'},isCSVImportModeGlobal:false};let%20importedCSVRawData=null;let%20a17ModeState={isActive:false,selectedUnits:new%20Set(),sortedData:[]};const%20sleep=t=%3Enew%20Promise(r=%3EsetTimeout(r,t));const%20escapeHtml=unsafe=%3Eunsafe===undefined||unsafe===null?'':String(unsafe).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第21段程式碼結束/new /＊＊＊＊＊




＊＊＊＊＊第22段程式碼開始/A17.5 /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',TOKEN_STORAGE_KEY='euisToken',Z_INDEX_DIALOG=2147483640,Z_INDEX_MAIN_UI=2147483630,Z_INDEX_NOTIFICATION=2147483647;let CURRENT_API_URL='',apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY),selectedQueryDefinitionGlobal=null,originalQueryResults=[],baseA17MasterData=[],isEditMode=false,currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,isCSVImportModeGlobal:false},a17ModeState={isActive:false,selectedUnits:new Set(),sortedData:[]};const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}],ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'],FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8'},UNIT_MAP_FIELD_API_KEY='uwApproverUnit',UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}],A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''],A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22,A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22,A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;let%20textSettings={content:A17_PARA1+'\n\n'+A17_PARA2_TEMPLATE+'\n\n'+A17_PARA3,fontSize:10.5,lineHeight:1.5};function%20loadTextSettings(){const%20saved=localStorage.getItem('qt_a17_text_settings');if(saved)try{textSettings={...textSettings,...JSON.parse(saved)}}catch(e){}}function%20saveTextSettings(){localStorage.setItem('qt_a17_text_settings',JSON.stringify(textSettings))}function%20escapeHtml(s){return%20s===undefined||s===null?'':String(s).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第22段程式碼結束/A17.5 /＊＊＊＊＊




＊＊＊＊＊第23段程式碼開始/17X /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',TOKEN_STORAGE_KEY='euisToken',Z_INDEX_DIALOG=2147483640,Z_INDEX_MAIN_UI=2147483630,Z_INDEX_NOTIFICATION=2147483647;let CURRENT_API_URL='',apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY),selectedQueryDefinitionGlobal=null,originalQueryResults=[],baseA17MasterData=[],isEditMode=false,currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,isCSVImportModeGlobal:false},a17ModeState={isActive:false,selectedUnits:new Set(),sortedData:[]},csvImportState={isImported:false,headers:[],selectedColumn:null,fileName:''};const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}],ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'],FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8'},UNIT_MAP_FIELD_API_KEY='uwApproverUnit',UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}],A17_CSV_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'],A17_API_DATA_DISPLAY_HEADERS=['%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1'],A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''],A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22,A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22,A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;let%20textSettings={content:A17_PARA1+'\n\n'+A17_PARA2_TEMPLATE+'\n\n'+A17_PARA3,fontSize:10.5,lineHeight:1.5};function%20loadTextSettings(){const%20saved=localStorage.getItem('qt_a17_text_settings');if(saved)try{textSettings={...textSettings,...JSON.parse(saved)}}catch(e){}}function%20saveTextSettings(){localStorage.setItem('qt_a17_text_settings',JSON.stringify(textSettings))}function%20escapeHtml(s){return%20s===undefined||s===null?'':String(s).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第23段程式碼結束/17X /＊＊＊＊＊




＊＊＊＊＊第24段程式碼開始/ID /＊＊＊＊＊
javascript:(function(){if(document.getElementById('id-gen-pro')){return}const P={primary:'#0057FF',text:'#212529',bg:'#FFFFFF',panelBg:'#F0F2F5',border:'#DEE2E6',subtleText:'#6C757D',success:'#198754'};const%20CITIES={'A':'%E8%87%BA%E5%8C%97%E5%B8%82','B':'%E8%87%BA%E4%B8%AD%E5%B8%82','C':'%E5%9F%BA%E9%9A%86%E5%B8%82','D':'%E8%87%BA%E5%8D%97%E5%B8%82','E':'%E9%AB%98%E9%9B%84%E5%B8%82','F':'%E6%96%B0%E5%8C%97%E5%B8%82','G':'%E5%AE%9C%E8%98%AD%E7%B8%A3','H':'%E6%A1%83%E5%9C%92%E5%B8%82','I':'%E5%98%89%E7%BE%A9%E5%B8%82','J':'%E6%96%B0%E7%AB%B9%E7%B8%A3','K':'%E8%8B%97%E6%A0%97%E7%B8%A3','L':'%E8%87%BA%E4%B8%AD%E7%B8%A3(%E5%81%9C)','M':'%E5%8D%97%E6%8A%95%E7%B8%A3','N':'%E5%BD%B0%E5%8C%96%E7%B8%A3','O':'%E6%96%B0%E7%AB%B9%E5%B8%82','P':'%E9%9B%B2%E6%9E%97%E7%B8%A3','Q':'%E5%98%89%E7%BE%A9%E7%B8%A3','R':'%E8%87%BA%E5%8D%97%E7%B8%A3(%E5%81%9C)','S':'%E9%AB%98%E9%9B%84%E7%B8%A3(%E5%81%9C)','T':'%E5%B1%8F%E6%9D%B1%E7%B8%A3','U':'%E8%8A%B1%E8%93%AE%E7%B8%A3','V':'%E8%87%BA%E6%9D%B1%E7%B8%A3','W':'%E9%87%91%E9%96%80%E7%B8%A3','X':'%E6%BE%8E%E6%B9%96%E7%B8%A3','Y':'%E9%99%BD%E6%98%8E%E5%B1%B1(%E5%81%9C)','Z':'%E9%80%A3%E6%B1%9F%E7%B8%A3'};const%20CITY_CODES={'A':10,'B':11,'C':12,'D':13,'E':14,'F':15,'G':16,'H':17,'I':34,'J':18,'K':19,'L':20,'M':21,'N':22,'O':35,'P':23,'Q':24,'R':25,'S':26,'T':27,'U':28,'V':29,'W':32,'X':30,'Y':31,'Z':33};function%20generate(city,gender){let%20s='';for(let%20i=0;i%3C7;i++){s+=Math.floor(Math.random()*10)}const%20code=CITY_CODES[city].toString();const%20d1=parseInt(code[0]||code);const%20d2=parseInt(code[1]||0);const%20body=[d1,d2,parseInt(gender),...s.split('').map(Number)];const%20weights=[1,9,8,7,6,5,4,3,2,1];let%20sum=0;for(let%20i=0;i%3Cbody.length;i++){sum+=body[i]*weights[i]}const%20chk=(10-(sum%10))%10;return%20city+gender.toString()+s+chk.toString()}const%20card=document.createElement('div');card.id='id-gen-pro';card.style.cssText=%60%20%20%20%20%20%20%20%20position:%20fixed;%20%20%20%20%20%20%20%20top:%2050%;%20%20%20%20%20%20%20%20left:%2050%;%20%20%20%20%20%20%20%20transform:%20translate(-50%,%20-50%);%20%20%20%20%20%20%20%20background:%20${P.bg};%20%20%20%20%20%20%20%20color:%20${P.text};%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20box-shadow:%200%208px%2020px%20rgba(0,0,0,0.15);%20%20%20%20%20%20%20%20font-family:%20-apple-system,%20BlinkMacSystemFont,%20%22Segoe%20UI%22,%20Roboto,%20%22Helvetica%20Neue%22,%20Arial,%20sans-serif;%20%20%20%20%20%20%20%20width:%20400px;%20%20%20%20%20%20%20%20min-width:%20300px;%20%20%20%20%20%20%20%20max-width:%2095vw;%20%20%20%20%20%20%20%20font-size:%2013px;%20%20%20%20%20%20%20%20line-height:%201.4;%20%20%20%20%20%20%20%20box-sizing:%20border-box;%20%20%20%20%20%20%20%20z-index:%202147483647;%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%60;const%20header=document.createElement('div');header.style.cssText=%60%20%20%20%20%20%20%20%20padding:%208px%2016px;%20%20%20%20%20%20%20%20cursor:%20move;%20%20%20%20%20%20%20%20position:%20relative;%20%20%20%20%20%20%20%20border-bottom:%201px%20solid%20${P.border};%20%20%20%20%60;const%20title=document.createElement('h2');title.textContent='ID%20%E7%94%A2%E7%94%9F%E5%99%A8';title.style.cssText=%60%20%20%20%20%20%20%20%20margin:%200;%20%20%20%20%20%20%20%20color:%20${P.text};%20%20%20%20%20%20%20%20text-align:%20center;%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20font-weight:%20600;%20%20%20%20%60;const%20closeBtn=document.createElement('span');closeBtn.innerHTML='×';closeBtn.style.cssText=%60%20%20%20%20%20%20%20%20position:%20absolute;%20%20%20%20%20%20%20%20top:%2050%;%20%20%20%20%20%20%20%20right:%2012px;%20%20%20%20%20%20%20%20transform:%20translateY(-50%);%20%20%20%20%20%20%20%20font-size:%2020px;%20%20%20%20%20%20%20%20color:%20${P.subtleText};%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20font-weight:%20300;%20%20%20%20%20%20%20%20line-height:%201;%20%20%20%20%20%20%20%20transition:%20color%20.2s;%20%20%20%20%60;const%20content=document.createElement('div');content.style.cssText=%60%20%20%20%20%20%20%20%20padding:%2012px;%20%20%20%20%20%20%20%20flex-grow:%201;%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%60;const%20formContainer=document.createElement('div');formContainer.style.cssText=%60%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20align-items:%20end;%20%20%20%20%20%20%20%20gap:%2010px;%20%20%20%20%20%20%20%20margin-bottom:%208px;%20%20%20%20%60;const%20createField=(label,input)=%3E{const%20field=document.createElement('div');field.style.cssText='flex:%201;';const%20l=document.createElement('label');l.textContent=label;l.style.cssText=%60%20%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%203px;%20%20%20%20%20%20%20%20%20%20%20%20font-weight:%20500;%20%20%20%20%20%20%20%20%20%20%20%20color:%20${P.subtleText};%20%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%60;input.style.cssText=%60%20%20%20%20%20%20%20%20%20%20%20%20width:%20100%;%20%20%20%20%20%20%20%20%20%20%20%20padding:%206px%208px;%20%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${P.border};%20%20%20%20%20%20%20%20%20%20%20%20border-radius:%206px;%20%20%20%20%20%20%20%20%20%20%20%20font-size:%2013px;%20%20%20%20%20%20%20%20%20%20%20%20background:%20${P.bg};%20%20%20%20%20%20%20%20%20%20%20%20box-sizing:%20border-box;%20%20%20%20%20%20%20%20%60;field.appendChild(l);field.appendChild(input);return%20field};const%20citySel=document.createElement('select');Object.keys(CITIES).sort().forEach(L=%3E{citySel.add(new%20Option(%60${L}%20|%20${CITIES[L]}%60,L))});const%20genderSel=document.createElement('select');genderSel.add(new%20Option('%E9%9A%A8%E6%A9%9F','random'));genderSel.add(new%20Option('%E7%94%B7%20(1)','1'));genderSel.add(new%20Option('%E5%A5%B3%20(2)','2'));const%20countIn=document.createElement('input');countIn.type='number';countIn.value='6';countIn.min='1';countIn.max='99';const%20genBtn=document.createElement('button');genBtn.textContent='%E7%94%A2%E7%94%9FID';genBtn.style.cssText=%60%20%20%20%20%20%20%20%20padding:%208px%2016px;%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20border-radius:%206px;%20%20%20%20%20%20%20%20background:%20${P.primary};%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20font-size:%2013px;%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20height:%20fit-content;%20%20%20%20%20%20%20%20white-space:%20nowrap;%20%20%20%20%60;const%20resultsGrid=document.createElement('div');resultsGrid.style.cssText=%60%20%20%20%20%20%20%20%20display:%20grid;%20%20%20%20%20%20%20%20grid-template-columns:%20repeat(3,%201fr);%20%20%20%20%20%20%20%20gap:%206px;%20%20%20%20%20%20%20%20margin-top:%208px;%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20background:%20${P.panelBg};%20%20%20%20%20%20%20%20border-radius:%206px;%20%20%20%20%20%20%20%20min-height:%2080px;%20%20%20%20%20%20%20%20max-height:%20250px;%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%60;const%20resizeHandle=document.createElement('div');resizeHandle.style.cssText=%60%20%20%20%20%20%20%20%20position:%20absolute;%20%20%20%20%20%20%20%20right:%200;%20%20%20%20%20%20%20%20bottom:%200;%20%20%20%20%20%20%20%20width:%2012px;%20%20%20%20%20%20%20%20height:%2012px;%20%20%20%20%20%20%20%20cursor:%20se-resize;%20%20%20%20%60;header.appendChild(title);header.appendChild(closeBtn);formContainer.appendChild(createField('%E7%B8%A3%E5%B8%82',citySel));formContainer.appendChild(createField('%E6%80%A7%E5%88%A5',genderSel));formContainer.appendChild(createField('%E7%94%A2%E7%94%9F%E7%B5%84%E6%95%B8',countIn));formContainer.appendChild(genBtn);content.appendChild(formContainer);content.appendChild(resultsGrid);card.appendChild(header);card.appendChild(content);card.appendChild(resizeHandle);document.body.appendChild(card);genBtn.addEventListener('click',()=%3E{resultsGrid.innerHTML='';const%20city=citySel.value;const%20genderOpt=genderSel.value;const%20count=parseInt(countIn.value,10)||6;const%20ids=[];for(let%20i=0;i%3Ccount;i++){let%20g=genderOpt==='random'?Math.floor(Math.random()*2)+1:parseInt(genderOpt);const%20id=generate(city,g);ids.push(id)}ids.sort((a,b)=%3Ea.localeCompare(b));ids.forEach(id=%3E{const%20idBox=document.createElement('div');idBox.textContent=id;idBox.style.cssText=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background:%20${P.bg};%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${P.border};%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text-align:%20center;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transition:%20all%20.2s%20ease;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20%20%60;idBox.addEventListener('click',()=%3E{navigator.clipboard.writeText(id).then(()=%3E{const%20originalText=idBox.textContent;const%20originalBg=idBox.style.backgroundColor;idBox.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';idBox.style.background=P.success;idBox.style.color='#fff';setTimeout(()=%3E{idBox.textContent=originalText;idBox.style.background=originalBg;idBox.style.color=P.text},1500)})});resultsGrid.appendChild(idBox)})});let%20isDragging=!1,isResizing=!1;let%20offsetX,offsetY,startWidth,startHeight;header.addEventListener('mousedown',e=%3E{if(e.target!==closeBtn){isDragging=!0;offsetX=e.clientX-card.offsetLeft;offsetY=e.clientY-card.offsetTop;card.style.userSelect='none'}});resizeHandle.addEventListener('mousedown',e=%3E{isResizing=!0;startWidth=card.offsetWidth;startHeight=card.offsetHeight;offsetX=e.clientX;offsetY=e.clientY;card.style.userSelect='none'});document.addEventListener('mousemove',e=%3E{if(isDragging){card.style.left=%60${e.clientX%20-%20offsetX}px%60;card.style.top=%60${e.clientY%20-%20offsetY}px%60}if(isResizing){const%20newWidth=startWidth+(e.clientX-offsetX);const%20newHeight=startHeight+(e.clientY-offsetY);card.style.width=%60${newWidth}px%60;card.style.height=%60${newHeight}px%60}});document.addEventListener('mouseup',()=%3E{isDragging=!1;isResizing=!1;card.style.userSelect='auto'});closeBtn.addEventListener('click',()=%3E{document.body.removeChild(card)})})()
＊＊＊＊＊第24段程式碼結束/ID /＊＊＊＊＊




＊＊＊＊＊第25段程式碼開始/A17正式 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),loadSheetJS=()=>new Promise((r,o)=>{if(window.XLSX)return r();const s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';s.onload=r;s.onerror=o;document.body.appendChild(s);});await loadSheetJS();const token=localStorage.getItem('euisToken');if(!token)return void alert('%E6%89%BE%E4%B8%8D%E5%88%B0token%EF%BC%8C%E8%AB%8B%E5%85%88%E7%99%BB%E5%85%A5%E7%B3%BB%E7%B5%B1%EF%BC%81');const input=prompt('%E8%BC%B8%E5%85%A5%E5%96%AE%E8%99%9F%EF%BC%88%E9%80%97%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89%EF%BC%9A');if(!input)return;const numbers=input.split(/\n|,/).map(x=>x.trim()).filter(Boolean),fields=[
＊＊＊＊＊第25段程式碼結束/A17正式 /＊＊＊＊＊




＊＊＊＊＊第26段程式碼開始/174yahoo /＊＊＊＊＊
javascript:(function()%7Basync%20function%20queryData(e)%7Bconst%20t=%22https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query%22;let%20n=document.createElement(%22div%22);n.style.cssText=%22position:fixed;top:10px;left:10px;background:white;padding:10px;border:1px%20solid%20black;z-index:10000;width:600px;font-size:14px%22;const%20a=%5B%22mainStatus%22,%22applyNumber%22,%22policyNumber%22,%22insured%22%5D,o=%7BmainStatus:%22%E7%8B%80%E6%85%8B%22,applyNumber:%22%E7%94%B3%E8%AB%8B%E8%99%9F%E7%A2%BC%22,policyNumber:%22%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC%22,insured:%22%E8%A2%AB%E4%BF%9D%E9%9A%AA%E4%BA%BA%22%7D;let%20i='%3Ctable%20border=%221%22%20style=%22border-collapse:collapse;width:100%25%22%3E%3Ctr%3E'+a.map(e=%3E%60%3Cth%20style=%22padding:3px%22%3E$%7Bo%5Be%5D%7D%3C/th%3E%60).join(%22%22)+%22%3C/tr%3E%22;for(let%20n%20of%20e)try%7Bconst%20e=await%20fetch(t,%7Bmethod:%22POST%22,headers:%7B%22Content-Type%22:%22application/json%22,Accept:%22application/json,%20text/plain,%20*/*%22%7D,body:JSON.stringify(%7Breciptnumber:n%7D)%7D),o=await%20e.json();o.records&&o.records.length%3E0&&o.records.forEach(e=%3E%7Bi+=%22%3Ctr%3E%22+a.map(t=%3E%60%3Ctd%20style=%22padding:3px%22%3E$%7Be%5Bt%5D%7C%7C%22%22%7D%3C/td%3E%60).join(%22%22)+%22%3C/tr%3E%22%7D)%7Dcatch(e)%7Bconsole.error(%60Error:%20$%7Bn%7D%60,e)%7Di+=%22%3C/table%3E%22,n.innerHTML=i;const%20r=document.createElement(%22button%22);r.innerHTML=%22%E9%97%9C%E9%96%89%22,r.style.cssText=%22margin-top:5px;padding:3px%2010px%22,r.onclick=()=%3En.remove(),n.appendChild(r),document.body.appendChild(n)%7Dconst%20input=prompt(%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%88%E7%94%A8%E9%80%97%E8%99%9F%E5%88%86%E9%9A%94%EF%BC%89%22);input&&queryData(input.split(%22,%22).map(e=%3Ee.trim()))%7D)();
＊＊＊＊＊第26段程式碼結束/174yahoo /＊＊＊＊＊




＊＊＊＊＊第27段程式碼開始/175白名單 /＊＊＊＊＊
javascript:(function(){var e=document.getElementById('url-generator-bookmarklet');if(e)document.body.removeChild(e);var t=document.createElement('div');t.id='url-generator-bookmarklet',t.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:999999;overflow:auto;';var n=document.createElement('div');n.style.cssText='margin:20px auto;background:#fff;padding:20px;width:90%;max-width:500px;';var%20o=document.createElement('button');o.textContent='%E9%97%9C%E9%96%89',o.onclick=function(){document.body.removeChild(t)};n.innerHTML=%60%3Ch1%3EURL%E7%94%9F%E6%88%90%E5%99%A8%3C/h1%3E%3Clabel%3E%E6%89%8B%E6%A9%9F:%3Cinput%20type=%22text%22%20id=%22userPhone%22%20placeholder=%22%E6%89%8B%E6%A9%9F%E8%99%9F%E7%A2%BC%22%3E%3C/label%3E%3Clabel%3EEMAIL:%3Cinput%20type=%22text%22%20id=%22userEmail%22%20placeholder=%22%E9%9B%BB%E5%AD%90%E9%83%B5%E4%BB%B6%22%3E%3C/label%3E%3Ch2%3E%E6%B8%AC%E8%A9%A6%E8%B3%87%E6%96%99%3C/h2%3E%3Clabel%3E%E8%A1%8C%E6%95%B8:%3Cinput%20type=%22number%22%20id=%22rowCountInput%22%20value=%221%22%20min=%221%22%3E%3C/label%3E%3Cbutton%20id=%22generateRowsBtn%22%3E%E7%94%9F%E6%88%90%E8%A1%8C%3C/button%3E%3Ctable%20id=%22testDataTable%22%3E%3Cthead%3E%3Ctr%3E%3Cth%3E%E5%A7%93%E5%90%8D%3C/th%3E%3Cth%3EID%3C/th%3E%3Cth%3E%E6%93%8D%E4%BD%9C%3C/th%3E%3C/tr%3E%3C/thead%3E%3Ctbody%3E%3C/tbody%3E%3C/table%3E%3Cbutton%20id=%22generateUrlBtn%22%3E%E7%94%9F%E6%88%90URL%3C/button%3E%3Cdiv%20id=%22resultContainer%22%3E%3C/div%3E%60;n.appendChild(o),t.appendChild(n),document.body.appendChild(t),document.getElementById('generateRowsBtn').onclick=function(){const%20e=parseInt(document.getElementById('rowCountInput').value,10)||1,t=document.querySelector('#testDataTable%20tbody');t.innerHTML='',Array.from({length:e}).forEach(()=%3EaddNewRow())},function%20addNewRow(){const%20e=document.querySelector('#testDataTable%20tbody'),t=e.insertRow();t.innerHTML=%60%3Ctd%3E%3Cinput%20placeholder=%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E5%A7%93%E5%90%8D%22%3E%3C/td%3E%3Ctd%3E%3Cinput%20placeholder=%22%E8%AB%8B%E8%BC%B8%E5%85%A5ID%22%3E%3C/td%3E%3Ctd%3E%3Cbutton%20onclick=%22this.closest('tr').remove()%22%3E%E5%88%AA%E9%99%A4%3C/button%3E%3C/td%3E%60},document.getElementById('generateUrlBtn').onclick=function(){const%20e=document.getElementById('userPhone').value.trim(),t=document.getElementById('userEmail').value.trim(),n=document.querySelector('#testDataTable%20tbody'),o=document.getElementById('resultContainer');o.innerHTML='',Array.from(n.rows).forEach(function(n){const%20r=n.cells[0].querySelector('input').value.trim(),s=n.cells[1].querySelector('input').value.trim();if(r&&s){const%20n=generateUrl(t,e,s,'phone'),c=generateUrl(t,e,s,'email');o.innerHTML+=%60%3Cdiv%3E%3Ca%20href=%22${n}%22%20onclick=%22copyToClipboard('${n}')%22%3E%E6%89%8B%E6%A9%9FURL%3C/a%3E%3Ca%20href=%22${c}%22%20onclick=%22copyToClipboard('${c}')%22%3EEMAIL%20URL%3C/a%3E%3C/div%3E%60}})},function%20generateUrl(t,e,n,o){const%20r=o==='phone'?'0':'3';return%60https://example.com?email=${encodeURIComponent(t)}&phone=${encodeURIComponent(e)}&id=${encodeURIComponent(n)}&type=${r}%60},window.copyToClipboard=function(t){const%20e=document.createElement('input');e.value=t,document.body.appendChild(e),e.select(),document.execCommand('copy'),document.body.removeChild(e),alert('%E5%B7%B2%E8%A4%87%E8%A3%BD%E5%88%B0%E5%89%AA%E8%B2%BC%E7%B0%BF:%20'+t)}})();
＊＊＊＊＊第27段程式碼結束/175白名單 /＊＊＊＊＊




＊＊＊＊＊第28段程式碼開始/176UAT /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),loadScript=(src)=>new Promise((r,o)=>{const s=document.createElement('script');s.src=src;s.onload=r;s.onerror=o;document.body.appendChild(s);});await loadScript('https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js');const findToken=()=>{const url=new URL(location.href);return localStorage.getItem('euisToken')||url.searchParams.get('code')||prompt('%E6%89%BE%E4%B8%8D%E5%88%B0Token%EF%BC%8C%E8%AB%8B%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5');},token=findToken();if(!token)return alert('%E2%9D%8C %E6%89%BE%E4%B8%8D%E5%88%B0token%EF%BC%81%E8%AB%8B%E7%99%BB%E5%85%A5%E7%B3%BB%E7%B5%B1%E6%88%96%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5');const defaultAPI='https://euis-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let apiURL=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2API%E7%B6%B2%E5%9D%80%EF%BC%9A',defaultAPI)||defaultAPI;const input=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E5%96%AE%E8%99%9F%EF%BC%88%E9%80%97%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89%EF%BC%9A');if(!input)return alert('%E2%9A%A0%EF%B8%8F %E6%B2%92%E6%9C%89%E8%BC%B8%E5%85%A5%E4%BB%BB%E4%BD%95%E5%96%AE%E8%99%9F');const numbers=input.split(/\n|,/).map(x=>x.trim()).filter(Boolean),fields=[
＊＊＊＊＊第28段程式碼結束/176UAT /＊＊＊＊＊




＊＊＊＊＊第29段程式碼開始/179查詢a pi2 /＊＊＊＊＊
javascript:(function(){let apiInfo={endpoints:[],tokens:[],page:window.location.href,title:document.title,timestamp:new Date().toISOString()};const initUI=()=>{const existingContainer=document.getElementById('api-analyzer-container');if(existingContainer)existingContainer.remove();const container=document.createElement('div');container.id='api-analyzer-container';container.style.cssText='position:fixed;top:20px;right:20px;width:380px;max-height:80vh;background-color:#fff;border-radius:8px;box-shadow:0%200%2020px%20rgba(0,0,0,0.3);z-index:9999999;font-family:Arial,sans-serif;overflow:hidden;display:flex;flex-direction:column;';const%20header=document.createElement('div');header.style.cssText='display:flex;justify-content:space-between;align-items:center;padding:10px%2015px;background-color:#4a6cf7;color:white;font-weight:bold;cursor:move;user-select:none;';header.innerHTML='API%20%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7';const%20closeButton=document.createElement('button');closeButton.innerHTML='%E2%9C%95';closeButton.style.cssText='background:none;border:none;color:white;font-size:16px;cursor:pointer;padding:0%205px;';closeButton.onclick=()=%3Econtainer.remove();header.appendChild(closeButton);container.appendChild(header);const%20content=document.createElement('div');content.style.cssText='padding:15px;overflow-y:auto;flex-grow:1;max-height:calc(80vh%20-%2060px);';const%20actionArea=document.createElement('div');actionArea.style.cssText='display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;';const%20analyzeButton=createButton('%E5%88%86%E6%9E%90%E9%A0%81%E9%9D%A2API',analyzePageAPIs);const%20downloadButton=createButton('%E4%B8%8B%E8%BC%89%E9%81%B8%E5%8F%96API',downloadSelectedAPIs);actionArea.appendChild(analyzeButton);actionArea.appendChild(downloadButton);content.appendChild(actionArea);const%20resultArea=document.createElement('div');resultArea.id='api-analyzer-results';resultArea.style.cssText='width:100%;min-height:100px;max-height:400px;overflow-y:auto;border:1px%20solid%20#ddd;border-radius:5px;padding:10px;font-family:monospace;font-size:12px;margin-bottom:15px;white-space:pre-wrap;word-break:break-all;';content.appendChild(resultArea);container.appendChild(content);document.body.appendChild(container);makeDraggable(container,header);};const%20createButton=(text,onClick)=%3E{const%20btn=document.createElement('button');btn.innerText=text;btn.style.cssText='padding:6px%2012px;background-color:#4a6cf7;color:white;border:none;border-radius:4px;cursor:pointer;font-size:12px;';btn.onclick=onClick;return%20btn;};const%20makeDraggable=(element,handle)=%3E{let%20pos1=0,pos2=0,pos3=0,pos4=0;handle.onmousedown=(e)=%3E{e.preventDefault();pos3=e.clientX;pos4=e.clientY;document.onmouseup=closeDragElement;document.onmousemove=elementDrag;};const%20elementDrag=(e)=%3E{e.preventDefault();pos1=pos3-e.clientX;pos2=pos4-e.clientY;pos3=e.clientX;pos4=e.clientY;element.style.top=(element.offsetTop-pos2)+'px';element.style.left=(element.offsetLeft-pos1)+'px';};const%20closeDragElement=()=%3E{document.onmouseup=null;document.onmousemove=null;};};const%20analyzePageAPIs=()=%3E{apiInfo.endpoints=[];const%20originalXHROpen=XMLHttpRequest.prototype.open;const%20originalXHRSend=XMLHttpRequest.prototype.send;const%20originalFetch=window.fetch;XMLHttpRequest.prototype.open=function(method,url){this._method=method;this._url=url;return%20originalXHROpen.apply(this,arguments);};XMLHttpRequest.prototype.send=function(data){const%20xhr=this;xhr._requestData=data;xhr.addEventListener('load',function(){collectEndpoint(xhr._method,xhr._url,xhr._requestData,xhr.status,xhr.getAllResponseHeaders(),xhr.responseText);});return%20originalXHRSend.apply(this,arguments);};window.fetch=async%20function(input,init){const%20url=typeof%20input==='string'?input:input.url;const%20method=init&&init.method||'GET';const%20requestData=init&&init.body;const%20response=await%20originalFetch.apply(this,arguments);collectEndpoint(method,url,requestData,response.status,await%20response.headers,await%20response.clone().text());return%20response;};updateResults();};const%20collectEndpoint=(method,url,requestData,status,headers,responseText)=%3E{apiInfo.endpoints.push({method,url,requestData,status,headers,responseText});updateResults();};const%20updateResults=()=%3E{const%20resultArea=document.getElementById('api-analyzer-results');resultArea.innerHTML='';apiInfo.endpoints.forEach((endpoint,index)=%3E{const%20div=document.createElement('div');const%20checkbox=document.createElement('input');checkbox.type='checkbox';checkbox.id=%60api-${index}%60;checkbox.checked=true;const%20label=document.createElement('label');label.htmlFor=%60api-${index}%60;label.innerText=%60${endpoint.method}%20${endpoint.url}%60;div.appendChild(checkbox);div.appendChild(label);resultArea.appendChild(div);});};const%20downloadSelectedAPIs=()=%3E{let%20content='Method,URL,Status\n';apiInfo.endpoints.forEach((endpoint,index)=%3E{const%20checkbox=document.getElementById(%60api-${index}%60);if(checkbox&&checkbox.checked){content+=%60${endpoint.method},${endpoint.url},${endpoint.status}\n%60;}});const%20blob=new%20Blob([content],{type:'text/csv'});const%20link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download=%60selected-api-analysis-${new%20Date().toISOString().slice(0,10)}.csv%60;document.body.appendChild(link);link.click();document.body.removeChild(link);};initUI();})();
＊＊＊＊＊第29段程式碼結束/179查詢a pi2 /＊＊＊＊＊




＊＊＊＊＊第30段程式碼開始/180a17oldd /＊＊＊＊＊
javascript:(async()=>{const e=
＊＊＊＊＊第30段程式碼結束/180a17oldd /＊＊＊＊＊




＊＊＊＊＊第31段程式碼開始/217API套組new /＊＊＊＊＊
javascript:(async () => {  const sleep = t => new Promise(r => setTimeout(r, t));  const loadScript = (src) => new Promise((r, o) => {    const s = document.createElement('script');    s.src = src;    s.onload = r;    s.onerror = o;    document.body.appendChild(s);  });  // %E8%BC%89%E5%85%A5 XLSX %E5%87%BD%E5%BC%8F%E5%BA%AB  await loadScript('https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js');  // %E5%8F%96%E5%BE%97 token  const findToken = () => {    const url = new URL(location.href);    return localStorage.getItem('euisToken') || url.searchParams.get('code') || prompt('%E6%89%BE%E4%B8%8D%E5%88%B0Token%EF%BC%8C%E8%AB%8B%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5');  };  const token = findToken();  if (!token) return alert('%E2%9D%8C %E6%89%BE%E4%B8%8D%E5%88%B0token%EF%BC%81%E8%AB%8B%E7%99%BB%E5%85%A5%E7%B3%BB%E7%B5%B1%E6%88%96%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5');  const defaultAPI = 'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';  let apiURL = prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2API%E7%B6%B2%E5%9D%80%EF%BC%9A', defaultAPI) || defaultAPI;  const input = prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E5%96%AE%E8%99%9F%EF%BC%88%E9%80%97%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89%EF%BC%9A');  if (!input) return alert('%E2%9A%A0%EF%B8%8F %E6%B2%92%E6%9C%89%E8%BC%B8%E5%85%A5%E4%BB%BB%E4%BD%95%E5%96%AE%E8%99%9F');  const numbers = input.split(/\n|,/).map(x => x.trim()).filter(Boolean);  const fields = [
＊＊＊＊＊第31段程式碼結束/217API套組new /＊＊＊＊＊




＊＊＊＊＊第32段程式碼開始/177編輯+ /＊＊＊＊＊
javascript:(function(){var  oldPanel=document.getElementById('modeStatusPanel');if(oldPanel)oldPanel.remove();document.querySelectorAll('input').forEach(i=>{i.removeAttribute('disabled');i.removeAttribute('readonly');});['contextmenu','click','mousedown','mouseup','selectstart'].forEach(e=>{var o='on'+e;if(window.addEventListener)window.addEventListener(e,ev=>{for(var n=ev.originalTarget;n;n=n.parentNode)n[o]=null;},true);window[o]=null;document[o]=null;if(document.body)document.body[o]=null;});var editable=document.body.contentEditable==='true';if(editable){document.body.contentEditable='false';document.designMode='off';}else{document.body.contentEditable='true';document.designMode='on';}var panel=document.createElement('div');panel.id='modeStatusPanel';panel.style.position='fixed';panel.style.top='5px';panel.style.left='5px';panel.style.zIndex=99999;panel.style.backgroundColor='rgba(0,0,0,0.7)';panel.style.color='#fff';panel.style.fontSize='12px';panel.style.fontFamily='Arial,sans-serif';panel.style.padding='8px%2012px%2024px%2012px';panel.style.borderRadius='4px';panel.style.maxWidth='260px';panel.style.lineHeight='1.4em';panel.style.boxShadow='0%200%205px%20rgba(0,0,0,0.5)';panel.style.userSelect='none';panel.style.cursor='move';panel.style.transition='opacity%200.3s%20ease';var%20modeText=editable?'%E7%9B%AE%E5%89%8D%E6%A8%A1%E5%BC%8F%EF%BC%9A%E9%9D%9E%E7%B7%A8%E8%BC%AF%E6%A8%A1%E5%BC%8F':'%E7%9B%AE%E5%89%8D%E6%A8%A1%E5%BC%8F%EF%BC%9A%E5%8F%AF%E7%B7%A8%E8%BC%AF%E6%A8%A1%E5%BC%8F';var%20canUse=['%E8%BC%B8%E5%85%A5%E6%A1%86%E5%8F%AF%E7%B7%A8%E8%BC%AF','%E5%8F%B3%E9%8D%B5%E5%8F%AF%E7%94%A8','%E6%96%87%E5%AD%97%E5%8F%AF%E9%81%B8%E5%8F%96'];var%20cannotUse=editable?['%E8%BC%B8%E5%85%A5%E6%A1%86%E7%A6%81%E7%94%A8','%E5%8F%B3%E9%8D%B5%E7%A6%81%E7%94%A8','%E6%96%87%E5%AD%97%E4%B8%8D%E5%8F%AF%E9%81%B8']:[];panel.innerHTML=%60%3Cdiv%20style=%22font-weight:bold;margin-bottom:6px;%22%3E${modeText}%3C/div%3E%3Cdiv%3E%3Cu%3E%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%8A%9F%E8%83%BD%EF%BC%9A%3C/u%3E%3Cbr%3E${canUse.join('%3Cbr%3E')}%3C/div%3E%3Cdiv%20style=%22margin-top:6px;%22%3E%3Cu%3E%E4%B8%8D%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%8A%9F%E8%83%BD%EF%BC%9A%3C/u%3E%3Cbr%3E${cannotUse.length%3E0?cannotUse.join('%3Cbr%3E'):'%E7%84%A1'}%3C/div%3E%3Cdiv%20style=%22position:absolute;bottom:6px;left:12px;right:12px;display:flex;align-items:center;gap:6px;%22%3E%3Clabel%20style=%22font-size:11px;user-select:none;%22%20for=%22opacityRange%22%3E%E9%80%8F%E6%98%8E%E5%BA%A6%3C/label%3E%3Cinput%20id=%22opacityRange%22%20type=%22range%22%20min=%220.2%22%20max=%221%22%20step=%220.05%22%20value=%220.7%22%20style=%22flex:1;cursor:pointer;%22%3E%3Cbutton%20id=%22toggleBtn%22%20style=%22background:#444;color:#fff;border:none;padding:2px%206px;cursor:pointer;font-size:11px;border-radius:3px;%22%20title=%22%E7%B8%AE%E6%94%BE/%E9%82%84%E5%8E%9F%E8%A6%96%E7%AA%97%22%3E-%3C/button%3E%3C/div%3E%60;document.body.appendChild(panel);panel.style.opacity='0.7';(function(){var%20posX=0,posY=0,mouseX=0,mouseY=0,dragging=false;panel.addEventListener('mousedown',e=%3E{if(e.target.tagName==='INPUT'||e.target.tagName==='BUTTON')return;dragging=true;mouseX=e.clientX;mouseY=e.clientY;posX=parseInt(panel.style.left);posY=parseInt(panel.style.top);e.preventDefault();});document.addEventListener('mouseup',()=%3E{dragging=false;});document.addEventListener('mousemove',e=%3E{if(dragging){var%20dx=e.clientX-mouseX;var%20dy=e.clientY-mouseY;panel.style.left=(posX+dx)+'px';panel.style.top=(posY+dy)+'px';}});})();var%20opacityRange=document.getElementById('opacityRange');opacityRange.addEventListener('input',e=%3E{panel.style.opacity=e.target.value;});var%20toggleBtn=document.getElementById('toggleBtn');var%20minimized=false;toggleBtn.addEventListener('click',()=%3E{if(!minimized){panel.style.height='auto';panel.style.padding='8px%2012px';panel.style.maxWidth='150px';panel.querySelectorAll('div:not(:first-child)').forEach(d=%3Ed.style.display='none');opacityRange.style.display='none';toggleBtn.textContent='+';minimized=true;}else{panel.style.padding='8px%2012px%2024px%2012px';panel.style.maxWidth='260px';panel.querySelectorAll('div:not(:first-child)').forEach(d=%3Ed.style.display='block');opacityRange.style.display='inline-block';toggleBtn.textContent='-';minimized=false;}});})();
＊＊＊＊＊第32段程式碼結束/177編輯+ /＊＊＊＊＊




＊＊＊＊＊第33段程式碼開始/173系統有效 /＊＊＊＊＊
javascript:(function(){fetch('https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/businessDate/getBusinessDate',{method:'POST',headers:{'Content-Type':'application/json;charset=UTF-8','SSO-TOKEN':'%E4%BD%A0%E7%9A%84token'}}).then(r=>r.json()).then(d=>alert('%E7%B3%BB%E7%B5%B1Business Date: '+(d.sysBusinessDate||JSON.stringify(d)))).catch(e=>alert('%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97'));})();
＊＊＊＊＊第33段程式碼結束/173系統有效 /＊＊＊＊＊




＊＊＊＊＊第34段程式碼開始/178Business有效 /＊＊＊＊＊
javascript:(function(){const w=window.open('','BusinessDateTool','width=400,height=300,top=100,left=100');w.document.write('<html><head><title>Business Date %E8%A8%AD%E5%AE%9A</title><style>body{font-family:Arial,sans-serif;font-size:16px;background-color:rgba(0,0,0,0.5);color:white;padding:20px}.container{background-color:rgba(255,255,255,0.2);border-radius:8px;padding:20px;max-width:400px;margin:auto;position:relative}.header{font-size:18px;margin-bottom:20px}.input-group{margin:15px 0}.input-group input{padding:10px;font-size:16px;width:100%;margin-right:10px}.btn{background-color:#4CAF50;color:white;padding:10px;border:none;cursor:pointer;font-size:16px;border-radius:5px}.btn:hover{background-color:#45a049}.error{color:red;font-size:14px}.success{color:green;font-size:14px}.close-btn{background-color:#f44336;color:white;border:none;padding:5px%2015px;font-size:16px;border-radius:5px;cursor:pointer;position:absolute;top:10px;right:10px}.close-btn:hover{background-color:#e41b0d}%3C/style%3E%3C/head%3E%3Cbody%3E%3Cdiv%20class=%22container%22%3E%3Cbutton%20class=%22close-btn%22%20id=%22closeBtn%22%3E%E9%97%9C%E9%96%89%3C/button%3E%3Cdiv%20class=%22header%22%3EBusiness%20Date%20%E8%A8%AD%E5%AE%9A%3C/div%3E%3Cdiv%20id=%22personalDate%22%3E%E5%80%8B%E4%BA%BA%20Business%20Date:%20%E5%8A%A0%E8%BC%89%E4%B8%AD...%3C/div%3E%3Cdiv%20id=%22systemDate%22%3E%E7%B3%BB%E7%B5%B1%20Business%20Date:%20%E5%8A%A0%E8%BC%89%E4%B8%AD...%3C/div%3E%3Cdiv%20class=%22input-group%22%3E%3Clabel%20for=%22modifyDate%22%3E%E4%BF%AE%E6%94%B9%20Business%20Date:%3C/label%3E%3Cinput%20type=%22text%22%20id=%22modifyDate%22%20placeholder=%22YYYYMMDD%22%3E%3Cbutton%20class=%22btn%22%20id=%22executeBtn%22%3E%E5%9F%B7%E8%A1%8C%3C/button%3E%3C/div%3E%3Cdiv%20id=%22status%22%3E%3C/div%3E%3C/div%3E%3Cscript%3Econst%20API_GET_PERSONAL_DATE=%22https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/businessDate/getMyBusinessDate%22,API_GET_SYSTEM_DATE=%22https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/businessDate/getBusinessDate%22,API_SET_PERSONAL_DATE=%22https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/businessDate/setMyBusinessDate%22;function%20fetchData(){fetch(API_GET_PERSONAL_DATE,{method:%22POST%22,headers:{%22Content-Type%22:%22application/json;charset=UTF-8%22}}).then(r=%3Er.json()).then(d=%3E{document.getElementById(%22personalDate%22).textContent=%22%E5%80%8B%E4%BA%BA%20Business%20Date:%20%22+d});fetch(API_GET_SYSTEM_DATE,{method:%22POST%22,headers:{%22Content-Type%22:%22application/json;charset=UTF-8%22}}).then(r=%3Er.json()).then(d=%3E{document.getElementById(%22systemDate%22).textContent=%22%E7%B3%BB%E7%B5%B1%20Business%20Date:%20%22+d.sysBusinessDate})}function%20updateBusinessDate(n){fetch(API_SET_PERSONAL_DATE,{method:%22POST%22,headers:{%22Content-Type%22:%22application/json;charset=UTF-8%22},body:JSON.stringify({myBusinessDate:n})}).then(r=%3Er.json()).then(d=%3E{d?showStatus(%22%E6%9B%B4%E6%96%B0%E6%88%90%E5%8A%9F%EF%BC%81%22,%22success%22):showStatus(%22%E6%9B%B4%E6%96%B0%E5%A4%B1%E6%95%97%EF%BC%81%22,%22error%22)}).catch(()=%3E{showStatus(%22%E6%9B%B4%E6%96%B0%E5%A4%B1%E6%95%97%EF%BC%81%22,%22error%22)})}function%20showStatus(m,t){const%20s=document.getElementById(%22status%22);s.textContent=m,t==%22error%22?(s.classList.add(%22error%22),s.classList.remove(%22success%22)):(s.classList.add(%22success%22),s.classList.remove(%22error%22))}function%20formatDate(d){return%20d.length==8?d.slice(0,4)+%22-%22+d.slice(4,6)+%22-%22+d.slice(6):d}document.getElementById(%22executeBtn%22).addEventListener(%22click%22,()=%3E{const%20i=document.getElementById(%22modifyDate%22).value.trim(),f=formatDate(i);f.length==10?updateBusinessDate(f):showStatus(%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E7%9A%84%E6%97%A5%E6%9C%9F%EF%BC%88YYYYMMDD%EF%BC%89%22,%22error%22)});document.getElementById(%22closeBtn%22).addEventListener(%22click%22,()=%3E{w.close()});window.onload=fetchData;%3C/script%3E%3C/body%3E%3C/html%3E');})();
＊＊＊＊＊第34段程式碼結束/178Business有效 /＊＊＊＊＊




＊＊＊＊＊第35段程式碼開始/3A17有效 /＊＊＊＊＊
javascript:(function(){var s=document.createElement('script');s.src='https://cdn.jsdelivr.net/gh/k791031k/UAT_TOOL_R/A171.js';document.body.appendChild(s);})();
＊＊＊＊＊第35段程式碼結束/3A17有效 /＊＊＊＊＊




＊＊＊＊＊第36段程式碼開始/4EUISV有效 /＊＊＊＊＊
javascript:(function(){var s=document.createElement('script');s.src='https://cdn.jsdelivr.net/gh/k791031k/UAT_TOOL_R/A172.js';document.body.appendChild(s);})();
＊＊＊＊＊第36段程式碼結束/4EUISV有效 /＊＊＊＊＊




＊＊＊＊＊第37段程式碼開始/"171plan⚡ 有效 /＊＊＊＊＊
"
＊＊＊＊＊第37段程式碼結束/"171plan⚡ 有效 /＊＊＊＊＊




＊＊＊＊＊第38段程式碼開始/17商品 /＊＊＊＊＊
javascript:(async()=>{const API_URL_TEMPLATES_PQ={uat:{planCodeQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'},prod:{planCodeQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'}};const TOKEN_STORAGE_KEY_PQ='euisPlanCodeToken_v2';const TOKEN_STORAGE_KEY_PQ_FALLBACK='euisToken';const MAIN_UI_ID_PQ='productQueryBookmarkletDiv_Structured_v2';const CSS_ID_PQ='productQueryBookmarkletCss_Structured_v2';const Z_INDEX_OVERLAY_PQ=2147483640;const Z_INDEX_DIALOG_PQ=2147483641;const Z_INDEX_MAIN_UI_PQ=2147483630;const Z_INDEX_NOTIFICATION_PQ=2147483647;const PRODUCT_FIELD_DEFINITIONS_PQ={CUR:{1:
＊＊＊＊＊第38段程式碼結束/17商品 /＊＊＊＊＊




＊＊＊＊＊第39段程式碼開始/18商品多 /＊＊＊＊＊
javascript:(async function(){const API_URL_TEMPLATES_PQ={uat:{planCodeQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'},prod:{planCodeQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'}};const TOKEN_STORAGE_KEY_PQ='euisPlanCodeToken_v2';const TOKEN_STORAGE_KEY_PQ_FALLBACK='euisToken';const MAIN_UI_ID_PQ='productQueryBookmarkletDiv_Structured_v2';const CSS_ID_PQ='productQueryBookmarkletCss_Structured_v2';const Z_INDEX_OVERLAY_PQ=2147483640;const Z_INDEX_DIALOG_PQ=2147483641;const Z_INDEX_MAIN_UI_PQ=2147483630;const Z_INDEX_NOTIFICATION_PQ=2147483647;const PRODUCT_FIELD_DEFINITIONS_PQ={CUR:{1:
＊＊＊＊＊第39段程式碼結束/18商品多 /＊＊＊＊＊




＊＊＊＊＊第40段程式碼開始/19商品 /＊＊＊＊＊
javascript:(async function(){let currentPage=1;let totalPages=1;let allDataArray=[];const recordsPerPage=100;let currentToken;let displayedDataArray=[];const API_URL_PLANCODE_QUERY=
＊＊＊＊＊第40段程式碼結束/19商品 /＊＊＊＊＊




＊＊＊＊＊第41段程式碼開始/21商品 /＊＊＊＊＊
javascript:(async function(){    'use strict';          const state={        currentPage:1,totalPages:1,allDataArray:[],recordsPerPage:100,currentToken:null,        displayedDataArray:[],isShowingAllData:!1,queriedDataCache:new Map(),        currentSortColumn:null,currentSortDirection:'asc',apiAbortController:null,        currentFilters:{}   };          const API_URLS={        PLANCODE_QUERY:
＊＊＊＊＊第41段程式碼結束/21商品 /＊＊＊＊＊




＊＊＊＊＊第42段程式碼開始/55PLAN_4 /＊＊＊＊＊
javascript:(async()=>{console.log('[%E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E8%85%B3%E6%9C%AC] %E8%85%B3%E6%9C%AC%E9%96%8B%E5%A7%8B%E5%9F%B7%E8%A1%8C R3-debug...');const API_URL_TEMPLATES_PQ={uat:{planCodeQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'},prod:{planCodeQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'}};const TOKEN_STORAGE_KEY_PQ='euisPlanCodeToken_v2';const TOKEN_STORAGE_KEY_PQ_FALLBACK='euisToken';const MAIN_UI_ID_PQ='productQueryBookmarkletDiv_Structured_v2';const CSS_ID_PQ='productQueryBookmarkletCss_Structured_v2';const Z_INDEX_OVERLAY_PQ=2147483640;const Z_INDEX_DIALOG_PQ=2147483641;const Z_INDEX_MAIN_UI_PQ=2147483630;const Z_INDEX_NOTIFICATION_PQ=2147483647;const PRODUCT_FIELD_DEFINITIONS_PQ={CUR:{1:
＊＊＊＊＊第42段程式碼結束/55PLAN_4 /＊＊＊＊＊




＊＊＊＊＊第43段程式碼開始/56PLAN_5 /＊＊＊＊＊
javascript:(async function(){%C2%A0 %C2%A0 'use strict';%C2%A0 %C2%A0%C2%A0 %C2%A0%C2%A0 %C2%A0 const state={%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentPage:1,totalPages:1,allDataArray:[],recordsPerPage:100,currentToken:null,%C2%A0 %C2%A0 %C2%A0 %C2%A0 displayedDataArray:[],isShowingAllData:!1,queriedDataCache:new Map(),%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentSortColumn:null,currentSortDirection:'asc',apiAbortController:null,%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentFilters:{},errorMessage:null%C2%A0 %C2%A0};%C2%A0 %C2%A0%C2%A0 %C2%A0%C2%A0 %C2%A0 const API_URLS={%C2%A0 %C2%A0 %C2%A0 %C2%A0 PLANCODE_QUERY:
＊＊＊＊＊第43段程式碼結束/56PLAN_5 /＊＊＊＊＊




＊＊＊＊＊第44段程式碼開始/60perlesty /＊＊＊＊＊
javascript:(function(){ 'use strict';  /**  * KGI Life %E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E5%B7%A5%E5%85%B7 - 2025 %E6%9C%80%E4%BD%B3%E5%8C%96%E7%89%88  * by Perplexity AI (for %E5%89%8D%E7%AB%AF%E4%B8%BB%E7%AE%A1/%E6%9E%B6%E6%A7%8B%E5%B8%AB/%E8%B3%87%E6%B7%B1 UI/UX %E8%A8%AD%E8%A8%88%E5%B8%AB)  */  /* ==== CONFIG ==== */ const BATCH_SIZE = 50; const CONFIG = {   API: {     prod: {       planCodeQuery:   'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',       planCodeDetail:  'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',       saleDateQuery:   'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'     },     uat: {       planCodeQuery:   'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',       planCodeDetail:  'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',       saleDateQuery:   'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'     }   },   STORAGE: {     TOKEN_KEY:
＊＊＊＊＊第44段程式碼結束/60perlesty /＊＊＊＊＊




＊＊＊＊＊第45段程式碼開始/61gemibi /＊＊＊＊＊
javascript:(function(){'use strict';const BATCH_SIZE=50;const CONFIG={API:{prod:{planCodeQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'},uat:{planCodeQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',planCodeDetail:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',saleDateQuery:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'}},STORAGE:{TOKEN_KEY:
＊＊＊＊＊第45段程式碼結束/61gemibi /＊＊＊＊＊




＊＊＊＊＊第46段程式碼開始/90PLANNEW /＊＊＊＊＊
javascript:(async function(){'use strict';const STYLE_ID='planCodeBookmarkletStyle';if(!document.getElementById(STYLE_ID)){const style=document.createElement('style');style.id=STYLE_ID;style.innerHTML=`      .pct-modal-mask { position:fixed;z-index:99999;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.18);}      .pct-modal { font-family:Arial,sans-serif; background:#fff;%20border-radius:10px;%20box-shadow:0%204px%2024px%20#0002;%20padding:0;%20min-width:410px;%20max-width:98vw;%20position:fixed;%20top:60px;%20left:50%;%20transform:translateX(-50%);%20z-index:100000;}%20%20%20%20%20%20.pct-modal-header%20{%20padding:16px%2020px%208px%2020px;%20font-size:20px;%20font-weight:bold;%20border-bottom:1px%20solid%20#eee;%20cursor:move;%20user-select:none;}%20%20%20%20%20%20.pct-modal-body%20{%20padding:16px%2020px%208px%2020px;}%20%20%20%20%20%20.pct-modal-footer%20{%20padding:12px%2020px%2016px%2020px;%20text-align:right;%20border-top:1px%20solid%20#eee;}%20%20%20%20%20%20.pct-btn%20{%20display:inline-block;%20margin:0%206px%200%200;%20padding:7px%2018px;%20font-size:15px;%20border-radius:6px;%20border:none;%20background:#1967d2;%20color:#fff;%20cursor:pointer;%20transition:background%20.2s;}%20%20%20%20%20%20.pct-btn:hover%20{%20background:#1250a6;}%20%20%20%20%20%20.pct-btn-secondary%20{%20background:#e0e0e0;%20color:#333;}%20%20%20%20%20%20.pct-btn-secondary:hover%20{%20background:#bdbdbd;}%20%20%20%20%20%20.pct-btn-danger%20{%20background:#e53935;%20color:#fff;}%20%20%20%20%20%20.pct-btn-danger:hover%20{%20background:#b71c1c;}%20%20%20%20%20%20.pct-btn-cancel%20{%20background:#fd7e14;%20color:#fff;}%20%20%20%20%20%20.pct-btn-cancel:hover%20{%20background:#c66900;}%20%20%20%20%20%20.pct-input%20{%20width:100%;%20font-size:16px;%20padding:7px%2012px;%20border-radius:5px;%20border:1px%20solid%20#bbb;%20box-sizing:border-box;}%20%20%20%20%20%20.pct-input:disabled%20{%20background:#f5f5f5;%20color:#aaa;}%20%20%20%20%20%20.pct-error%20{%20color:#e53935;%20font-size:14px;%20margin:8px%200%200%200;}%20%20%20%20%20%20.pct-table-wrap%20{%20max-height:70vh;%20overflow:auto;%20margin:10px%200;}%20%20%20%20%20%20.pct-table%20{%20border-collapse:collapse;%20width:100%;%20font-size:15px;}%20%20%20%20%20%20.pct-table%20th,%20.pct-table%20td%20{%20border:1px%20solid%20#ddd;%20padding:7px%208px;%20text-align:left;}%20%20%20%20%20%20.pct-table%20th%20{%20background:#343a40;%20color:#fff;%20cursor:pointer;%20position:sticky;%20top:0;%20z-index:1;}%20%20%20%20%20%20.pct-table%20th:hover%20{%20background:#495057;}%20%20%20%20%20%20.pct-table%20tr.special-row%20{%20background:#fffde7;}%20%20%20%20%20%20.pct-table%20tr:hover%20{%20background:#e3f2fd;}%20%20%20%20%20%20.pct-status-onsale%20{%20color:#1976d2;%20font-weight:bold;}%20%20%20%20%20%20.pct-status-offsale%20{%20color:#e53935;}%20%20%20%20%20%20.pct-status-special%20{%20background:#fffde7;}%20%20%20%20%20%20.pct-toast%20{%20position:fixed;%20left:50%;%20top:30px;%20transform:translateX(-50%);%20background:#323232;%20color:#fff;%20padding:10px%2022px;%20border-radius:8px;%20font-size:16px;%20z-index:100001;%20opacity:0;%20pointer-events:none;%20transition:opacity%20.3s;}%20%20%20%20%20%20.pct-toast.pct-toast-show%20{%20opacity:1;%20pointer-events:auto;}%20%20%20%20%20%20.pct-summary%20{%20font-size:15px;%20margin-bottom:10px;%20}%20%20%20%20%20%20.pct-filter-btn%20{%20font-size:14px;%20padding:4px%2012px;%20background:#fffde7;%20color:#a67c00;%20border:1px%20solid%20#ffe082;%20border-radius:5px;%20margin-left:8px;%20cursor:pointer;}%20%20%20%20%20%20.pct-filter-btn:hover%20{%20background:#ffe082;}%20%20%20%20%20%20.pct-filter-group%20{%20margin:0%208px;%20display:inline-block;}%20%20%20%20%20%20.pct-filter-btn.active%20{%20background:#007bff;%20color:#fff;%20border-color:#007bff;%20font-weight:bold;}%20%20%20%20%20%20.pct-table%20td.copyable%20{%20cursor:pointer;%20transition:background%200.2s;}%20%20%20%20%20%20.pct-table%20td.copyable:hover%20{%20background:#e3f2fd;}%20%20%20%20%60;document.head.appendChild(style)}const%20State={env:detectEnv(),apiBase:'',token:'',tokenCheckEnabled:!0,allData:[],pageNo:1,pageSize:50,totalRecords:0,filterSpecial:!1,sortKey:'',sortAsc:!0,cacheDetail:new%20Map(),cacheChannel:new%20Map(),filters:{},isShowingAll:!1,queryMode:'planCode',queryInput:'',apiAbortController:null,modalDrag:{dragging:!1,offsetX:0,offsetY:0}};function%20detectEnv(){const%20host=window.location.host.toLowerCase();if(host.includes('uat')||host.includes('test'))return'UAT';return'PROD'}function%20envLabel(){return%20State.env==='PROD'?'%E6%AD%A3%E5%BC%8F':'%E6%B8%AC%E8%A9%A6'}function%20formatToday(){const%20d=new%20Date();return%20%60${d.getFullYear()}${('0'%20+%20(d.getMonth()%20+%201)).slice(-2)}${('0'%20+%20d.getDate()).slice(-2)}%60}function%20formatDate(dt){if(!dt)return'';return%20dt.replace(/[-%20:]/g,'').slice(0,8)}function%20getSaleStatus(today,saleStart,saleEnd){if(!saleStart||!saleEnd)return'';if(saleEnd==='99991231'||saleEnd==='9999-12-31'||saleEnd==='9999-12-31%2000:00:00')return'%E7%8F%BE%E5%94%AE%E4%B8%AD';const%20t=Number(today),s=Number(formatDate(saleStart)),e=Number(formatDate(saleEnd));if(t%3Ee)return'%E5%81%9C%E5%94%AE';if(t%3E=s&&t%3C=e)return'%E7%8F%BE%E5%94%AE%E4%B8%AD';return'%E6%9C%AA%E9%96%8B%E5%A7%8B'}function%20currencyConvert(val){if(val===1||val==='1')return'TWD';if(val===2||val==='2')return'USD';return%20val||''}function%20unitConvert(val){if(!val)return'';if(val==='A1')return'%E5%85%83';if(val==='A4')return'%E8%90%AC%E5%85%83';return%20val}function%20coverageTypeConvert(val){if(val==='M')return'%E4%B8%BB%E7%B4%84';if(val==='R')return'%E9%99%84%E7%B4%84';return%20val||''}function%20channelCodeConvert(code){if(!code)return'';return%20code==='OT'?'BK':code}function%20toHalfWidth(str){if(typeof%20str!==%22string%22)return%20str;return%20str.replace(/[\uff01-\uff5e]/g,(char)=%3EString.fromCharCode(char.charCodeAt(0)-0xfee0)).replace(/\u3000/g,%22%20%22)}const%20Api={async%20call(endpoint,params,signal){const%20url=%60${State.apiBase}${endpoint}%60;const%20headers={'Content-Type':'application/json','SSO-TOKEN':State.token};const%20res=await%20fetch(url,{method:'POST',headers,body:JSON.stringify(params),signal});if(!res.ok)throw%20new%20Error(%60API%20%E8%AB%8B%E6%B1%82%E5%A4%B1%E6%95%97%20(${res.status})%60);return%20res.json()},async%20verifyToken(token){try{const%20testApi='/planCodeController/query';const%20url=%60${State.apiBase}${testApi}%60;const%20headers={'Content-Type':'application/json','SSO-TOKEN':token};const%20res=await%20fetch(url,{method:'POST',headers,body:JSON.stringify({planCode:'5105',pageNo:1,pageSize:1})});const%20data=await%20res.json();return!!data.records}catch{return!1}}};let%20pctModal=null;function%20showModal({title,body,footer,onOpen}){closeModal();const%20mask=document.createElement('div');mask.className='pct-modal-mask';const%20modal=document.createElement('div');modal.className='pct-modal';modal.innerHTML=%60%20%20%20%20%20%20%3Cdiv%20class=%22pct-modal-header%22%20id=%22pct-modal-header%22%3E${title}%3C/div%3E%20%20%20%20%20%20%3Cdiv%20class=%22pct-modal-body%22%3E${body}%3C/div%3E%20%20%20%20%20%20%3Cdiv%20class=%22pct-modal-footer%22%3E${footer%20||%20''}%3C/div%3E%20%20%20%20%60;document.body.appendChild(mask);document.body.appendChild(modal);pctModal={mask,modal};const%20header=modal.querySelector('.pct-modal-header');if(header){header.onmousedown=function(e){State.modalDrag.dragging=!0;State.modalDrag.offsetX=e.clientX-modal.offsetLeft;State.modalDrag.offsetY=e.clientY-modal.offsetTop;document.onmousemove=function(e2){if(!State.modalDrag.dragging)return;modal.style.left=(e2.clientX-State.modalDrag.offsetX)+'px';modal.style.top=(e2.clientY-State.modalDrag.offsetY)+'px';modal.style.transform=''};document.onmouseup=function(){State.modalDrag.dragging=!1;document.onmousemove=null;document.onmouseup=null}}}if(onOpen)setTimeout(onOpen,10);}function%20closeModal(){if(pctModal){pctModal.mask.remove();pctModal.modal.remove();pctModal=null}}function%20showToast(msg,type='info'){let%20el=document.getElementById('pct-toast');if(!el){el=document.createElement('div');el.id='pct-toast';el.className='pct-toast';document.body.appendChild(el)}el.textContent=msg;el.classList.add('pct-toast-show');setTimeout(()=%3Eel.classList.remove('pct-toast-show'),1800)}function%20showError(msg){const%20el=document.getElementById('pct-error');if(el){el.textContent=msg;el.style.display=''}else{showToast(msg,'error')}}function%20modeLabel(mode){switch(mode){case%20'planCode':return'%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F';case%20'planCodeName':return'%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1%E9%97%9C%E9%8D%B5%E5%AD%97';case%20'allPlans':return'%E6%9F%A5%E5%85%A8%E9%83%A8';case%20'inSale':return'%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81';default:return%20mode}}async%20function%20main(){State.apiBase=State.env==='PROD'?'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api':'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api';State.token=localStorage.getItem('SSO-TOKEN')||'';State.tokenCheckEnabled=!0;State.allData=[];State.pageNo=1;State.filterSpecial=!1;State.sortKey='';State.sortAsc=!0;State.cacheDetail.clear();State.cacheChannel.clear();State.filters={};State.isShowingAll=!1;await%20showTokenDialog()}async%20function%20showTokenDialog(){return%20new%20Promise((resolve)=%3E{showModal({title:%60%E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E5%B0%8F%E5%B7%A5%E5%85%B7%EF%BC%88${envLabel()}%EF%BC%89%60,body:%60%20%20%20%20%20%20%20%20%20%20%3Cdiv%3E%E8%AB%8B%E8%BC%B8%E5%85%A5%20SSO-TOKEN%EF%BC%9A%3C/div%3E%20%20%20%20%20%20%20%20%20%20%3Cinput%20class=%22pct-input%22%20id=%22pct-token-input%22%20type=%22text%22%20value=%22${State.token%20||%20''}%22%20autocomplete=%22off%22%20/%3E%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22pct-error%22%20id=%22pct-error%22%20style=%22display:none%22%3E%3C/div%3E%20%20%20%20%20%20%20%20%60,footer:%60%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-token-ok%22%3E%E7%A2%BA%E8%AA%8D%3C/button%3E%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-token-skip%22%3E%E7%95%A5%E9%81%8E%E9%A9%97%E8%AD%89%3C/button%3E%20%20%20%20%20%20%20%20%60,onOpen:()=%3E{document.getElementById('pct-token-input').focus();document.getElementById('pct-token-ok').onclick=async()=%3E{const%20val=document.getElementById('pct-token-input').value.trim();if(!val){showError('%E8%AB%8B%E8%BC%B8%E5%85%A5%20Token');return}showToast('%E6%AA%A2%E6%9F%A5%20Token%20%E4%B8%AD...');State.token=val;localStorage.setItem('SSO-TOKEN',val);if(State.tokenCheckEnabled){const%20ok=await%20Api.verifyToken(val);if(ok){closeModal();showToast('Token%20%E9%A9%97%E8%AD%89%E6%88%90%E5%8A%9F');await%20showQueryDialog();resolve()}else{showError('Token%20%E9%A9%97%E8%AD%89%E5%A4%B1%E6%95%97%EF%BC%8C%E8%AB%8B%E9%87%8D%E6%96%B0%E8%BC%B8%E5%85%A5')}}else{closeModal();await%20showQueryDialog();resolve()}};document.getElementById('pct-token-skip').onclick=async()=%3E{State.tokenCheckEnabled=!1;closeModal();await%20showQueryDialog();resolve()}}})})}async%20function%20showQueryDialog(){return%20new%20Promise((resolve)=%3E{showModal({title:'%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6%E8%A8%AD%E5%AE%9A',body:%60%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22margin-bottom:8px;%22%3E%E6%9F%A5%E8%A9%A2%E6%A8%A1%E5%BC%8F%EF%BC%9A%3C/div%3E%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22pct-mode-wrap%22%20style=%22display:flex;gap:8px;margin-bottom:12px;%22%3E%20%20%20%20%20%20%20%20%20%20%20%20${['planCode',%20'planCodeName',%20'allPlans',%20'inSale'].map(mode%20=%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%60%3Cdiv%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-mode-${mode}%22%20data-mode=%22${mode}%22%20style=%22flex:1%22%3E${modeLabel(mode)}%3C/div%3E%60%20%20%20%20%20%20%20%20%20%20%20%20).join('')}%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%3Cinput%20class=%22pct-input%22%20id=%22pct-query-input%22%20type=%22text%22%20placeholder=%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2%E5%85%A7%E5%AE%B9%22%20autocomplete=%22off%22%20style=%22margin-bottom:8px;%22%20/%3E%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22pct-error%22%20id=%22pct-error%22%20style=%22display:none%22%3E%3C/div%3E%20%20%20%20%20%20%20%20%60,footer:%60%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-query-ok%22%3E%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-query-cancel%22%3E%E5%8F%96%E6%B6%88%3C/button%3E%20%20%20%20%20%20%20%20%60,onOpen:()=%3E{let%20mode='planCode';updateModeUI();document.getElementById('pct-query-input').focus();document.getElementById('pct-query-input').disabled=!1;Array.from(document.querySelectorAll('#pct-mode-wrap%20.pct-btn')).forEach(btn=%3E{btn.onclick=()=%3E{mode=btn.dataset.mode;updateModeUI();if(mode==='allPlans'||mode==='inSale'){document.getElementById('pct-query-input').disabled=!0;document.getElementById('pct-query-input').value=''}else{document.getElementById('pct-query-input').disabled=!1;document.getElementById('pct-query-input').focus()}}});function%20updateModeUI(){Array.from(document.querySelectorAll('#pct-mode-wrap%20.pct-btn')).forEach(btn=%3E{btn.style.background=btn.dataset.mode===mode?'#1967d2':'#e0e0e0';btn.style.color=btn.dataset.mode===mode?'#fff':'#333';btn.style.fontWeight=btn.dataset.mode===mode?'bold':'normal'})}document.getElementById('pct-query-ok').onclick=async()=%3E{let%20value=document.getElementById('pct-query-input').value.trim();if((mode==='planCode'||mode==='planCodeName')&&!value){showError('%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2%E5%85%A7%E5%AE%B9');return}closeModal();State.queryMode=mode;State.queryInput=value;State.pageNo=1;State.filterSpecial=!1;State.filters={};await%20doQuery();resolve()};document.getElementById('pct-query-cancel').onclick=()=%3E{closeModal();resolve()}}})})}async%20function%20doQuery(){showToast('%E6%9F%A5%E8%A9%A2%E4%B8%AD...');let%20params;switch(State.queryMode){case%20'planCode':params={planCode:State.queryInput,pageNo:State.pageNo,pageSize:State.pageSize};break;case%20'planCodeName':params={planCodeName:State.queryInput,pageNo:State.pageNo,pageSize:State.pageSize};break;case%20'allPlans':params={planCodeName:'',pageNo:State.pageNo,pageSize:State.pageSize};break;case%20'inSale':params={saleEndDate:'9999-12-31%2000:00:00',pageNo:State.pageNo,pageSize:State.pageSize};break;default:showToast('%E6%9C%AA%E7%9F%A5%E6%9F%A5%E8%A9%A2%E6%A8%A1%E5%BC%8F','error');return}try{State.apiAbortController=new%20AbortController();const%20signal=State.apiAbortController.signal;const%20result=await%20Api.call('/planCodeController/query',params,signal);if(!result.records||result.records.length===0){showError('%E6%9F%A5%E7%84%A1%E8%B3%87%E6%96%99');return}State.allData=await%20Promise.all(result.records.map(async(item,idx)=%3E{let%20polpln='';if(State.cacheDetail.has(item.planCode)){polpln=State.cacheDetail.get(item.planCode)}else{try{const%20detail=await%20Api.call('/planCodeController/queryDetail',{planCode:item.planCode,pageNo:1,pageSize:20},signal);polpln=(detail.records||[]).map(r=%3Er.polpln).join(',%20');State.cacheDetail.set(item.planCode,polpln)}catch{polpln=''}}let%20channels=[];if(State.cacheChannel.has(item.planCode)){channels=State.cacheChannel.get(item.planCode)}else{try{const%20sale=await%20Api.call('/planCodeSaleDateController/query',{planCode:item.planCode,pageNo:1,pageSize:50},signal);channels=(sale.planCodeSaleDates?.records||[]).map(r=%3E({channel:channelCodeConvert(r.channel),saleEndDate:formatDate(r.saleEndDate),status:getSaleStatus(formatToday(),r.saleStartDate,r.saleEndDate),rawEnd:r.saleEndDate}));State.cacheChannel.set(item.planCode,channels)}catch{channels=[]}}const%20mainStatus=getSaleStatus(formatToday(),item.saleStartDate,item.saleEndDate);const%20special=(mainStatus==='%E5%81%9C%E5%94%AE'&&channels.some(c=%3Ec.status==='%E7%8F%BE%E5%94%AE%E4%B8%AD'))||channels.some(c=%3ENumber(formatDate(item.saleEndDate))%3CNumber(formatDate(c.saleEndDate)));return{no:idx+1,planCode:item.planCode,shortName:item.shortName,currency:currencyConvert(item.currency),unit:unitConvert(item.reportInsuranceAmountUnit||item.insuranceAmountUnit),coverageType:coverageTypeConvert(item.coverageType),saleStartDate:formatDate(item.saleStartDate),saleEndDate:formatDate(item.saleEndDate),mainStatus,polpln,channels,special}}));State.totalRecords=result.totalRecords||State.allData.length;renderTable()}catch(e){showError('%E6%9F%A5%E8%A9%A2%20API%20%E5%A4%B1%E6%95%97%EF%BC%9A'+e.message)}}function%20renderTable(){showModal({title:%60%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%EF%BC%88${envLabel()}%EF%BC%89%60,body:renderSummary()+renderTableHTML(),footer:%60%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-detail%22%3E%E4%B8%80%E9%8D%B5%E6%9F%A5%E8%A9%A2%E5%85%A8%E9%83%A8%E8%A9%B3%E7%B4%B0%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-copy%22%3E%E4%B8%80%E9%8D%B5%E8%A4%87%E8%A3%BD%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-prev%22%3E%E4%B8%8A%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-next%22%3E%E4%B8%8B%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-filter%22%3E%E7%AF%A9%E9%81%B8%E7%89%B9%E6%AE%8A%E7%8B%80%E6%85%8B%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-table-showall%22%3E${State.isShowingAll%20?%20'%E5%88%86%E9%A0%81%E9%A1%AF%E7%A4%BA'%20:%20'%E5%85%A8%E9%83%A8%E9%A1%AF%E7%A4%BA'}%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-requery%22%3E%E9%87%8D%E6%96%B0%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-table-close%22%3E%E9%97%9C%E9%96%89%3C/button%3E%20%20%20%20%20%20%60,onOpen:()=%3E{document.getElementById('pct-table-detail').onclick=async()=%3E{showToast('%E6%89%B9%E6%AC%A1%E6%9F%A5%E8%A9%A2%E8%A9%B3%E7%B4%B0%E8%B3%87%E6%96%99%E4%B8%AD...');await%20doQuery()};document.getElementById('pct-table-copy').onclick=()=%3E{copyTableData()};document.getElementById('pct-table-prev').onclick=()=%3E{if(State.pageNo%3E1){State.pageNo--;doQuery()}};document.getElementById('pct-table-next').onclick=()=%3E{if(State.pageNo*State.pageSize%3CState.totalRecords){State.pageNo++;doQuery()}};document.getElementById('pct-table-filter').onclick=()=%3E{State.filterSpecial=!State.filterSpecial;renderTable()};document.getElementById('pct-table-showall').onclick=()=%3E{State.isShowingAll=!State.isShowingAll;renderTable()};document.getElementById('pct-table-requery').onclick=()=%3E{closeModal();main()};document.getElementById('pct-table-close').onclick=()=%3E{closeModal()};Array.from(document.querySelectorAll('.pct-table%20th')).forEach(th=%3E{th.onclick=()=%3E{const%20key=th.dataset.key;if(!key)return;if(State.sortKey===key)State.sortAsc=!State.sortAsc;else{State.sortKey=key;State.sortAsc=!0}State.allData.sort((a,b)=%3E{if(a[key]%3Eb[key])return%20State.sortAsc?1:-1;if(a[key]%3Cb[key])return%20State.sortAsc?-1:1;return%200});renderTable()}});Array.from(document.querySelectorAll('.pct-table%20td.copyable')).forEach(td=%3E{td.onclick=function(){copyTextToClipboard(td.textContent.trim())}})}})}function%20renderSummary(){const%20specialCount=State.allData.filter(r=%3Er.special).length;let%20html=%60%3Cdiv%20class=%22pct-summary%22%3E%E5%85%B1%20${State.allData.length}%20%E7%AD%86%60;if(specialCount%3E0){html+=%60%EF%BC%8C%E4%B8%BB%E7%B4%84%E5%81%9C%E5%94%AE%E4%BD%86%E9%80%9A%E8%B7%AF%E7%8F%BE%E5%94%AE/%E7%9F%9B%E7%9B%BE%EF%BC%9A%3Cb%3E${specialCount}%3C/b%3E%20%E7%AD%86%60;html+=%60%3Cbutton%20class=%22pct-filter-btn%22%20id=%22pct-table-filter%22%3E${State.filterSpecial%20?%20'%E9%A1%AF%E7%A4%BA%E5%85%A8%E9%83%A8'%20:%20'%E5%8F%AA%E9%A1%AF%E7%A4%BA%E7%89%B9%E6%AE%8A'}%3C/button%3E%60}html+=%60%3C/div%3E%60;return%20html}function%20renderTableHTML(){let%20data=State.filterSpecial?State.allData.filter(r=%3Er.special):State.allData;if(!State.isShowingAll){const%20start=(State.pageNo-1)*State.pageSize;data=data.slice(start,start+State.pageSize)}let%20html=%60%3Cdiv%20class=%22pct-table-wrap%22%3E%3Ctable%20class=%22pct-table%22%3E%3Cthead%3E%3Ctr%3E%20%20%20%20%20%20%3Cth%20data-key=%22no%22%3ENo%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22planCode%22%3E%E4%BB%A3%E8%99%9F%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22shortName%22%3E%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22currency%22%3E%E5%B9%A3%E5%88%A5%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22unit%22%3E%E5%96%AE%E4%BD%8D%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22coverageType%22%3E%E9%A1%9E%E5%9E%8B%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22saleStartDate%22%3E%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22saleEndDate%22%3E%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5%3C/th%3E%20%20%20%20%20%20%3Cth%3E%E4%B8%BB%E7%B4%84%E7%8B%80%E6%85%8B%3C/th%3E%20%20%20%20%20%20%3Cth%3EPOLPLN%3C/th%3E%20%20%20%20%20%20%3Cth%3E%E9%80%9A%E8%B7%AF%E8%B3%87%E8%A8%8A%3C/th%3E%20%20%20%20%3C/tr%3E%3C/thead%3E%3Ctbody%3E%60;data.forEach(row=%3E{html+=%60%3Ctr${row.special%20?%20'%20class=%22special-row%22'%20:%20''}%3E%20%20%20%20%20%20%20%20%3Ctd%3E${row.no}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.planCode}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%20title=%22${row.shortName}%22%3E${row.shortName}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.currency}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.unit}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.coverageType}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.saleStartDate}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.saleEndDate}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22${row.mainStatus%20===%20'%E7%8F%BE%E5%94%AE%E4%B8%AD'%20?%20'pct-status-onsale'%20:%20row.mainStatus%20===%20'%E5%81%9C%E5%94%AE'%20?%20'pct-status-offsale'%20:%20''}%22%3E${row.mainStatus}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.polpln%20||%20''}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%3E${row.channels.map(c%20=%3E%20%20%20%20%20%20%20%20%20%20%60%3Cspan%20class=%22${c.status%20===%20'%E7%8F%BE%E5%94%AE%E4%B8%AD'%20?%20'pct-status-onsale'%20:%20'pct-status-offsale'}%22%3E${c.channel}:${c.saleEndDate}%EF%BC%88${c.status}%EF%BC%89%3C/span%3E%60%20%20%20%20%20%20%20%20).join('%3Cbr%3E')}%3C/td%3E%20%20%20%20%20%20%3C/tr%3E%60});html+=%60%3C/tbody%3E%3C/table%3E%3C/div%3E%60;return%20html}function%20copyTableData(){let%20data=State.filterSpecial?State.allData.filter(r=%3Er.special):State.allData;if(!State.isShowingAll){const%20start=(State.pageNo-1)*State.pageSize;data=data.slice(start,start+State.pageSize)}let%20txt='No\t%E4%BB%A3%E8%99%9F\t%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1\t%E5%B9%A3%E5%88%A5\t%E5%96%AE%E4%BD%8D\t%E9%A1%9E%E5%9E%8B\t%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5\t%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5\t%E4%B8%BB%E7%B4%84%E7%8B%80%E6%85%8B\tPOLPLN\t%E9%80%9A%E8%B7%AF%E8%B3%87%E8%A8%8A\n';data.forEach(row=%3E{let%20channelStr=row.channels.map(c=%3E%60${c.channel}:${c.saleEndDate}%EF%BC%88${c.status}%EF%BC%89%60).join('%20/%20');txt+=%60${row.no}\t${row.planCode}\t${row.shortName}\t${row.currency}\t${row.unit}\t${row.coverageType}\t${row.saleStartDate}\t${row.saleEndDate}\t${row.mainStatus}\t${row.polpln}\t${channelStr}\n%60});copyTextToClipboard(txt)}function%20copyTextToClipboard(text){const%20ta=document.createElement('textarea');ta.value=text;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);showToast('%E5%B7%B2%E8%A4%87%E8%A3%BD:%20'+(text.length%3E40?text.slice(0,40)+'...':text))}main()})()
＊＊＊＊＊第46段程式碼結束/90PLANNEW /＊＊＊＊＊




＊＊＊＊＊第47段程式碼開始/98h h h h h /＊＊＊＊＊
javascript:(async function(){%C2%A0 %C2%A0 'use strict';%C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 const state={%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentPage:1,totalPages:1,allDataArray:[],recordsPerPage:100,currentToken:null,%C2%A0 %C2%A0 %C2%A0 %C2%A0 displayedDataArray:[],isShowingAllData:!1,queriedDataCache:new Map(),%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentSortColumn:null,currentSortDirection:'asc',apiAbortController:null,%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentFilters:{},errorMessage:null %C2%A0 %C2%A0};%C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 const API_URLS={%C2%A0 %C2%A0 %C2%A0 %C2%A0 PLANCODE_QUERY:
＊＊＊＊＊第47段程式碼結束/98h h h h h /＊＊＊＊＊




＊＊＊＊＊第48段程式碼開始/162A /＊＊＊＊＊
javascript:(function(){const state={allDataArray:[],displayedDataArray:[],currentPage:1,sortColumn:null,sortDirection:'asc',currentToken:null,currentFilters:{isStillSelling:''},showAllMode:!1,isBatchQueryCancelled:!1};const UI={createDialog(title,message,inputs,buttons){const dialog=document.createElement('div');dialog.id='pcrDialog';dialog.style.position='fixed';dialog.style.top='50%';dialog.style.left='50%';dialog.style.transform='translate(-50%, -50%)';dialog.style.background='#fff';dialog.style.border='1px%20solid%20#ddd';dialog.style.borderRadius='5px';dialog.style.padding='20px';dialog.style.zIndex='1001';dialog.style.boxShadow='0%202px%2010px%20rgba(0,0,0,0.1)';dialog.style.maxWidth='400px';let%20inputsHtml=inputs.map(input=%3E%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22margin-bottom:%2010px;%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20style=%22display:%20inline-block;%20width:%20100px;%20text-align:%20right;%20margin-right:%2010px;%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${input.label}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/label%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${input.type%20===%20'text'%20?%20%60%3Cinput%20type=%22text%22%20id=%22${input.id}%22%20style=%22width:%20200px;%20padding:%205px;%22%3E%60%20:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20input.type%20===%20'checkbox'%20?%20%60%3Cinput%20type=%22checkbox%22%20id=%22${input.id}%22%20${input.value?'checked':''}%3E%60%20:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20''}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60).join('');let%20buttonsHtml=buttons.map(button=%3E%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style=%22margin:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%22%20onclick=%22${button.onclick}%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${button.label}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%60).join('');dialog.innerHTML=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch3%20style=%22margin:%200%200%2010px;%22%3E${title}%3C/h3%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20style=%22margin:%200%200%2010px;%22%3E${message}%3C/p%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${inputsHtml}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22text-align:%20right;%22%3E${buttonsHtml}%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60;document.body.appendChild(dialog);const%20firstInput=dialog.querySelector('input[type=%22text%22]');if(firstInput){firstInput.focus();firstInput.addEventListener('keypress',e=%3E{if(e.key==='Enter'){dialog.querySelector('button').click()}})}},showNotification(message,isError=!1){const%20notification=document.createElement('div');notification.style.position='fixed';notification.style.top='20px';notification.style.right='20px';notification.style.background=isError?'#f8d7da':'#e7f3ff';notification.style.border=isError?'1px%20solid%20#f5c6cb':'1px%20solid%20#b3d4fc';notification.style.padding='10px';notification.style.borderRadius='5px';notification.style.zIndex='1002';notification.textContent=message;document.body.appendChild(notification);setTimeout(()=%3Enotification.remove(),2000)},showProgressNotification(totalItems){const%20progressContainer=document.createElement('div');progressContainer.id='pcrProgressContainer';progressContainer.style.position='fixed';progressContainer.style.top='20px';progressContainer.style.right='20px';progressContainer.style.background='#e7f3ff';progressContainer.style.border='1px%20solid%20#b3d4fc';progressContainer.style.padding='10px';progressContainer.style.borderRadius='5px';progressContainer.style.zIndex='1002';progressContainer.style.boxShadow='0%202px%205px%20rgba(0,0,0,0.1)';progressContainer.innerHTML=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%3E%E6%AD%A3%E5%9C%A8%E6%9F%A5%E8%A9%A2%E9%80%9A%E8%B7%AF%E8%B3%87%E6%96%99...%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22pcrProgressText%22%3E%E7%AC%AC%200%20%E6%89%B9%20/%20%E5%85%B1%20${Math.ceil(totalItems%20/%2050)}%20%E6%89%B9%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22pcrCancelBatch%22%20style=%22margin-top:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%22%3E%E5%8F%96%E6%B6%88%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%60;document.body.appendChild(progressContainer);document.getElementById('pcrCancelBatch').onclick=()=%3E{state.isBatchQueryCancelled=!0;UI.showNotification('%E6%AD%A3%E5%9C%A8%E5%8F%96%E6%B6%88%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2...')}},updateProgressNotification(currentBatch,totalBatches){const%20progressText=document.getElementById('pcrProgressText');if(progressText){progressText.textContent=%60%E7%AC%AC%20${currentBatch}%20%E6%89%B9%20/%20%E5%85%B1%20${totalBatches}%20%E6%89%B9%60}},removeProgressNotification(){const%20progressContainer=document.getElementById('pcrProgressContainer');if(progressContainer){progressContainer.remove()}}};const%20ApiManager={async%20callApi(token,params,retryCount=0){const%20maxRetries=3;const%20retryDelay=2000;const%20endpoint=params.saleChannel?'/planCodeSaleDateController/query':params.polpln?'/planCodeController/queryDetail':'/planCodeController/query';const%20headers={'Authorization':%60Bearer%20${token}%60,'Content-Type':'application/json'};const%20requestOptions={method:'POST',headers,body:JSON.stringify(params)};try{const%20response=await%20fetch(endpoint,requestOptions);if(!response.ok){throw%20new%20Error(%60HTTP%20${response.status}%60)}const%20data=await%20response.json();return%20data}catch(err){if(retryCount%3CmaxRetries){console.warn(%60API%20%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97%EF%BC%8C%E7%AC%AC%20${retryCount%20+%201}%20%E6%AC%A1%E9%87%8D%E8%A9%A6:%20${err.message}%60);await%20new%20Promise(resolve=%3EsetTimeout(resolve,retryDelay));return%20this.callApi(token,params,retryCount+1)}else{console.error('API%20%E6%9F%A5%E8%A9%A2%E6%9C%80%E7%B5%82%E5%A4%B1%E6%95%97:',err);throw%20new%20Error(%60%E7%84%A1%E6%B3%95%E9%80%A3%E7%B7%9A%E5%88%B0%E4%BC%BA%E6%9C%8D%E5%99%A8:%20${err.message}%60)}}},async%20queryBatchInfo(token,codes){const%20params={codes,pageSize:codes.length};return%20this.callApi(token,params)}};const%20TokenManager={async%20getStoredToken(){const%20possibleKeys=['euisPlanCodeToken','euisToken'];for(const%20key%20of%20possibleKeys){const%20token=localStorage.getItem(key);if(token&&await%20this.isValidToken(token)){state.currentToken=token;return%20token}}return%20null},async%20promptForToken(attempts=0){if(attempts%3E=3){UI.showNotification('%E5%B7%B2%E9%81%94%E6%9C%80%E5%A4%A7%E5%98%97%E8%A9%A6%E6%AC%A1%E6%95%B8%EF%BC%8C%E8%AB%8B%E7%A8%8D%E5%BE%8C%E9%87%8D%E8%A9%A6',!0);return%20null}UI.createDialog('%E8%BC%B8%E5%85%A5%20TOKEN','%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E7%9A%84%20TOKEN',[{label:'TOKEN:',type:'text',id:'tokenInput'}],[{label:'%E7%A2%BA%E8%AA%8D',onclick:%60(()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20token%20=%20document.getElementById('tokenInput').value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!token.trim())%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UI.showNotification('%E8%AB%8B%E8%BC%B8%E5%85%A5%20TOKEN',%20true);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById('pcrDialog').remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.bookmarkletFuncs.validateAndStoreToken('${attempts%20+%201}',%20token);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20})()%60},{label:'%E5%8F%96%E6%B6%88',onclick:%60(()%20=%3E%20{%20document.getElementById('pcrDialog').remove();%20})()%60}])},async%20validateAndStoreToken(attempt,token){const%20cleanToken=Utils.toHalfWidth(token.trim());if(await%20this.isValidToken(cleanToken)){try{localStorage.setItem('euisPlanCodeToken',cleanToken);state.currentToken=cleanToken;UI.showNotification('TOKEN%20%E9%A9%97%E8%AD%89%E6%88%90%E5%8A%9F');ProductQueryManager.startQuery()}catch(err){console.warn('%E5%84%B2%E5%AD%98%20TOKEN%20%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E5%84%B2%E5%AD%98%20TOKEN%20%E5%A4%B1%E6%95%97%EF%BC%8C%E8%AB%8B%E9%87%8D%E8%A9%A6',!0)}}else{UI.showNotification('%E7%84%A1%E6%95%88%20TOKEN%EF%BC%8C%E8%AB%8B%E9%87%8D%E8%A9%A6',!0);this.promptForToken(parseInt(attempt))}},async%20isValidToken(token){try{const%20response=await%20ApiManager.callApi(token,{planCodeName:''});return!!response}catch(err){console.warn('TOKEN%20%E9%A9%97%E8%AD%89%E5%A4%B1%E6%95%97:',err);return!1}}};const%20ProductQueryManager={async%20startQuery(){UI.createDialog('%E6%9F%A5%E8%A9%A2%E5%95%86%E5%93%81','%E8%BC%B8%E5%85%A5%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F%EF%BC%88%E5%A4%9A%E7%AD%86%E8%AB%8B%E7%94%A8%E9%80%97%E8%99%9F%E6%88%96%E7%A9%BA%E7%99%BD%E5%88%86%E9%9A%94%EF%BC%89',[{label:'%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F:',type:'text',id:'planCodeInput'},{label:'%E5%83%85%E6%9F%A5%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81:',type:'checkbox',id:'inSaleOnly',value:!1}],[{label:'%E7%A2%BA%E8%AA%8D',onclick:%60(()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20input%20=%20document.getElementById('planCodeInput').value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20inSaleOnly%20=%20document.getElementById('inSaleOnly').checked;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!input.trim())%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UI.showNotification('%E8%AB%8B%E8%BC%B8%E5%85%A5%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F',%20true);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20codes%20=%20input.split(/[\s,]+/).map(code%20=%3E%20Utils.toHalfWidth(code.trim())).filter(Boolean);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(codes.length%20===%200%20&&%20!input.toUpperCase().startsWith('ALL'))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UI.showNotification('%E8%BC%B8%E5%85%A5%E6%A0%BC%E5%BC%8F%E7%84%A1%E6%95%88%EF%BC%8C%E8%AB%8B%E6%AA%A2%E6%9F%A5',%20true);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById('pcrDialog').remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.bookmarkletFuncs.handleQuery(input,%20inSaleOnly);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20})()%60},{label:'%E5%8F%96%E6%B6%88',onclick:%60(()%20=%3E%20{%20document.getElementById('pcrDialog').remove();%20})()%60},{label:'%E9%87%8D%E8%A8%AD%20TOKEN',onclick:%60(()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById('pcrDialog').remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20localStorage.removeItem('euisPlanCodeToken');%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20localStorage.removeItem('euisToken');%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20startMainFlow();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20})()%60}])},async%20handleQuery(input,inSaleOnly){const%20codes=input.toUpperCase().startsWith('ALL')?['ALL']:input.split(/[\s,]+/).map(code=%3EUtils.toHalfWidth(code.trim())).filter(Boolean);let%20allData=[];const%20pageSize=1000;try{for(const%20code%20of%20codes){let%20page=1;while(!0){const%20params={planCode:code,pageNo:page,pageSize};if(inSaleOnly){params.saleEndDate='9999-12-31%2000:00:00'}const%20response=await%20ApiManager.callApi(state.currentToken,params);if(!response||!response.records||response.records.length===0){break}allData=allData.concat(response.records.map(DataFormatter.formatItemData));if(response.records.length%3CpageSize){break}page++}}state.allDataArray=allData;FilterManager.applyFilters();TableRenderer.render();UI.showNotification(%60%E6%9F%A5%E8%A9%A2%E5%AE%8C%E6%88%90%EF%BC%8C%E5%85%B1%20${allData.length}%20%E7%AD%86%60)}catch(err){console.error('%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:',err);UI.showNotification(%60%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:%20${err.message}%60,!0)}},async%20queryInSale(){try{const%20params={saleEndDate:'9999-12-31%2000:00:00',pageNo:1,pageSize:1000};const%20response=await%20ApiManager.callApi(state.currentToken,params);if(response&&response.records){state.allDataArray=response.records.map(DataFormatter.formatItemData);FilterManager.applyFilters();TableRenderer.render();UI.showNotification(%60%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E5%AE%8C%E6%88%90%EF%BC%8C%E5%85%B1%20${state.allDataArray.length}%20%E7%AD%86%60)}else{UI.showNotification('%E7%84%A1%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81%E8%B3%87%E6%96%99',!0)}}catch(err){console.error('%E7%8F%BE%E5%94%AE%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:',err);UI.showNotification(%60%E7%8F%BE%E5%94%AE%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:%20${err.message}%60,!0)}},async%20batchQueryInfo(){const%20itemsToQuery=state.displayedDataArray.filter(item=%3E!item.isQueried);if(itemsToQuery.length%3E50){const%20userConfirm=confirm(%60%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E5%85%B1%20${itemsToQuery.length}%20%E7%AD%86%EF%BC%8C%E8%B6%85%E9%81%8E50%E7%AD%86%E5%B0%87%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2%E9%80%9A%E8%B7%AF%EF%BC%8C%E6%98%AF%E5%90%A6%E7%B9%BC%E7%BA%8C%EF%BC%9F%60);if(!userConfirm){UI.showNotification('%E6%93%8D%E4%BD%9C%E5%B7%B2%E5%8F%96%E6%B6%88');return}}state.isBatchQueryCancelled=!1;UI.showProgressNotification(itemsToQuery.length);const%20batchSize=50;const%20batches=[];for(let%20i=0;i%3CitemsToQuery.length;i+=batchSize){batches.push(itemsToQuery.slice(i,i+batchSize))}for(let%20batchIndex=0;batchIndex%3Cbatches.length;batchIndex++){if(state.isBatchQueryCancelled){UI.showNotification('%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2%E5%B7%B2%E5%8F%96%E6%B6%88');UI.removeProgressNotification();break}const%20batch=batches[batchIndex];const%20codes=batch.map(item=%3Eitem.code);try{const%20response=await%20ApiManager.queryBatchInfo(state.currentToken,codes);if(response&&response.records){response.records.forEach(record=%3E{const%20targetItem=state.displayedDataArray.find(item=%3Eitem.code===record.planCode);if(targetItem){targetItem.polpln=record.polpln||'-';targetItem.saleChannel=record.saleChannel||'-';targetItem.isQueried=!0}})}UI.updateProgressNotification(batchIndex+1,batches.length);TableRenderer.render()}catch(err){console.warn('%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:',err);UI.showNotification(%60%E7%AC%AC%20${batchIndex%20+%201}%20%E6%89%B9%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:%20${err.message}%60,!0)}}if(!state.isBatchQueryCancelled){UI.showNotification('%E9%80%9A%E8%B7%AF%E6%9F%A5%E8%A9%A2%E5%AE%8C%E6%88%90');UI.removeProgressNotification()}}};const%20DataFormatter={formatItemData(item){return{code:item.planCode||'-',commodityCode:item.commodityCode||'-',name:item.planCodeName||'-',cur:item.currency||'-',unit:item.unit||'-',type:item.type||'-',start:Utils.formatDateToYYYYMMDDString(item.saleStartDate)||'-',end:Utils.formatDateToYYYYMMDDString(item.saleEndDate)||'-',isStillSelling:Utils.isStillSelling(item.saleEndDate),polpln:'-',saleChannel:'-',isQueried:!1}}};const%20Utils={toHalfWidth(str){return%20str.replace(/[%EF%BC%A1-%EF%BC%BA%EF%BD%81-%EF%BD%9A%EF%BC%90-%EF%BC%99]/g,c=%3EString.fromCharCode(c.charCodeAt(0)-0xFEE0))},formatDateToYYYYMMDDString(dateStr){if(!dateStr)return'';const%20date=new%20Date(dateStr);if(isNaN(date))return%20dateStr;return%20%60${date.getFullYear()}${('0'%20+%20(date.getMonth()%20+%201)).slice(-2)}${('0'%20+%20date.getDate()).slice(-2)}%60},getTodayYYYYMMDDString(){const%20today=new%20Date();return%20%60${today.getFullYear()}${('0'%20+%20(today.getMonth()%20+%201)).slice(-2)}${('0'%20+%20today.getDate()).slice(-2)}%60},isStillSelling(saleEndDate){const%20today=this.getTodayYYYYMMDDString();const%20endDate=this.formatDateToYYYYMMDDString(saleEndDate);return%20endDate==='99991231'||endDate%3E=today}};const%20FilterManager={applyFilters(){let%20filteredData=[...state.allDataArray];if(state.currentFilters.isStillSelling){filteredData=filteredData.filter(item=%3Eitem.isStillSelling===(state.currentFilters.isStillSelling==='Y'))}state.displayedDataArray=filteredData;state.currentPage=1;UI.showNotification(%60%E7%AF%A9%E9%81%B8%E5%BE%8C%E9%A1%AF%E7%A4%BA%20${filteredData.length}%20%E7%AD%86%E5%95%86%E5%93%81%60)}};const%20SortManager={toggleSort(column){if(state.sortColumn===column){state.sortDirection=state.sortDirection==='asc'?'desc':'asc'}else{state.sortColumn=column;state.sortDirection='asc'}this.applySort()},applySort(){state.displayedDataArray.sort((a,b)=%3E{let%20valA=a[state.sortColumn]||'';let%20valB=b[state.sortColumn]||'';if(state.sortColumn==='end'){valA=a.isStillSelling?'99991231':a[state.sortColumn]||'';valB=b.isStillSelling?'99991231':b[state.sortColumn]||''}if(typeof%20valA==='string')valA=valA.toLowerCase();if(typeof%20valB==='string')valB=valB.toLowerCase();return%20state.sortDirection==='asc'?(valA%3EvalB?1:-1):(valA%3CvalB?1:-1)});TableRenderer.render()}};const%20TableRenderer={render(){let%20container=document.getElementById('pcrContainer');if(!container){container=document.createElement('div');container.id='pcrContainer';container.style.position='fixed';container.style.top='10px';container.style.left='10px';container.style.right='10px';container.style.bottom='10px';container.style.background='#fff';container.style.border='1px%20solid%20#ddd';container.style.padding='10px';container.style.zIndex='1000';container.style.overflow='auto';document.body.appendChild(container)}const%20itemsPerPage=50;const%20startIndex=(state.currentPage-1)*itemsPerPage;const%20endIndex=Math.min(startIndex+itemsPerPage,state.displayedDataArray.length);const%20visibleData=state.displayedDataArray.slice(startIndex,endIndex);container.innerHTML=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cstyle%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20{%20width:%20100%;%20border-collapse:%20collapse;%20font-size:%2012px;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20th,%20#pcrTable%20td%20{%20border:%201px%20solid%20#ddd;%20padding:%208px;%20text-align:%20left;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20th%20{%20background:%20#f4f4f4;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20tr:nth-child(even)%20{%20background:%20#f9f9f9;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20tr:hover%20{%20background:%20#f0f0f0;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.pcr-btn%20{%20margin:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter-btn-group%20{%20margin:%2010px%200;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter-btn%20{%20margin-right:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter-btn.active%20{%20background:%20#007bff;%20color:%20white;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.polpln-text%20{%20color:%20green;%20font-size:%2010px;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.pagination%20{%20margin-top:%2010px;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.pagination%20button%20{%20margin:%200%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/style%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${this.generateFilterControls()}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22ProductQueryManager.startQuery()%22%3E%E9%87%8D%E6%96%B0%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22ProductQueryManager.batchQueryInfo()%22%3E%E6%9F%A5%E8%A9%A2%E9%80%9A%E8%B7%AF%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22ProductQueryManager.queryInSale()%22%3E%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22TableRenderer.toggleShowAllMode()%22%3E${state.showAllMode%20?%20'%E7%B8%AE%E6%B8%9B%E9%A1%AF%E7%A4%BA'%20:%20'%E6%9F%A5%E7%9C%8B%E5%85%A8%E9%83%A8'}%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22TableRenderer.copyAll()%22%3E%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22max-height:%20600px;%20overflow-y:%20auto;%22%20id=%22pcrTableContainer%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctable%20id=%22pcrTable%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${this.generateTableHeader()}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctbody%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${visibleData.map(item%20=%3E%20this.generateTableRow(item)).join('')}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/tbody%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/table%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${this.generatePaginationControls()}%20%20%20%20%20%20%20%20%20%20%20%20%60;this.bindCopyEvents()},generateFilterControls(){return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22filter-btn-group%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22filter-btn%20${!state.currentFilters.isStillSelling%20?%20'active'%20:%20''}%22%20onclick=%22window.bookmarkletFuncs.applyFilter('isStillSelling',%20'')%22%3E%E5%85%A8%E9%83%A8%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22filter-btn%20${state.currentFilters.isStillSelling%20===%20'Y'%20?%20'active'%20:%20''}%22%20onclick=%22window.bookmarkletFuncs.applyFilter('isStillSelling',%20'Y')%22%3E%E7%8F%BE%E5%94%AE%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22filter-btn%20${state.currentFilters.isStillSelling%20===%20'N'%20?%20'active'%20:%20''}%22%20onclick=%22window.bookmarkletFuncs.applyFilter('isStillSelling',%20'N')%22%3E%E5%81%9C%E5%94%AE%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},generateTableHeader(){const%20columns=[{key:'code',label:'%E4%BB%A3%E8%99%9F'},{key:'commodityCode',label:'%E5%95%86%E5%93%81%E7%A2%BC'},{key:'name',label:'%E5%90%8D%E7%A8%B1'},{key:'cur',label:'%E5%B9%A3%E5%88%A5'},{key:'unit',label:'%E5%96%AE%E4%BD%8D'},{key:'type',label:'%E9%A1%9E%E5%9E%8B'},{key:'start',label:'%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5'},{key:'end',label:'%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5'}];return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cthead%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctr%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${columns.map(col%20=%3E%20%60%3Cth%20onclick=%22window.bookmarkletFuncs.toggleSort('${col.key}')%22%3E${col.label}${state.sortColumn===col.key?(state.sortDirection==='asc'?'%E2%86%91':'%E2%86%93'):''}%3C/th%3E%60).join('')}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/tr%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/thead%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},generateTableRow(item){return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctr%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyRow('${item.code}')%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${item.code}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${item.polpln%20!==%20'-'%20?%20%60%3Cdiv%20class=%22polpln-text%22%3E${item.polpln}%3C/div%3E%60%20:%20''}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.commodityCode}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.name}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.cur}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.unit}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.type}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.start}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.end}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/tr%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},generatePaginationControls(){const%20totalPages=Math.ceil(state.displayedDataArray.length/50);return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22pagination%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20onclick=%22TableRenderer.changePage(${state.currentPage%20-%201})%22%20${state.currentPage%20===%201%20?%20'disabled'%20:%20''}%3E%E4%B8%8A%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%3E%E7%AC%AC%20${state.currentPage}%20%E9%A0%81%20/%20%E5%85%B1%20${totalPages}%20%E9%A0%81%3C/span%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20onclick=%22TableRenderer.changePage(${state.currentPage%20+%201})%22%20${state.currentPage%20===%20totalPages%20?%20'disabled'%20:%20''}%3E%E4%B8%8B%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},changePage(page){const%20totalPages=Math.ceil(state.displayedDataArray.length/50);if(page%3E=1&&page%3C=totalPages){state.currentPage=page;this.render()}},bindCopyEvents(){const%20cells=document.querySelectorAll('#pcrTable%20td');cells.forEach(cell=%3E{cell.addEventListener('click',()=%3E{if(cell.onclick)return;this.copyCell(cell)})})},copyCell(cell){const%20text=cell.textContent.trim();navigator.clipboard.writeText(text).then(()=%3E{UI.showNotification(%60%E5%B7%B2%E8%A4%87%E8%A3%BD:%20${text}%60)}).catch(err=%3E{console.warn('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97',!0)})},copyRow(code){const%20item=state.displayedDataArray.find(item=%3Eitem.code===code);if(!item)return;const%20text=Object.values(item).slice(0,8).join('\t');navigator.clipboard.writeText(text).then(()=%3E{UI.showNotification(%60%E5%B7%B2%E8%A4%87%E8%A3%BD%E6%95%B4%E5%88%97:%20${item.code}%60)}).catch(err=%3E{console.warn('%E8%A4%87%E8%A3%BD%E6%95%B4%E5%88%97%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E8%A4%87%E8%A3%BD%E6%95%B4%E5%88%97%E5%A4%B1%E6%95%97',!0)})},copyAll(){const%20headers=['%E4%BB%A3%E8%99%9F','%E5%95%86%E5%93%81%E7%A2%BC','%E5%90%8D%E7%A8%B1','%E5%B9%A3%E5%88%A5','%E5%96%AE%E4%BD%8D','%E9%A1%9E%E5%9E%8B','%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5','%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5'];const%20rows=state.displayedDataArray.map(item=%3EObject.values(item).slice(0,8).join('\t'));const%20text=[headers.join('\t'),...rows].join('\n');navigator.clipboard.writeText(text).then(()=%3E{UI.showNotification('%E5%B7%B2%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%E8%B3%87%E6%96%99')}).catch(err=%3E{console.warn('%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%E5%A4%B1%E6%95%97',!0)})},toggleShowAllMode(){state.showAllMode=!state.showAllMode;this.render()}};window.bookmarkletFuncs={handleQuery:ProductQueryManager.handleQuery,applyFilter:(key,value)=%3E{state.currentFilters[key]=value;FilterManager.applyFilters();TableRenderer.render()},toggleSort:SortManager.toggleSort,validateAndStoreToken:TokenManager.validateAndStoreToken};async%20function%20startMainFlow(){const%20token=await%20TokenManager.getStoredToken();if(token){ProductQueryManager.startQuery()}else{TokenManager.promptForToken()}}startMainFlow()})()
＊＊＊＊＊第48段程式碼結束/162A /＊＊＊＊＊




＊＊＊＊＊第49段程式碼開始/166LJ /＊＊＊＊＊
javascript:(async function(){let currentPage=1;let totalPages=1;let allDataArray=[];const recordsPerPage=100;let currentToken;let displayedDataArray=[];let isShowingAllData=!1;const API_URL_PLANCODE_QUERY=
＊＊＊＊＊第49段程式碼結束/166LJ /＊＊＊＊＊




＊＊＊＊＊第50段程式碼開始/169W /＊＊＊＊＊
javascript:(()=>{'use strict';const APP_ID='query-app-container';const STYLE_ID='query-app-styles';const VERSION='2025-06-14';if(window.__KGI_QUERY_APP__){const $app=document.getElementById(APP_ID);$app.style.display=$app.style.display==='none'?%27flex%27:%27none%27;return}window.__KGI_QUERY_APP__=VERSION;const%20STYLE_TEXT=`:root{%20--font-family:%27Microsoft%20JhengHei%27,-apple-system,BlinkMacSystemFont,%22Segoe%20UI%22,Roboto,%22Helvetica%20Neue%22,Arial,%22Noto%20Sans%22,sans-serif;%20--primary:#007bff;--success:#28a745;--warning:#ffc107;--danger:#dc3545;--secondary:#6c757d;%20--light:#f8f9fa;--dark:#343a40;--border:#dee2e6;--shadow:0%206px%2024px%20rgba(0,0,0,.15);%20--radius:8px;--z-app:2147483630;--z-overlay:2147483640;--z-toast:2147483647;--speed:.25s;}#${APP_ID}{display:none;position:fixed;z-index:var(--z-app);left:50%;top:40px;transform:translateX(-50%);%20width:95%;max-width:1100px;max-height:90vh;background:#fff;border:1px%20solid%20var(--border);%20border-radius:var(--radius);box-shadow:var(--shadow);font-family:var(--font-family);%20display:flex;flex-direction:column;font-size:12px;}#${APP_ID}.show{display:flex;}.app-header{background:var(--dark);color:#fff;padding:12px%2020px;border-radius:var(--radius)%20var(--radius)%200%200;%20display:flex;align-items:center;gap:12px;cursor:grab;}.app-header%20h3{flex:1;margin:0;font-size:16px;font-weight:600;text-align:center;}.app-header%20.close-btn{background:none;border:none;color:#fff;font-size:24px;cursor:pointer;opacity:.85;}.app-controls{display:flex;flex-wrap:wrap;align-items:center;gap:14px;padding:12px%2020px;background:var(--light);%20border-bottom:1px%20solid%20var(--border);}.query-area{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-right:auto;}.query-area%20label{font-size:12px;display:flex;gap:4px;align-items:center;}.query-area%20input,.query-area%20select{padding:4px%208px;border:1px%20solid%20#ccc;border-radius:4px;font-size:12px;}.app-info{font-size:14px;font-weight:500;}.app-info%20strong{color:var(--primary);}.btn{border:none;padding:6px%2012px;border-radius:5px;font-size:12px;font-weight:600;cursor:pointer;%20transition:opacity%20var(--speed),transform%20.12s;}.btn:disabled{opacity:.5;cursor:not-allowed;}.btn-primary{background:var(--primary);color:#fff;}.btn-success{background:var(--success);color:#fff;}.btn-secondary{background:var(--secondary);color:#fff;}.btn-danger{background:var(--danger);color:#fff;}.table-wrap{flex:1;overflow:auto;border:1px%20solid%20var(--border);border-radius:6px;margin:0%2020px%2020px;}table{width:100%;border-collapse:collapse;font-size:12px;}th{background:var(--dark);color:#fff;padding:10px%2012px;text-align:center;position:sticky;top:0;%20user-select:none;cursor:pointer;border-bottom:2px%20solid%20#454d55;}td{padding:8px%2012px;border:1px%20solid%20var(--border);text-align:center;white-space:nowrap;}tbody%20tr:nth-child(even){background:#f8f9fa;}.row-error{background:#ffebee%20!important;color:#c62828;}.bg-y{background:yellow%20!important;}.pagination{display:flex;align-items:center;gap:6px;}.toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);padding:8px%2016px;border-radius:5px;%20color:#fff;font-size:13px;z-index:var(--z-toast);box-shadow:0%202px%208px%20rgba(0,0,0,.15);opacity:0;%20transition:opacity%20.5s,top%20.3s;}.toast.show{opacity:1;top:40px;}.toast.success{background:rgba(0,123,255,.9);}.toast.error{background:rgba(220,53,69,.9);}%60;const%20TEMPLATE=%60%3Cdiv%20class=%22app-header%22%3E%20%20%3Ch3%3E%E5%87%B1%E5%9F%BA%E4%BA%BA%E5%A3%BD%20%E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E5%B7%A5%E5%85%B7%3C/h3%3E%20%20%3Cbutton%20class=%22close-btn%22%20title=%22Close%22%3E×%3C/button%3E%3C/div%3E%3Cdiv%20class=%22app-controls%22%3E%20%20%3Cdiv%20class=%22query-area%22%3E%20%20%20%20%3Clabel%3E%E7%92%B0%E5%A2%83%20%20%20%20%20%20%3Cselect%20id=%22kgi-env%22%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22prod%22%3EPROD%3C/option%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22uat%22%3EUAT%3C/option%3E%20%20%20%20%20%20%3C/select%3E%20%20%20%20%3C/label%3E%20%20%20%20%3Clabel%3E%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5%20%20%20%20%20%20%3Cinput%20type=%22date%22%20id=%22kgi-end%22%20/%3E%20%20%20%20%3C/label%3E%20%20%20%20%3Clabel%3E%E5%95%86%E5%93%81%E9%A1%9E%E5%9E%8B%20%20%20%20%20%20%3Cselect%20id=%22kgi-type%22%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22%22%3E%E5%85%A8%E9%83%A8%3C/option%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22M%22%3E%E4%B8%BB%E7%B4%84%3C/option%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22R%22%3E%E9%99%84%E7%B4%84%3C/option%3E%20%20%20%20%20%20%3C/select%3E%20%20%20%20%3C/label%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-primary%22%20id=%22btn-query%22%3E%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-secondary%22%20id=%22btn-token%22%3E%E7%99%BB%E9%8C%84%E6%86%91%E8%AD%89%3C/button%3E%20%20%3C/div%3E%20%20%3Cdiv%20class=%22app-info%22%3E%E7%B8%BD%E5%85%B1%20%3Cstrong%3E0%3C/strong%3E%20%E7%AD%86%3C/div%3E%20%20%3Cdiv%20class=%22pagination%22%20id=%22pg%22%20hidden%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-secondary%22%20data-d=%22-1%22%3E%E2%9F%AA%3C/button%3E%20%20%20%20%3Cspan%20id=%22pg-text%22%3E%3C/span%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-secondary%22%20data-d=%221%22%3E%E2%9F%AB%3C/button%3E%20%20%3C/div%3E%20%20%3Cdiv%20style=%22display:flex;gap:8px;%22%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-success%22%20id=%22btn-copy%22%3E%E4%B8%80%E9%8D%B5%E8%A4%87%E8%A3%BD%3C/button%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-primary%22%20id=%22btn-detail%22%3E%E6%9C%AC%E9%A0%81%E8%A9%B3%E6%83%85%3C/button%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-danger%22%20id=%22btn-close%22%3E%E9%97%9C%E9%96%89%3C/button%3E%20%20%3C/div%3E%3C/div%3E%3Cdiv%20class=%22table-wrap%22%3E%20%20%3Ctable%3E%20%20%20%20%3Cthead%3E%3C/thead%3E%20%20%20%20%3Ctbody%3E%3C/tbody%3E%20%20%3C/table%3E%3C/div%3E%60;document.getElementById(APP_ID)?.remove();document.getElementById(STYLE_ID)?.remove();const%20styleEl=document.createElement('style');styleEl.id=STYLE_ID;styleEl.textContent=STYLE_TEXT;document.head.appendChild(styleEl);const%20$app=document.createElement('div');$app.id=APP_ID;$app.innerHTML=TEMPLATE;document.body.appendChild($app);$app.classList.add('show');const%20$=(sel,ctx=$app)=%3Ectx.querySelector(sel);const%20$$=(sel,ctx=$app)=%3EArray.from(ctx.querySelectorAll(sel));const%20today=()=%3Enew%20Date().toISOString().slice(0,10).replace(/-/g,'');const%20toast=(msg,type='success',ms=2500)=%3E{const%20n=document.createElement('div');n.className=%60toast%20${type}%60;n.textContent=msg;document.body.appendChild(n);void%20n.offsetWidth;n.classList.add('show');if(ms)setTimeout(()=%3E{n.classList.remove('show');n.addEventListener('transitionend',()=%3En.remove())},ms)};const%20escapeHtml=(s='')=%3E{const%20p=document.createElement('p');p.textContent=s;return%20p.innerHTML};const%20BATCH=50;const%20CFG={API:{prod:{query:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',detail:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',sale:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'},uat:{query:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',detail:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',sale:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'}},STORE:{TOKEN:'kgiToken',ENV:'kgiEnv'},MAX:{SIZE:5000},MAP:{CUR:{1:'TWD',2:'USD',3:'AUD',4:'CNT',5:'USD'},UNIT:{A1:'%E5%85%83',A3:'%E4%BB%9F%E5%85%83',A4:'%E8%90%AC%E5%85%83',B1:'%E8%A8%88%E7%95%AB',C1:'%E5%96%AE%E4%BD%8D'},TYPE:{M:'%E4%B8%BB%E7%B4%84',R:'%E9%99%84%E7%B4%84'}}};const%20state={env:localStorage.getItem(CFG.STORE.ENV)||'prod',token:localStorage.getItem(CFG.STORE.TOKEN)||'',rows:[],total:0,page:1,pages:1,sort:{key:'_idx',dir:1}};$('#kgi-env').value=state.env;const%20info=$('.app-info');const%20tbody=$('tbody');const%20thead=$('thead');const%20pgWrap=$('#pg');const%20pgText=$('#pg-text');const%20api=async(k,body)=%3E{const%20url=CFG.API[state.env][k];try{const%20res=await%20fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...(state.token&&{'SSO-TOKEN':state.token})},body:JSON.stringify(body)});if(!res.ok)throw%20new%20Error(res.status);return%20res.json()}catch(e){return{error:!0,message:e.message}}};const%20COLS=[{key:'_idx',title:'No',sort:1},{key:'code',title:'%E4%BB%A3%E8%99%9F',sort:1},{key:'name',title:'%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1',sort:1},{key:'cur',title:'%E5%B9%A3%E5%88%A5',sort:1},{key:'unit',title:'%E5%96%AE%E4%BD%8D',sort:1},{key:'type',title:'%E9%A1%9E%E5%9E%8B',sort:1},{key:'start',title:'%E9%8A%B7%E5%94%AE%E8%B5%B7',sort:1},{key:'disp',title:'%E9%8A%B7%E5%94%AE%E8%BF%84%20/%20%E9%80%9A%E8%B7%AF'}];const%20buildHead=()=%3E{thead.innerHTML='';const%20tr=document.createElement('tr');COLS.forEach(c=%3E{const%20th=document.createElement('th');th.textContent=c.title;if(c.sort){if(state.sort.key===c.key)th.textContent+=state.sort.dir===1?'%20%E2%96%B2':'%20%E2%96%BC';th.dataset.key=c.key;th.onclick=()=%3Esort(c.key)}tr.appendChild(th)});thead.appendChild(tr)};const%20render=()=%3E{info.innerHTML=%60%E7%B8%BD%E5%85%B1%20%3Cstrong%3E${state.total}%3C/strong%3E%20%E7%AD%86%60;state.pages=Math.max(1,Math.ceil(state.rows.length/BATCH));pgWrap.hidden=state.pages===1;if(!pgWrap.hidden){pgText.textContent=%60%E7%AC%AC%20${state.page}/${state.pages}%20%E9%A0%81%60;$$('[data-d]',pgWrap).forEach(b=%3E{b.disabled=(state.page===1&&b.dataset.d==='-1')||(state.page===state.pages&&b.dataset.d==='1')})}const%20start=(state.page-1)*BATCH;const%20view=state.rows.slice(start,start+BATCH);tbody.innerHTML=view.map(r=%3E{const%20cls=[r.error?'row-error':'',r.yellow?'bg-y':''].join('%20');return%20%60%3Ctr%20class=%22${cls}%22%20data-i=%22${r._idx}%22%3E%20%20%20%20%20%20%20%20%3Ctd%3E${r._idx%20+%201}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.codePlain}%22%20class=%22copy%22%3E${r.code}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.name}%22%20%20%20%20%20class=%22copy%22%20style=%22text-align:left;white-space:normal;%22%3E${r.name}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%3E${r.cur}%3C/td%3E%3Ctd%3E${r.unit}%3C/td%3E%3Ctd%3E${r.type}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.start}%22%20%20%20%20class=%22copy%22%3E${r.start}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.copyDisp}%22%20class=%22copy%22%20style=%22text-align:left;white-space:normal;%22%3E${r.disp}%3C/td%3E%20%20%20%20%20%20%3C/tr%3E%60}).join('')};const%20sort=key=%3E{state.sort.dir=state.sort.key===key?-state.sort.dir:1;state.sort.key=key;const%20dir=state.sort.dir;state.rows.sort((a,b)=%3E(''+(a[key]??'')).localeCompare(''+(b[key]??''),'zh-Hant-TW',{numeric:!0})*dir);state.page=1;buildHead();render()};const%20polText=recs=%3E{if(!recs?.length)return%20null;const%20vals=[...new%20Set(recs.map(r=%3E(r.polpln||'').replace(/^\d+|\d+$/g,'').replace(/%%$/,'').trim()).filter(Boolean))];return%20vals.length?vals.join('%E3%80%81'):null};const%20channelInfo=(data,baseHtml,selling,row)=%3E{if(data?.error)return{html:%60${baseHtml}%3Cbr%3E%3Cspan%20style=%22color:orange;%22%3E${data.message}%3C/span%3E%60,txt:baseHtml};const%20todayStr=today();const%20recs=data?.planCodeSaleDates?.records||[];const%20arr=recs.map(r=%3E{const%20end=(r.saleEndDate||'').replace(/-/g,'');const%20start=(r.saleStartDate||'').replace(/-/g,'');const%20on=!end||end==='99991231'||end%3E=todayStr;const%20ch=escapeHtml(r.channel||'%E6%9C%AA%E7%9F%A5');const%20title=%60${ch}%20%E5%8F%AF%E5%94%AE%20${start||'%E6%9C%AA%E7%9F%A5'}~${end==='99991231'?'%E6%8C%81%E7%BA%8C%E9%8A%B7%E5%94%AE':end||'%E6%9C%AA%E7%9F%A5'}%60;return{on,html:%60%3Cspan%20title=%22${title}%22%20style=%22color:${on?'blue':'red'};%22%3E${ch}${on?'':%60(${end})%60}%3C/span%3E%60,plain:%60${ch}${on?'':%60(${end})%60}%60}});if(!arr.length)return{html:%60${baseHtml}%3Cbr%3E%3Ci%20style=%22color:#777%22%3E(%E7%84%A1%E9%80%9A%E8%B7%AF%E8%B3%87%E6%96%99)%3C/i%3E%60,txt:%60${baseHtml}\n(%E7%84%A1%E9%80%9A%E8%B7%AF%E8%B3%87%E6%96%99)%60};const%20ons=arr.filter(a=%3Ea.on);const%20offs=arr.filter(a=%3E!a.on);let%20html=baseHtml+'%3Cdiv%20style=%22text-align:left;margin-top:4px%22%3E';if(ons.length)html+='%E5%8F%AF%E5%94%AE%EF%BC%9A'+ons.map(a=%3Ea.html).join('%E3%80%81')+'%3Cbr%3E';if(offs.length)html+='%E5%81%9C%E5%94%AE%EF%BC%9A'+offs.map(a=%3Ea.html).join('%E3%80%81');html+='%3C/div%3E';const%20txt=['%E5%8F%AF%E5%94%AE%EF%BC%9A'+ons.map(a=%3Ea.plain).join('%E3%80%81'),offs.length?'%E5%81%9C%E5%94%AE%EF%BC%9A'+offs.map(a=%3Ea.plain).join('%E3%80%81'):''].filter(Boolean).join('\n');if(!selling&&ons.length)row.yellow=!0;return{html,txt}};const%20fetchDetail=async%20row=%3E{if(row._loaded||row.error)return;row._loaded=!0;const%20tr=tbody.querySelector(%60tr[data-i=%22${row._idx}%22]%60);if(tr)tr.classList.add('loading');try{const[pd,sd]=await%20Promise.all([api('detail',{planCode:row.codePlain,pageNo:1,pageSize:20}),api('sale',{planCode:row.codePlain,pageNo:1,pageSize:50})]);const%20pol=polText(pd?.records);if(pol)row.code=%60${row.code}%3Cbr%3E%3Cspan%20style=%22color:green;font-weight:bold;%22%3E${escapeHtml(pol)}%3C/span%3E%60;const%20chan=channelInfo(sd,row.baseHtml,row.selling,row);row.disp=chan.html;row.copyDisp=chan.txt}catch{}render()};const%20transform=(rec,i)=%3E{const%20st=(rec.saleStartDate||'').replace(/-/g,'')||'-';const%20ed=(rec.saleEndDate||'').replace(/-/g,'')||'-';const%20selling=ed==='99991231'||ed%3E=today();const%20baseHtml=selling?'%3Cspan%20style=%22color:blue;font-weight:bold;%22%3E%E7%8F%BE%E5%94%AE%E4%B8%AD%3C/span%3E':ed!=='-'?%60%3Cspan%20style=%22color:red;%22%3E${ed}%3C/span%3E%60:'-';return{_idx:i,codePlain:rec.planCode,code:escapeHtml(rec.planCode),name:escapeHtml((rec.shortName||'').trim()||'N/A'),cur:CFG.MAP.CUR[rec.currency]||'-',unit:CFG.MAP.UNIT[(rec.reportInsuranceAmountUnit||'').toUpperCase()]||'-',type:CFG.MAP.TYPE[rec.coverageType]||'-',start:st,disp:baseHtml,baseHtml,copyDisp:baseHtml.replace(/%3C[^%3E]*%3E/g,''),selling}};const%20query=async()=%3E{state.rows=[];toast('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E2%80%A6','success',0);const%20end=$('#kgi-end').value||'9999-12-31';const%20type=$('#kgi-type').value;const%20res=await%20api('query',{pageSize:CFG.MAX.SIZE,saleEndDate:end,...(type&&{coverageType:type})});if(res.error){toast(res.message,'error');return}state.rows=(res.records||[]).map(transform);state.total=state.rows.length;state.page=1;buildHead();render();toast(%60%E5%8F%96%E5%BE%97%20${state.total}%20%E7%AD%86%E8%B3%87%E6%96%99%60)};$('#btn-query').onclick=query;$('#kgi-env').onchange=e=%3E{state.env=e.target.value;localStorage.setItem(CFG.STORE.ENV,state.env)};$('#btn-token').onclick=async()=%3E{const%20t=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%20SSO%20TOKEN',state.token);if(t!==null){state.token=t.trim();localStorage.setItem(CFG.STORE.TOKEN,state.token);toast('%E6%86%91%E8%AD%89%E5%B7%B2%E6%9B%B4%E6%96%B0')}};$('#btn-close').onclick=()=%3E{$app.style.display='none'};$('.close-btn').onclick=()=%3E{$app.style.display='none'};$('#btn-copy').onclick=async()=%3E{let%20txt=COLS.map(c=%3Ec.title).join('\t')+'\n';state.rows.forEach(r=%3E{txt+=[r._idx+1,r.codePlain,r.name,r.cur,r.unit,r.type,r.start,r.copyDisp.replace(/%3C[^%3E]*%3E/g,'')].join('\t')+'\n'});try{await%20navigator.clipboard.writeText(txt);toast('%E8%A1%A8%E6%A0%BC%E5%B7%B2%E8%A4%87%E8%A3%BD%EF%BC%81')}catch{toast('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97','error')}};$('#btn-detail').onclick=async()=%3E{const%20start=(state.page-1)*BATCH;const%20list=state.rows.slice(start,start+BATCH).filter(r=%3E!r._loaded&&!r.error);if(!list.length){toast('%E5%B7%B2%E8%BC%89%E5%85%A5');return}toast(%60%E6%9F%A5%E8%A9%A2%20${list.length}%20%E7%AD%86%E8%A9%B3%E6%83%85%E2%80%A6%60,'success',0);for(const%20r%20of%20list)await%20fetchDetail(r);toast('%E5%AE%8C%E6%88%90')};tbody.onclick=e=%3E{const%20td=e.target.closest('.copy');if(td){navigator.clipboard.writeText(td.dataset.copy).then(()=%3Etoast('%E5%B7%B2%E8%A4%87%E8%A3%BD')).catch(()=%3Etoast('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97','error'));return}const%20tr=e.target.closest('tr');if(tr)fetchDetail(state.rows[+tr.dataset.i]);};pgWrap.onclick=e=%3E{const%20d=+e.target.dataset.d;if(d){state.page+=d;render()}};(()=%3E{const%20hd=$('.app-header');let%20sx=0,sy=0,l=0,t=0,drag=!1;hd.onmousedown=e=%3E{if(e.target.closest('button'))return;drag=!0;sx=e.clientX;sy=e.clientY;const%20r=$app.getBoundingClientRect();l=r.left;t=r.top;hd.style.cursor='grabbing';document.onmousemove=m=%3E{if(!drag)return;$app.style.left=l+m.clientX-sx+'px';$app.style.top=t+m.clientY-sy+'px';$app.style.transform='none'};document.onmouseup=()=%3E{drag=!1;hd.style.cursor='grab';document.onmousemove=null}}})();document.onkeydown=e=%3E{if(e.key==='Escape')$app.style.display='none'};query()})()
＊＊＊＊＊第50段程式碼結束/169W /＊＊＊＊＊




＊＊＊＊＊第51段程式碼開始/200Failed /＊＊＊＊＊
javascript:(function(){async function() {    // %E5%AE%9A%E7%BE%A9API URL%E5%B8%B8%E6%95%B8    const API_URL = {        PLANCODE_QUERY:
＊＊＊＊＊第51段程式碼結束/200Failed /＊＊＊＊＊




＊＊＊＊＊第52段程式碼開始/205商品n /＊＊＊＊＊
javascript:(async()=>{var t=localStorage.getItem('euisPlanCodeToken')||prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5 SSO-TOKEN');if(!t)return;localStorage.setItem('euisPlanCodeToken',t);var e=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5 PlanCode%EF%BC%88%E5%A4%9A%E5%80%8B%E7%94%A8%E7%A9%BA%E6%A0%BC/%E9%80%97%E8%99%9F%E5%88%86%E9%9A%94%EF%BC%89');if(!e)return;var n=e.split(/[\s,;]+/).map(e=>e.trim().toUpperCase()).filter(e=>e);var o=[];var seenKeys=new Set();for(var p of n){try{var res=await fetch('https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':t},body:JSON.stringify({planCode:p})});var data=await res.json();if(data.records&&data.records.length>0){data.records.forEach(rec=>{var parts=rec.polpln.match(/(\d+)|([A-Za-z]+)/g)||[];var key=`${rec.planCode}-${parts[0]||''}-${parts[1]||''}`;if(!seenKeys.has(key)){seenKeys.add(key);o.push({PlanCode:rec.planCode,%E5%B9%B4%E6%9C%9F:parts[0]||'',%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1:parts[1]||''})}})}}catch(err){console.error(`%E6%9F%A5%E8%A9%A2PlanCode ${p} %E6%99%82%E7%99%BC%E7%94%9F%E9%8C%AF%E8%AA%A4:`, err);}}var makeCSV=()=>[['PlanCode','%E5%B9%B4%E6%9C%9F','%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1'],...o.map(r=>[r.PlanCode,r.%E5%B9%B4%E6%9C%9F,r.%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1])].map(r=>r.join(',')).join('\n');var c=document.createElement('div');c.id='planCodeResult';var isDragging=false,offsetX,offsetY;c.style='position:fixed;top:50px;left:50%;transform:translateX(-50%);z-index:99999;background:#fff;padding:20px;border-radius:8px;box-shadow:0%205px%2015px%20rgba(0,0,0,0.3);max-width:80vw;max-height:80vh;overflow:auto;font-family:Arial;resize:both;min-width:400px;min-height:200px;border:1px%20solid%20#ccc;';c.addEventListener('mousedown',ev=%3E{if(ev.target.tagName!=='TD'&&ev.target.tagName!=='TH'){isDragging=true;offsetX=ev.clientX-c.getBoundingClientRect().left;offsetY=ev.clientY-c.getBoundingClientRect().top;c.style.cursor='grabbing'}});document.addEventListener('mousemove',ev=%3E{if(isDragging){c.style.left=%60${ev.clientX-offsetX}px%60;c.style.top=%60${ev.clientY-offsetY}px%60;c.style.transform='none'}});document.addEventListener('mouseup',()=%3E{isDragging=false;c.style.cursor='grab'});document.addEventListener('keydown',ev=%3E{if(ev.key==='Escape')c.remove()});c.innerHTML=%60%3Cdiv%20style=%22margin-bottom:15px;display:flex;justify-content:space-between;align-items:center;cursor:move%22%3E%3Ch3%20style=%22margin:0%22%3E%E4%BF%9D%E5%96%AE%E8%A8%88%E5%8A%83%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%3C/h3%3E%3Cdiv%3E%3Cbutton%20id=%22downloadBtn%22%20style=%22background:#2ecc71;color:white;border:none;padding:8px%2015px;border-radius:4px;cursor:pointer;margin-right:10px%22%3E%E4%B8%8B%E8%BC%89%20CSV%3C/button%3E%3Cbutton%20onclick=%22this.parentNode.parentNode.parentNode.remove()%22%20style=%22background:#e74c3c;color:white;border:none;padding:8px%2015px;border-radius:4px;cursor:pointer%22%3E%E9%97%9C%E9%96%89%3C/button%3E%3C/div%3E%3C/div%3E%3Ctable%20style=%22border-collapse:collapse;width:100%%22%3E%3Cthead%3E%3Ctr%20style=%22background:#3498db;color:white%22%3E%3Cth%20style=%22padding:8px%2012px;text-align:left%22%3EPlanCode%3C/th%3E%3Cth%20style=%22padding:8px%2012px;text-align:left%22%3E%E5%B9%B4%E6%9C%9F%3C/th%3E%3Cth%20style=%22padding:8px%2012px;text-align:left%22%3E%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1%3C/th%3E%3C/tr%3E%3C/thead%3E%3Ctbody%3E${o.map(r=%3E%60%3Ctr%20style=%22border-bottom:1px%20solid%20#eee%22%3E%3Ctd%20onclick=%22navigator.clipboard.writeText('${r.PlanCode}').then(()=%3E{var%20msg=document.createElement('div');msg.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD';msg.style='position:fixed;background:rgba(0,0,0,0.7);color:white;padding:2px%205px;border-radius:3px;z-index:999999;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;';document.body.appendChild(msg);setTimeout(()=%3Emsg.remove(),1000)})%22%20style=%22padding:8px%2012px;cursor:pointer%22%3E${r.PlanCode||''}%3C/td%3E%3Ctd%20onclick=%22navigator.clipboard.writeText('${r.%E5%B9%B4%E6%9C%9F}').then(()=%3E{var%20msg=document.createElement('div');msg.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD';msg.style='position:fixed;background:rgba(0,0,0,0.7);color:white;padding:2px%205px;border-radius:3px;z-index:999999;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;';document.body.appendChild(msg);setTimeout(()=%3Emsg.remove(),1000)})%22%20style=%22padding:8px%2012px;cursor:pointer%22%3E${r.%E5%B9%B4%E6%9C%9F||''}%3C/td%3E%3Ctd%20onclick=%22navigator.clipboard.writeText('${r.%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1}').then(()=%3E{var%20msg=document.createElement('div');msg.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD';msg.style='position:fixed;background:rgba(0,0,0,0.7);color:white;padding:2px%205px;border-radius:3px;z-index:999999;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;';document.body.appendChild(msg);setTimeout(()=%3Emsg.remove(),1000)})%22%20style=%22padding:8px%2012px;cursor:pointer%22%3E${r.%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1||''}%3C/td%3E%3C/tr%3E%60).join('')}%3C/tbody%3E%3C/table%3E%60;document.body.appendChild(c);var%20downloadButton=c.querySelector('#downloadBtn');downloadButton.addEventListener('click',()=%3E{var%20csvData=makeCSV();var%20a=document.createElement('a');a.href='data:text/csv;charset=utf-8,\ufeff'+encodeURIComponent(csvData);a.download='%E4%BF%9D%E5%96%AE%E8%A8%88%E5%8A%83%E6%9F%A5%E8%A9%A2_'+new%20Date().toISOString().slice(0,10)+'.csv';document.body.appendChild(a);a.click();setTimeout(()=%3Ea.remove(),250);});})();
＊＊＊＊＊第52段程式碼結束/205商品n /＊＊＊＊＊




＊＊＊＊＊第53段程式碼開始/183優化版本 /＊＊＊＊＊
javascript:(function(){   // %E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE   const CONFIG = {     maxApiEntries: 100,       // %E6%9C%80%E5%A4%A7API%E8%A8%98%E9%8C%84%E6%95%B8%E9%87%8F     maxTokenDisplay: 10,      // %E4%BB%A4%E7%89%8C%E9%A1%AF%E7%A4%BA%E9%95%B7%E5%BA%A6     refreshInterval: 1000,    // UI%E6%9B%B4%E6%96%B0%E9%96%93%E9%9A%94(ms)     theme: {       light: {         bg: '#fff',%20%20%20%20%20%20%20%20%20text:%20'#333',%20%20%20%20%20%20%20%20%20primary:%20'#4a6cf7',%20%20%20%20%20%20%20%20%20secondary:%20'#f0f2f5',%20%20%20%20%20%20%20%20%20border:%20'#ddd'%20%20%20%20%20%20%20},%20%20%20%20%20%20%20dark:%20{%20%20%20%20%20%20%20%20%20bg:%20'#1f2937',%20%20%20%20%20%20%20%20%20text:%20'#f3f4f6',%20%20%20%20%20%20%20%20%20primary:%20'#3b82f6',%20%20%20%20%20%20%20%20%20secondary:%20'#374151',%20%20%20%20%20%20%20%20%20border:%20'#4b5563'%20%20%20%20%20%20%20}%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20%E5%85%A8%E5%B1%80%E7%8B%80%E6%85%8B%20%20%20const%20STATE%20=%20{%20%20%20%20%20apiInfo:%20{%20%20%20%20%20%20%20endpoints:%20[],%20%20%20%20%20%20%20tokens:%20[],%20%20%20%20%20%20%20page:%20window.location.href,%20%20%20%20%20%20%20title:%20document.title,%20%20%20%20%20%20%20timestamp:%20new%20Date().toISOString()%20%20%20%20%20},%20%20%20%20%20settings:%20{%20%20%20%20%20%20%20darkMode:%20window.matchMedia('(prefers-color-scheme:%20dark)').matches,%20%20%20%20%20%20%20maskTokens:%20true,%20%20%20%20%20%20%20filterText:%20'',%20%20%20%20%20%20%20showOnlyErrors:%20false,%20%20%20%20%20%20%20sortBy:%20'time',%20//%20'time',%20'url',%20'method',%20'status'%20%20%20%20%20%20%20groupBy:%20'none',%20//%20'none',%20'endpoint',%20'status'%20%20%20%20%20%20%20activeTab:%20'endpoints'%20//%20'endpoints',%20'tokens',%20'visualization',%20'settings'%20%20%20%20%20},%20%20%20%20%20wsConnections:%20new%20Set(),%20%20%20%20%20interceptedWebsockets:%200,%20%20%20%20%20interceptedXHR:%200,%20%20%20%20%20interceptedFetch:%200,%20%20%20%20%20showLabels:%20true,%20%20%20%20%20showHeaders:%20false,%20%20%20%20%20expandedItems:%20new%20Set(),%20%20%20%20%20selectedRequestForReplay:%20null%20%20%20};%20%20%20%20//%20%E5%B7%A5%E5%85%B7%E9%A1%9E%E5%87%BD%E6%95%B8%20%20%20const%20Utils%20=%20{%20%20%20%20%20//%20DOM%E6%93%8D%E4%BD%9C%20%20%20%20%20createEl(tag,%20attributes%20=%20{},%20styles%20=%20{},%20innerHTML%20=%20'')%20{%20%20%20%20%20%20%20const%20el%20=%20document.createElement(tag);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%B1%AC%E6%80%A7%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(attributes))%20{%20%20%20%20%20%20%20%20%20if%20(key%20===%20'className')%20{%20%20%20%20%20%20%20%20%20%20%20el.className%20=%20value;%20%20%20%20%20%20%20%20%20}%20else%20if%20(key%20===%20'dataset')%20{%20%20%20%20%20%20%20%20%20%20%20for%20(const%20[dataKey,%20dataValue]%20of%20Object.entries(value))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20el.dataset[dataKey]%20=%20dataValue;%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20el.setAttribute(key,%20value);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(styles))%20{%20%20%20%20%20%20%20%20%20el.style[key]%20=%20value;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%85%A7%E5%AE%B9%20%20%20%20%20%20%20if%20(innerHTML)%20{%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20innerHTML;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20el;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E4%BA%8B%E4%BB%B6%E7%9B%A3%E8%81%BD%E7%B0%A1%E5%8C%96%E7%89%88%20%20%20%20%20on(el,%20event,%20handler)%20{%20%20%20%20%20%20%20el.addEventListener(event,%20handler);%20%20%20%20%20%20%20return%20()%20=%3E%20el.removeEventListener(event,%20handler);%20//%20%E8%BF%94%E5%9B%9E%E7%A7%BB%E9%99%A4%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%87%BD%E6%95%B8%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E5%BA%A6%E8%A4%87%E8%A3%BD%E5%B0%8D%E8%B1%A1%20%20%20%20%20deepClone(obj)%20{%20%20%20%20%20%20%20return%20JSON.parse(JSON.stringify(obj));%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%A5%E6%9C%9F%20%20%20%20%20formatDate(date)%20{%20%20%20%20%20%20%20return%20new%20Date(date).toLocaleString();%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%89%E5%85%A8%E5%9C%B0%E8%A7%A3%E6%9E%90JSON%20%20%20%20%20parseJSON(str)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20return%20JSON.parse(str);%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20str;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96JSON%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20formatJSON(obj)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(typeof%20obj%20===%20'string')%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(JSON.parse(obj),%20null,%202);%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(obj,%20null,%202);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20String(obj);%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%88%AA%E6%96%B7%E9%95%B7%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20truncate(str,%20length%20=%20100)%20{%20%20%20%20%20%20%20if%20(!str)%20return%20'';%20%20%20%20%20%20%20str%20=%20String(str);%20%20%20%20%20%20%20return%20str.length%20%3C=%20length%20?%20str%20:%20%60${str.substring(0,%20length)}...%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%81%AE%E8%94%BD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%20%20%20%20%20maskSensitive(str,%20showChars%20=%204)%20{%20%20%20%20%20%20%20if%20(!str%20||%20str.length%20%3C=%20showChars%20*%202)%20return%20str;%20%20%20%20%20%20%20return%20%60${str.substring(0,%20showChars)}...${str.substring(str.length%20-%20showChars)}%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96URL%EF%BC%88%E7%A7%BB%E9%99%A4%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%EF%BC%89%20%20%20%20%20formatURL(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20return%20%60${urlObj.origin}${urlObj.pathname}%60;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20url;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%8F%90%E5%8F%96URL%E7%9A%84%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%20%20%20%20%20getURLParams(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20params%20=%20{};%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20urlObj.searchParams.entries())%20{%20%20%20%20%20%20%20%20%20%20%20params[key]%20=%20value;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20params;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20{};%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%AB%98%E4%BA%AEJSON%20%20%20%20%20syntaxHighlight(json)%20{%20%20%20%20%20%20%20if%20(!json)%20return%20'';%20%20%20%20%20%20%20json%20=%20json.replace(/&/g,%20'&').replace(/%3C/g,%20'<').replace(/%3E/g,%20'>');%20%20%20%20%20%20%20return%20json.replace(/(%22(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\%22])*%22(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,%20function%20(match)%20{%20%20%20%20%20%20%20%20%20let%20cls%20=%20'number';%20%20%20%20%20%20%20%20%20if%20(/^%22/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20if%20(/:$/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'key';%20%20%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'string';%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20if%20(/true|false/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'boolean';%20%20%20%20%20%20%20%20%20}%20else%20if%20(/null/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'null';%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20'%3Cspan%20class=%22'%20+%20cls%20+%20'%22%3E'%20+%20match%20+%20'%3C/span%3E';%20%20%20%20%20%20%20});%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BCJWT%E4%BB%A4%E7%89%8C%20%20%20%20%20decodeJWT(token)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(!token%20||%20typeof%20token%20!==%20'string'%20||%20!token.includes('.'))%20{%20%20%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%88%86%E5%89%B2%E4%BB%A4%E7%89%8C%20%20%20%20%20%20%20%20%20const%20parts%20=%20token.split('.');%20%20%20%20%20%20%20%20%20if%20(parts.length%20!==%203)%20return%20null;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BC%E6%AF%8F%E5%80%8B%E9%83%A8%E5%88%86%20%20%20%20%20%20%20%20%20const%20header%20=%20JSON.parse(atob(parts[0]));%20%20%20%20%20%20%20%20%20const%20payload%20=%20JSON.parse(atob(parts[1]));%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E9%81%8E%E6%9C%9F%E6%99%82%E9%96%93%20%20%20%20%20%20%20%20%20let%20isExpired%20=%20false;%20%20%20%20%20%20%20%20%20if%20(payload.exp)%20{%20%20%20%20%20%20%20%20%20%20%20isExpired%20=%20Date.now()%20%3E=%20payload.exp%20*%201000;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20%20%20header,%20%20%20%20%20%20%20%20%20%20%20payload,%20%20%20%20%20%20%20%20%20%20%20isExpired,%20%20%20%20%20%20%20%20%20%20%20expiresAt:%20payload.exp%20?%20new%20Date(payload.exp%20*%201000).toLocaleString()%20:%20'Unknown'%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20console.error('JWT%E8%A7%A3%E7%A2%BC%E5%A4%B1%E6%95%97:',%20e);%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E7%B0%A1%E5%96%AE%E7%9A%84%E5%9C%96%E8%A1%A8%20%20%20%20%20createBarChart(data,%20labels,%20options%20=%20{})%20{%20%20%20%20%20%20%20const%20{%20width%20=%20300,%20height%20=%20200,%20barColor%20=%20'#4a6cf7'%20}%20=%20options;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9C%80%E5%A4%A7%E5%80%BC%E8%A8%88%E7%AE%97%20%20%20%20%20%20%20const%20maxValue%20=%20Math.max(...data);%20%20%20%20%20%20%20const%20svg%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'svg');%20%20%20%20%20%20%20svg.setAttribute('width',%20width);%20%20%20%20%20%20%20svg.setAttribute('height',%20height);%20%20%20%20%20%20%20svg.style.overflow%20=%20'visible';%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%88%E7%AE%97bar%E7%9A%84%E5%AF%AC%E5%BA%A6%E5%92%8C%E9%96%93%E8%B7%9D%20%20%20%20%20%20%20const%20barWidth%20=%20(width%20/%20data.length)%20*%200.7;%20%20%20%20%20%20%20const%20barGap%20=%20(width%20/%20data.length)%20*%200.3;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BD%E6%AF%8F%E5%80%8Bbar%20%20%20%20%20%20%20data.forEach((value,%20i)%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20barHeight%20=%20(value%20/%20maxValue)%20*%20(height%20-%2030);%20%20%20%20%20%20%20%20%20const%20x%20=%20i%20*%20(barWidth%20+%20barGap);%20%20%20%20%20%20%20%20%20const%20y%20=%20height%20-%20barHeight%20-%2020;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BDbar%20%20%20%20%20%20%20%20%20const%20bar%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'rect');%20%20%20%20%20%20%20%20%20bar.setAttribute('x',%20x);%20%20%20%20%20%20%20%20%20bar.setAttribute('y',%20y);%20%20%20%20%20%20%20%20%20bar.setAttribute('width',%20barWidth);%20%20%20%20%20%20%20%20%20bar.setAttribute('height',%20barHeight);%20%20%20%20%20%20%20%20%20bar.setAttribute('fill',%20barColor);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%95%B8%E5%80%BC%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20text%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20text.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20text.setAttribute('y',%20y%20-%205);%20%20%20%20%20%20%20%20%20text.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20text.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20text.textContent%20=%20value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0x%E8%BB%B8%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20label%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20label.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20label.setAttribute('y',%20height%20-%205);%20%20%20%20%20%20%20%20%20label.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20label.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20label.textContent%20=%20labels[i]%20||%20'';%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg.appendChild(bar);%20%20%20%20%20%20%20%20%20svg.appendChild(text);%20%20%20%20%20%20%20%20%20svg.appendChild(label);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20svg;%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20UI%E6%A7%8B%E5%BB%BA%E5%99%A8%20%20%20const%20UI%20=%20{%20%20%20%20%20//%20%E5%9F%BA%E6%9C%ACUI%E5%85%83%E7%B4%A0%E6%A8%A3%E5%BC%8F%20%20%20%20%20getStyles(darkMode)%20{%20%20%20%20%20%20%20const%20theme%20=%20darkMode%20?%20CONFIG.theme.dark%20:%20CONFIG.theme.light;%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20container:%20%60%20%20%20%20%20%20%20%20%20%20%20position:%20fixed;%20%20%20%20%20%20%20%20%20%20%20top:%2020px;%20%20%20%20%20%20%20%20%20%20%20right:%2020px;%20%20%20%20%20%20%20%20%20%20%20width:%20400px;%20%20%20%20%20%20%20%20%20%20%20max-height:%2080vh;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20border-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20box-shadow:%200%200%2020px%20rgba(0,0,0,0.3);%20%20%20%20%20%20%20%20%20%20%20z-index:%209999999;%20%20%20%20%20%20%20%20%20%20%20font-family:%20sans-serif;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.3s%20ease;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20header:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%2015px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20cursor:%20move;%20%20%20%20%20%20%20%20%20%20%20user-select:%20none;%20%20%20%20%20%20%20%20%20%20%20border-top-left-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20border-top-right-radius:%208px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20content:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2015px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20flex-grow:%201;%20%20%20%20%20%20%20%20%20%20%20max-height:%20calc(80vh%20-%20110px);%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabs:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tab:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2015px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTab:%20%60%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%202px%20solid%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20button:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20smallButton:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%202px%208px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panel:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelHeader:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelContent:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20line-height:%201.5;%20%20%20%20%20%20%20%20%20%20%20border-top:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20input:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%2095%;%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20select:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20label:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20checkbox:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20jsonView:%20%60%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20font-size:%2011px;%20%20%20%20%20%20%20%20%20%20%20padding:%205px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%203px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20200px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20badge:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20actionBar:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-wrap:%20wrap;%20%20%20%20%20%20%20%20%20%20%20gap:%208px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20none;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%200;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20resultText:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%20100%;%20%20%20%20%20%20%20%20%20%20%20min-height:%20100px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20400px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20infoRow:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20chip:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20margin-right:%204px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%204px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20//%20%E8%AA%9E%E6%B3%95%E9%AB%98%E4%BA%AE%20%20%20%20%20%20%20%20%20syntaxHighlight:%20%60%20%20%20%20%20%20%20%20%20%20%20.string%20{%20color:%20#28a745;%20}%20%20%20%20%20%20%20%20%20%20%20.number%20{%20color:%20#17a2b8;%20}%20%20%20%20%20%20%20%20%20%20%20.boolean%20{%20color:%20#6f42c1;%20}%20%20%20%20%20%20%20%20%20%20%20.null%20{%20color:%20#dc3545;%20}%20%20%20%20%20%20%20%20%20%20%20.key%20{%20color:%20#007bff;%20}%20%20%20%20%20%20%20%20%20%60%20%20%20%20%20%20%20};%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E8%A6%81UI%20%20%20%20%20createMainUI()%20{%20%20%20%20%20%20%20const%20styles%20=%20this.getStyles(STATE.settings.darkMode);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E6%98%AF%E5%90%A6%E5%B7%B2%E7%B6%93%E5%AD%98%E5%9C%A8%20%20%20%20%20%20%20if%20(document.getElementById('api-analyzer-container'))%20{%20%20%20%20%20%20%20%20%20document.getElementById('api-analyzer-container').remove();%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20container%20=%20Utils.createEl('div',%20{%20id:%20'api-analyzer-container'%20});%20%20%20%20%20%20%20container.style.cssText%20=%20styles.container;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%A8%A3%E5%BC%8F%E8%A1%A8%20%20%20%20%20%20%20const%20styleSheet%20=%20Utils.createEl('style',%20{%20id:%20'api-analyzer-styles'%20});%20%20%20%20%20%20%20styleSheet.textContent%20=%20styles.syntaxHighlight;%20%20%20%20%20%20%20container.appendChild(styleSheet);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E9%A1%8C%E6%AC%84%20%20%20%20%20%20%20const%20header%20=%20Utils.createEl('div',%20{},%20{},%20'API%20%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7');%20%20%20%20%20%20%20header.style.cssText%20=%20styles.header;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%8C%89%E9%88%95%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20buttonGroup%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'8px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E8%89%B2%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8F%9B%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20themeButton%20=%20Utils.createEl('button',%20{},%20{},%20STATE.settings.darkMode%20?%20'%E2%98%80%EF%B8%8F'%20:%20'%F0%9F%8C%99');%20%20%20%20%20%20%20themeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20themeButton.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.darkMode%20=%20!STATE.settings.darkMode;%20%20%20%20%20%20%20%20%20this.updateTheme();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E9%97%9C%E9%96%89%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20closeButton%20=%20Utils.createEl('button',%20{},%20{},%20'%E2%9C%95');%20%20%20%20%20%20%20closeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20closeButton.onclick%20=%20()%20=%3E%20container.remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%8C%89%E9%88%95%E5%88%B0%E6%8C%89%E9%88%95%E7%B5%84%20%20%20%20%20%20%20buttonGroup.appendChild(themeButton);%20%20%20%20%20%20%20buttonGroup.appendChild(closeButton);%20%20%20%20%20%20%20header.appendChild(buttonGroup);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%E6%AC%84%20%20%20%20%20%20%20const%20tabs%20=%20Utils.createEl('div');%20%20%20%20%20%20%20tabs.style.cssText%20=%20styles.tabs;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%9A%E7%BE%A9%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20const%20tabDefs%20=%20[%20%20%20%20%20%20%20%20%20{%20id:%20'endpoints',%20label:%20'API%E7%AB%AF%E9%BB%9E'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'tokens',%20label:%20'%E4%BB%A4%E7%89%8C'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'visualization',%20label:%20'%E8%A6%96%E8%A6%BA%E5%8C%96'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'settings',%20label:%20'%E8%A8%AD%E5%AE%9A'%20}%20%20%20%20%20%20%20];%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20tabDefs.forEach(tabDef%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20tab%20=%20Utils.createEl('div',%20{%20id:%20%60tab-${tabDef.id}%60%20},%20{},%20tabDef.label);%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20if%20(STATE.settings.activeTab%20===%20tabDef.id)%20{%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20+=%20styles.activeTab;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20tab.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20STATE.settings.activeTab%20=%20tabDef.id;%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E6%A8%99%E7%B1%A4%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22tab-%22]').forEach(t%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20t.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab%20+%20styles.activeTab;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22content-%22]').forEach(c%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20c.style.display%20=%20'none';%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20document.getElementById(%60content-${tabDef.id}%60).style.display%20=%20'block';%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20tabs.appendChild(tab);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20const%20content%20=%20Utils.createEl('div');%20%20%20%20%20%20%20content.style.cssText%20=%20styles.content;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B5%90%E6%9E%9C%E9%A1%AF%E7%A4%BA%E5%8D%80%E5%9F%9F%20(endpoints)%20%20%20%20%20%20%20const%20endpointsContent%20=%20Utils.createEl('div',%20{%20id:%20'content-endpoints'%20});%20%20%20%20%20%20%20endpointsContent.style.cssText%20=%20STATE.settings.activeTab%20===%20'endpoints'%20?%20styles.tabContent%20+%20styles.activeTabContent%20:%20styles.tabContent;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E5%92%8C%E9%81%8E%E6%BF%BE%E6%A2%9D%E4%BB%B6%20%20%20%20%20%20%20const%20filterBar%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'10px',%20marginBottom:%20'10px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E6%A1%86%20%20%20%20%20%20%20const%20searchInput%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'text',%20%20%20%20%20%20%20%20%20%20placeholder:%20'%E6%90%9C%E5%B0%8BAPI%E7%AB%AF%E9%BB%9E...',%20%20%20%20%20%20%20%20%20value:%20STATE.settings.filterText%20%20%20%20%20%20%20});%20%20%20%20%20%20%20searchInput.style.cssText%20=%20styles.input;%20%20%20%20%20%20%20searchInput.style.flex%20=%20'1';%20%20%20%20%20%20%20searchInput.onkeyup%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.filterText%20=%20e.target.value;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4%E9%81%B8%E9%A0%85%20%20%20%20%20%20%20const%20errorFilterContainer%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20alignItems:%20'center'%20});%20%20%20%20%20%20%20const%20errorFilterCheck%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'checkbox',%20%20%20%20%20%20%20%20%20id:%20'show-errors-only',%20%20%20%20%20%20%20%20%20checked:%20STATE.settings.showOnlyErrors%20%20%20%20%20%20%20});%20%20%20%20%20%20%20errorFilterCheck.style.cssText%20=%20styles.checkbox;%20%20%20%20%20%20%20errorFilterCheck.onchange%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.showOnlyErrors%20=%20e.target.checked;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20errorFilterLabel%20=%20Utils.createEl('label',%20{%20for:%20'show-errors-only'%20},%20{},%20'%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4');%20%20%20%20%20%20%20errorFilterLabel.style.cssText%20=%20styles.label;%20%20%20%20%20%20%20errorFilterLabel.style.marginBottom%20=%20'0';%20%20%20%20%20%20%20%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterCheck);%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterLabel);%20%20%20%20%20%20%20%20%20%20%20%20%20%20filterBar.appendChild(searchInput);%20%20%20%20%20%20%20filterBar.appendChild(errorFilterContainer);%20%20%20%20%20%20%20%20%20%20%20%20%20%20endpointsContent.appendChild(filterBar);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20API%E7%AB%AF%E9%BB%9E%E5%88%97%E8%A1%A8%20%20%20%20%20%20%20const%20endpointsList%20=%20Utils.createEl('div',%20{%20id:%20'endpoints-list'%20});%20%20%20%20%20%20%20endpointsC
＊＊＊＊＊第53段程式碼結束/183優化版本 /＊＊＊＊＊




＊＊＊＊＊第54段程式碼開始/184優化版本 /＊＊＊＊＊
javascript:(function(){   // %E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE   const CONFIG = {     maxApiEntries: 100,       // %E6%9C%80%E5%A4%A7API%E8%A8%98%E9%8C%84%E6%95%B8%E9%87%8F     maxTokenDisplay: 10,      // %E4%BB%A4%E7%89%8C%E9%A1%AF%E7%A4%BA%E9%95%B7%E5%BA%A6     refreshInterval: 1000,    // UI%E6%9B%B4%E6%96%B0%E9%96%93%E9%9A%94(ms)     theme: {       light: {         bg: '#fff',%20%20%20%20%20%20%20%20%20text:%20'#333',%20%20%20%20%20%20%20%20%20primary:%20'#4a6cf7',%20%20%20%20%20%20%20%20%20secondary:%20'#f0f2f5',%20%20%20%20%20%20%20%20%20border:%20'#ddd'%20%20%20%20%20%20%20},%20%20%20%20%20%20%20dark:%20{%20%20%20%20%20%20%20%20%20bg:%20'#1f2937',%20%20%20%20%20%20%20%20%20text:%20'#f3f4f6',%20%20%20%20%20%20%20%20%20primary:%20'#3b82f6',%20%20%20%20%20%20%20%20%20secondary:%20'#374151',%20%20%20%20%20%20%20%20%20border:%20'#4b5563'%20%20%20%20%20%20%20}%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20%E5%85%A8%E5%B1%80%E7%8B%80%E6%85%8B%20%20%20const%20STATE%20=%20{%20%20%20%20%20apiInfo:%20{%20%20%20%20%20%20%20endpoints:%20[],%20%20%20%20%20%20%20tokens:%20[],%20%20%20%20%20%20%20page:%20window.location.href,%20%20%20%20%20%20%20title:%20document.title,%20%20%20%20%20%20%20timestamp:%20new%20Date().toISOString()%20%20%20%20%20},%20%20%20%20%20settings:%20{%20%20%20%20%20%20%20darkMode:%20window.matchMedia('(prefers-color-scheme:%20dark)').matches,%20%20%20%20%20%20%20maskTokens:%20true,%20%20%20%20%20%20%20filterText:%20'',%20%20%20%20%20%20%20showOnlyErrors:%20false,%20%20%20%20%20%20%20sortBy:%20'time',%20//%20'time',%20'url',%20'method',%20'status'%20%20%20%20%20%20%20groupBy:%20'none',%20//%20'none',%20'endpoint',%20'status'%20%20%20%20%20%20%20activeTab:%20'endpoints'%20//%20'endpoints',%20'tokens',%20'visualization',%20'settings'%20%20%20%20%20},%20%20%20%20%20wsConnections:%20new%20Set(),%20%20%20%20%20interceptedWebsockets:%200,%20%20%20%20%20interceptedXHR:%200,%20%20%20%20%20interceptedFetch:%200,%20%20%20%20%20showLabels:%20true,%20%20%20%20%20showHeaders:%20false,%20%20%20%20%20expandedItems:%20new%20Set(),%20%20%20%20%20selectedRequestForReplay:%20null%20%20%20};%20%20%20%20//%20%E5%B7%A5%E5%85%B7%E9%A1%9E%E5%87%BD%E6%95%B8%20%20%20const%20Utils%20=%20{%20%20%20%20%20//%20DOM%E6%93%8D%E4%BD%9C%20%20%20%20%20createEl(tag,%20attributes%20=%20{},%20styles%20=%20{},%20innerHTML%20=%20'')%20{%20%20%20%20%20%20%20const%20el%20=%20document.createElement(tag);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%B1%AC%E6%80%A7%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(attributes))%20{%20%20%20%20%20%20%20%20%20if%20(key%20===%20'className')%20{%20%20%20%20%20%20%20%20%20%20%20el.className%20=%20value;%20%20%20%20%20%20%20%20%20}%20else%20if%20(key%20===%20'dataset')%20{%20%20%20%20%20%20%20%20%20%20%20for%20(const%20[dataKey,%20dataValue]%20of%20Object.entries(value))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20el.dataset[dataKey]%20=%20dataValue;%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20el.setAttribute(key,%20value);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(styles))%20{%20%20%20%20%20%20%20%20%20el.style[key]%20=%20value;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%85%A7%E5%AE%B9%20%20%20%20%20%20%20if%20(innerHTML)%20{%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20innerHTML;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20el;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E4%BA%8B%E4%BB%B6%E7%9B%A3%E8%81%BD%E7%B0%A1%E5%8C%96%E7%89%88%20%20%20%20%20on(el,%20event,%20handler)%20{%20%20%20%20%20%20%20el.addEventListener(event,%20handler);%20%20%20%20%20%20%20return%20()%20=%3E%20el.removeEventListener(event,%20handler);%20//%20%E8%BF%94%E5%9B%9E%E7%A7%BB%E9%99%A4%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%87%BD%E6%95%B8%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E5%BA%A6%E8%A4%87%E8%A3%BD%E5%B0%8D%E8%B1%A1%20%20%20%20%20deepClone(obj)%20{%20%20%20%20%20%20%20return%20JSON.parse(JSON.stringify(obj));%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%A5%E6%9C%9F%20%20%20%20%20formatDate(date)%20{%20%20%20%20%20%20%20return%20new%20Date(date).toLocaleString();%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%89%E5%85%A8%E5%9C%B0%E8%A7%A3%E6%9E%90JSON%20%20%20%20%20parseJSON(str)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20return%20JSON.parse(str);%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20str;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96JSON%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20formatJSON(obj)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(typeof%20obj%20===%20'string')%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(JSON.parse(obj),%20null,%202);%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(obj,%20null,%202);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20String(obj);%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%88%AA%E6%96%B7%E9%95%B7%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20truncate(str,%20length%20=%20100)%20{%20%20%20%20%20%20%20if%20(!str)%20return%20'';%20%20%20%20%20%20%20str%20=%20String(str);%20%20%20%20%20%20%20return%20str.length%20%3C=%20length%20?%20str%20:%20%60${str.substring(0,%20length)}...%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%81%AE%E8%94%BD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%20%20%20%20%20maskSensitive(str,%20showChars%20=%204)%20{%20%20%20%20%20%20%20if%20(!str%20||%20str.length%20%3C=%20showChars%20*%202)%20return%20str;%20%20%20%20%20%20%20return%20%60${str.substring(0,%20showChars)}...${str.substring(str.length%20-%20showChars)}%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96URL%EF%BC%88%E7%A7%BB%E9%99%A4%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%EF%BC%89%20%20%20%20%20formatURL(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20return%20%60${urlObj.origin}${urlObj.pathname}%60;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20url;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%8F%90%E5%8F%96URL%E7%9A%84%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%20%20%20%20%20getURLParams(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20params%20=%20{};%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20urlObj.searchParams.entries())%20{%20%20%20%20%20%20%20%20%20%20%20params[key]%20=%20value;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20params;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20{};%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%AB%98%E4%BA%AEJSON%20%20%20%20%20syntaxHighlight(json)%20{%20%20%20%20%20%20%20if%20(!json)%20return%20'';%20%20%20%20%20%20%20json%20=%20json.replace(/&/g,%20'&').replace(/%3C/g,%20'%3C').replace(/%3E/g,%20'%3E');%20%20%20%20%20%20%20return%20json.replace(/(%22(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\%22])*%22(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,%20function%20(match)%20{%20%20%20%20%20%20%20%20%20let%20cls%20=%20'number';%20%20%20%20%20%20%20%20%20if%20(/^%22/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20if%20(/:$/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'key';%20%20%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'string';%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20if%20(/true|false/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'boolean';%20%20%20%20%20%20%20%20%20}%20else%20if%20(/null/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'null';%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20'%3Cspan%20class=%22'%20+%20cls%20+%20'%22%3E'%20+%20match%20+%20'%3C/span%3E';%20%20%20%20%20%20%20});%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BCJWT%E4%BB%A4%E7%89%8C%20%20%20%20%20decodeJWT(token)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(!token%20||%20typeof%20token%20!==%20'string'%20||%20!token.includes('.'))%20{%20%20%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%88%86%E5%89%B2%E4%BB%A4%E7%89%8C%20%20%20%20%20%20%20%20%20const%20parts%20=%20token.split('.');%20%20%20%20%20%20%20%20%20if%20(parts.length%20!==%203)%20return%20null;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BC%E6%AF%8F%E5%80%8B%E9%83%A8%E5%88%86%20%20%20%20%20%20%20%20%20const%20header%20=%20JSON.parse(atob(parts[0]));%20%20%20%20%20%20%20%20%20const%20payload%20=%20JSON.parse(atob(parts[1]));%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E9%81%8E%E6%9C%9F%E6%99%82%E9%96%93%20%20%20%20%20%20%20%20%20let%20isExpired%20=%20false;%20%20%20%20%20%20%20%20%20if%20(payload.exp)%20{%20%20%20%20%20%20%20%20%20%20%20isExpired%20=%20Date.now()%20%3E=%20payload.exp%20*%201000;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20%20%20header,%20%20%20%20%20%20%20%20%20%20%20payload,%20%20%20%20%20%20%20%20%20%20%20isExpired,%20%20%20%20%20%20%20%20%20%20%20expiresAt:%20payload.exp%20?%20new%20Date(payload.exp%20*%201000).toLocaleString()%20:%20'Unknown'%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20console.error('JWT%E8%A7%A3%E7%A2%BC%E5%A4%B1%E6%95%97:',%20e);%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E7%B0%A1%E5%96%AE%E7%9A%84%E5%9C%96%E8%A1%A8%20%20%20%20%20createBarChart(data,%20labels,%20options%20=%20{})%20{%20%20%20%20%20%20%20const%20{%20width%20=%20300,%20height%20=%20200,%20barColor%20=%20'#4a6cf7'%20}%20=%20options;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9C%80%E5%A4%A7%E5%80%BC%E8%A8%88%E7%AE%97%20%20%20%20%20%20%20const%20maxValue%20=%20Math.max(...data);%20%20%20%20%20%20%20const%20svg%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'svg');%20%20%20%20%20%20%20svg.setAttribute('width',%20width);%20%20%20%20%20%20%20svg.setAttribute('height',%20height);%20%20%20%20%20%20%20svg.style.overflow%20=%20'visible';%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%88%E7%AE%97bar%E7%9A%84%E5%AF%AC%E5%BA%A6%E5%92%8C%E9%96%93%E8%B7%9D%20%20%20%20%20%20%20const%20barWidth%20=%20(width%20/%20data.length)%20*%200.7;%20%20%20%20%20%20%20const%20barGap%20=%20(width%20/%20data.length)%20*%200.3;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BD%E6%AF%8F%E5%80%8Bbar%20%20%20%20%20%20%20data.forEach((value,%20i)%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20barHeight%20=%20(value%20/%20maxValue)%20*%20(height%20-%2030);%20%20%20%20%20%20%20%20%20const%20x%20=%20i%20*%20(barWidth%20+%20barGap);%20%20%20%20%20%20%20%20%20const%20y%20=%20height%20-%20barHeight%20-%2020;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BDbar%20%20%20%20%20%20%20%20%20const%20bar%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'rect');%20%20%20%20%20%20%20%20%20bar.setAttribute('x',%20x);%20%20%20%20%20%20%20%20%20bar.setAttribute('y',%20y);%20%20%20%20%20%20%20%20%20bar.setAttribute('width',%20barWidth);%20%20%20%20%20%20%20%20%20bar.setAttribute('height',%20barHeight);%20%20%20%20%20%20%20%20%20bar.setAttribute('fill',%20barColor);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%95%B8%E5%80%BC%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20text%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20text.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20text.setAttribute('y',%20y%20-%205);%20%20%20%20%20%20%20%20%20text.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20text.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20text.textContent%20=%20value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0x%E8%BB%B8%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20label%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20label.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20label.setAttribute('y',%20height%20-%205);%20%20%20%20%20%20%20%20%20label.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20label.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20label.textContent%20=%20labels[i]%20||%20'';%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg.appendChild(bar);%20%20%20%20%20%20%20%20%20svg.appendChild(text);%20%20%20%20%20%20%20%20%20svg.appendChild(label);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20svg;%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20UI%E6%A7%8B%E5%BB%BA%E5%99%A8%20%20%20const%20UI%20=%20{%20%20%20%20%20//%20%E5%9F%BA%E6%9C%ACUI%E5%85%83%E7%B4%A0%E6%A8%A3%E5%BC%8F%20%20%20%20%20getStyles(darkMode)%20{%20%20%20%20%20%20%20const%20theme%20=%20darkMode%20?%20CONFIG.theme.dark%20:%20CONFIG.theme.light;%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20container:%20%60%20%20%20%20%20%20%20%20%20%20%20position:%20fixed;%20%20%20%20%20%20%20%20%20%20%20top:%2020px;%20%20%20%20%20%20%20%20%20%20%20right:%2020px;%20%20%20%20%20%20%20%20%20%20%20width:%20400px;%20%20%20%20%20%20%20%20%20%20%20max-height:%2080vh;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20border-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20box-shadow:%200%200%2020px%20rgba(0,0,0,0.3);%20%20%20%20%20%20%20%20%20%20%20z-index:%209999999;%20%20%20%20%20%20%20%20%20%20%20font-family:%20sans-serif;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.3s%20ease;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20header:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%2015px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20cursor:%20move;%20%20%20%20%20%20%20%20%20%20%20user-select:%20none;%20%20%20%20%20%20%20%20%20%20%20border-top-left-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20border-top-right-radius:%208px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20content:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2015px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20flex-grow:%201;%20%20%20%20%20%20%20%20%20%20%20max-height:%20calc(80vh%20-%20110px);%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabs:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tab:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2015px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTab:%20%60%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%202px%20solid%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20button:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20smallButton:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%202px%208px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panel:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelHeader:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelContent:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20line-height:%201.5;%20%20%20%20%20%20%20%20%20%20%20border-top:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20input:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%2095%;%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20select:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20label:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20checkbox:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20jsonView:%20%60%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20font-size:%2011px;%20%20%20%20%20%20%20%20%20%20%20padding:%205px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%203px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20200px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20badge:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20actionBar:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-wrap:%20wrap;%20%20%20%20%20%20%20%20%20%20%20gap:%208px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20none;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%200;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20resultText:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%20100%;%20%20%20%20%20%20%20%20%20%20%20min-height:%20100px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20400px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20infoRow:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20chip:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20margin-right:%204px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%204px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20//%20%E8%AA%9E%E6%B3%95%E9%AB%98%E4%BA%AE%20%20%20%20%20%20%20%20%20syntaxHighlight:%20%60%20%20%20%20%20%20%20%20%20%20%20.string%20{%20color:%20#28a745;%20}%20%20%20%20%20%20%20%20%20%20%20.number%20{%20color:%20#17a2b8;%20}%20%20%20%20%20%20%20%20%20%20%20.boolean%20{%20color:%20#6f42c1;%20}%20%20%20%20%20%20%20%20%20%20%20.null%20{%20color:%20#dc3545;%20}%20%20%20%20%20%20%20%20%20%20%20.key%20{%20color:%20#007bff;%20}%20%20%20%20%20%20%20%20%20%60%20%20%20%20%20%20%20};%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E8%A6%81UI%20%20%20%20%20createMainUI()%20{%20%20%20%20%20%20%20const%20styles%20=%20this.getStyles(STATE.settings.darkMode);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E6%98%AF%E5%90%A6%E5%B7%B2%E7%B6%93%E5%AD%98%E5%9C%A8%20%20%20%20%20%20%20if%20(document.getElementById('api-analyzer-container'))%20{%20%20%20%20%20%20%20%20%20document.getElementById('api-analyzer-container').remove();%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20container%20=%20Utils.createEl('div',%20{%20id:%20'api-analyzer-container'%20});%20%20%20%20%20%20%20container.style.cssText%20=%20styles.container;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%A8%A3%E5%BC%8F%E8%A1%A8%20%20%20%20%20%20%20const%20styleSheet%20=%20Utils.createEl('style',%20{%20id:%20'api-analyzer-styles'%20});%20%20%20%20%20%20%20styleSheet.textContent%20=%20styles.syntaxHighlight;%20%20%20%20%20%20%20container.appendChild(styleSheet);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E9%A1%8C%E6%AC%84%20%20%20%20%20%20%20const%20header%20=%20Utils.createEl('div',%20{},%20{},%20'API%20%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7');%20%20%20%20%20%20%20header.style.cssText%20=%20styles.header;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%8C%89%E9%88%95%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20buttonGroup%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'8px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E8%89%B2%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8F%9B%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20themeButton%20=%20Utils.createEl('button',%20{},%20{},%20STATE.settings.darkMode%20?%20'%E2%98%80%EF%B8%8F'%20:%20'%F0%9F%8C%99');%20%20%20%20%20%20%20themeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20themeButton.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.darkMode%20=%20!STATE.settings.darkMode;%20%20%20%20%20%20%20%20%20this.updateTheme();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E9%97%9C%E9%96%89%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20closeButton%20=%20Utils.createEl('button',%20{},%20{},%20'%E2%9C%95');%20%20%20%20%20%20%20closeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20closeButton.onclick%20=%20()%20=%3E%20container.remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%8C%89%E9%88%95%E5%88%B0%E6%8C%89%E9%88%95%E7%B5%84%20%20%20%20%20%20%20buttonGroup.appendChild(themeButton);%20%20%20%20%20%20%20buttonGroup.appendChild(closeButton);%20%20%20%20%20%20%20header.appendChild(buttonGroup);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%E6%AC%84%20%20%20%20%20%20%20const%20tabs%20=%20Utils.createEl('div');%20%20%20%20%20%20%20tabs.style.cssText%20=%20styles.tabs;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%9A%E7%BE%A9%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20const%20tabDefs%20=%20[%20%20%20%20%20%20%20%20%20{%20id:%20'endpoints',%20label:%20'API%E7%AB%AF%E9%BB%9E'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'tokens',%20label:%20'%E4%BB%A4%E7%89%8C'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'visualization',%20label:%20'%E8%A6%96%E8%A6%BA%E5%8C%96'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'settings',%20label:%20'%E8%A8%AD%E5%AE%9A'%20}%20%20%20%20%20%20%20];%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20tabDefs.forEach(tabDef%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20tab%20=%20Utils.createEl('div',%20{%20id:%20%60tab-${tabDef.id}%60%20},%20{},%20tabDef.label);%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20if%20(STATE.settings.activeTab%20===%20tabDef.id)%20{%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20+=%20styles.activeTab;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20tab.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20STATE.settings.activeTab%20=%20tabDef.id;%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E6%A8%99%E7%B1%A4%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22tab-%22]').forEach(t%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20t.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab%20+%20styles.activeTab;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22content-%22]').forEach(c%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20c.style.display%20=%20'none';%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20document.getElementById(%60content-${tabDef.id}%60).style.display%20=%20'block';%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20tabs.appendChild(tab);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20const%20content%20=%20Utils.createEl('div');%20%20%20%20%20%20%20content.style.cssText%20=%20styles.content;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B5%90%E6%9E%9C%E9%A1%AF%E7%A4%BA%E5%8D%80%E5%9F%9F%20(endpoints)%20%20%20%20%20%20%20const%20endpointsContent%20=%20Utils.createEl('div',%20{%20id:%20'content-endpoints'%20});%20%20%20%20%20%20%20endpointsContent.style.cssText%20=%20STATE.settings.activeTab%20===%20'endpoints'%20?%20styles.tabContent%20+%20styles.activeTabContent%20:%20styles.tabContent;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E5%92%8C%E9%81%8E%E6%BF%BE%E6%A2%9D%E4%BB%B6%20%20%20%20%20%20%20const%20filterBar%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'10px',%20marginBottom:%20'10px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E6%A1%86%20%20%20%20%20%20%20const%20searchInput%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'text',%20%20%20%20%20%20%20%20%20%20placeholder:%20'%E6%90%9C%E5%B0%8BAPI%E7%AB%AF%E9%BB%9E...',%20%20%20%20%20%20%20%20%20value:%20STATE.settings.filterText%20%20%20%20%20%20%20});%20%20%20%20%20%20%20searchInput.style.cssText%20=%20styles.input;%20%20%20%20%20%20%20searchInput.style.flex%20=%20'1';%20%20%20%20%20%20%20searchInput.onkeyup%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.filterText%20=%20e.target.value;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4%E9%81%B8%E9%A0%85%20%20%20%20%20%20%20const%20errorFilterContainer%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20alignItems:%20'center'%20});%20%20%20%20%20%20%20const%20errorFilterCheck%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'checkbox',%20%20%20%20%20%20%20%20%20id:%20'show-errors-only',%20%20%20%20%20%20%20%20%20checked:%20STATE.settings.showOnlyErrors%20%20%20%20%20%20%20});%20%20%20%20%20%20%20errorFilterCheck.style.cssText%20=%20styles.checkbox;%20%20%20%20%20%20%20errorFilterCheck.onchange%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.showOnlyErrors%20=%20e.target.checked;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20errorFilterLabel%20=%20Utils.createEl('label',%20{%20for:%20'show-errors-only'%20},%20{},%20'%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4');%20%20%20%20%20%20%20errorFilterLabel.style.cssText%20=%20styles.label;%20%20%20%20%20%20%20errorFilterLabel.style.marginBottom%20=%20'0';%20%20%20%20%20%20%20%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterCheck);%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterLabel);%20%20%20%20%20%20%20%20%20%20%20%20%20%20filterBar.appendChild(searchInput);%20%20%20%20%20%20%20filterBar.appendChild(errorFilterContainer);%20%20%20%20%20%20%20%20%20%20%20%20%20%20endpointsContent.appendChild(filterBar);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20API%E7%AB%AF%E9%BB%9E%E5%88%97%E8%A1%A8%20%20%20%20%20%20%20const%20endpointsList%20=%20Utils.createEl('div',%20{%20id:%20'endpoints-list'%20});%20%20%20%20%20%20%20endpoi
＊＊＊＊＊第54段程式碼結束/184優化版本 /＊＊＊＊＊
