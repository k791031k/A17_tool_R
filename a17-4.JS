＊＊＊＊＊第23段程式碼開始/17X /＊＊＊＊＊
javascript:(async()=>{const API_URL_UAT='https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',API_URL_PROD='https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query',TOKEN_STORAGE_KEY='euisToken',Z_INDEX_DIALOG=2147483640,Z_INDEX_MAIN_UI=2147483630,Z_INDEX_NOTIFICATION=2147483647;let CURRENT_API_URL='',apiAuthToken=localStorage.getItem(TOKEN_STORAGE_KEY),selectedQueryDefinitionGlobal=null,originalQueryResults=[],baseA17MasterData=[],isEditMode=false,currentTableInstance={sortDirections:{},currentHeaders:[],isA17Mode:false,isCSVImportModeGlobal:false},a17ModeState={isActive:false,selectedUnits:new Set(),sortedData:[]},csvImportState={isImported:false,headers:[],selectedColumn:null,fileName:''};const QUERYABLE_FIELD_DEFINITIONS=[{queryApiKey:'receiptNumber',queryDisplayName:'%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#007bff'},{queryApiKey:'applyNumber',queryDisplayName:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',color:'#6f42c1'},{queryApiKey:'policyNumber',queryDisplayName:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',color:'#28a745'},{queryApiKey:'approvalNumber',queryDisplayName:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',color:'#fd7e14'},{queryApiKey:'insuredId',queryDisplayName:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',color:'#17a2b8'}],ALL_DISPLAY_FIELDS_API_KEYS_MAIN=['applyNumber','policyNumber','approvalNumber','receiptNumber','insuredId','statusCombined','uwApproverUnit','uwApprover','approvalUser'],FIELD_DISPLAY_NAMES_MAP={applyNumber:'%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC',policyNumber:'%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC',approvalNumber:'%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F',receiptNumber:'%E9%80%81%E9%87%91%E5%96%AE',insuredId:'%E8%A2%AB%E4%BF%9D%E4%BA%BA%EF%BC%A9%EF%BC%A4',statusCombined:'%E7%8B%80%E6%85%8B',uwApproverUnit:'%E5%88%86%E5%85%AC%E5%8F%B8',uwApprover:'%E6%A0%B8%E4%BF%9D%E5%93%A1',approvalUser:'%E8%A6%86%E6%A0%B8'},UNIT_MAP_FIELD_API_KEY='uwApproverUnit',UNIT_CODE_MAPPINGS={H:'%E6%A0%B8%E4%BF%9D%E9%83%A8',B:'%E5%8C%97%E4%B8%80',C:'%E5%8F%B0%E4%B8%AD',K:'%E9%AB%98%E9%9B%84',N:'%E5%8F%B0%E5%8D%97',P:'%E5%8C%97%E4%BA%8C',T:'%E6%A1%83%E7%AB%B9',G:'%E4%BF%9D%E4%BD%9C'},A17_UNIT_BUTTONS_DEFS=[{id:'H',label:'H-%E7%B8%BD%E5%85%AC%E5%8F%B8',color:'#007bff'},{id:'B',label:'B-%E5%8C%97%E4%B8%80',color:'#28a745'},{id:'P',label:'P-%E5%8C%97%E4%BA%8C',color:'#ffc107'},{id:'T',label:'T-%E6%A1%83%E7%AB%B9',color:'#17a2b8'},{id:'C',label:'C-%E5%8F%B0%E4%B8%AD',color:'#fd7e14'},{id:'N',label:'N-%E5%8F%B0%E5%8D%97',color:'#6f42c1'},{id:'K',label:'K-%E9%AB%98%E9%9B%84',color:'#e83e8c'},{id:'UNDEF',label:'%E6%9F%A5%E7%84%A1',color:'#546e7a'}],A17_CSV_DISPLAY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B'],A17_API_DATA_DISPLAY_HEADERS=['%E5%8F%97%E7%90%86%E8%99%9F%E7%A2%BC','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E7%A2%BA%E8%AA%8D%E6%9B%B8%E7%B7%A8%E8%99%9F','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1'],A17_COPY_ONLY_HEADERS=['%E9%80%81%E9%87%91%E5%96%AE','%E7%A7%91%E7%9B%AE%E4%BB%A3%E7%A2%BC','%E5%B9%A3%E5%88%A5','%E9%A4%98%E9%A1%8D','%E5%85%A5%E5%B8%B3%E6%97%A5%E6%9C%9F','%E5%85%A5%E5%B8%B3%E4%BA%BA%E5%93%A1','%E4%BF%9D%E5%96%AE%E7%8B%80%E6%85%8B','%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC','%E5%88%86%E5%85%AC%E5%8F%B8','%E6%A0%B8%E4%BF%9D%E5%93%A1','',''],A17_PARA1=%22%E6%82%A8%E5%A5%BD%EF%BC%8C%22,A17_PARA2_TEMPLATE=%22%E4%BE%9D%E6%93%9A%E3%80%90%E7%AE%A1%E7%90%86%E5%A0%B1%E8%A1%A8%EF%BC%9AA17%20%E6%96%B0%E5%A5%91%E7%B4%84%E7%95%B0%E5%B8%B8%E5%B8%B3%E5%8B%99%E3%80%91%E6%89%80%E8%BC%89%E5%85%A7%E5%AE%B9%EF%BC%8C%E6%9C%AC%E9%80%B1%E5%A0%B1%E8%A1%A8%E4%B8%AD%E5%88%97%E7%A4%BA%E4%B9%8B%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%A4%9A%E9%A0%85%E5%B8%B3%E5%8B%99%E7%95%B0%E5%B8%B8%E6%83%85%E5%BD%A2%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%E6%BA%A2%E7%B9%B3%E3%80%81%E7%9F%AD%E6%94%B6%E3%80%81%E5%8F%96%E6%B6%88%E4%BB%B6%E9%9C%80%E9%80%80%E8%B2%BB%E3%80%81%E7%84%A1%E7%9B%B8%E5%B0%8D%E6%87%89%E4%B9%8B%E6%A1%88%E4%BB%B6%E7%AD%89%E5%95%8F%E9%A1%8C%E3%80%82%22,A17_PARA3=%22%E7%B6%93%E9%80%90%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%AF%94%E5%B0%8D%E5%BE%8C%EF%BC%8C%E8%A9%B2%E7%AD%89%E9%80%81%E9%87%91%E5%96%AE%E6%87%89%E5%B0%8D%E6%87%89%E8%87%B3%E4%B8%8B%E8%A1%A8%E6%89%80%E5%88%97%E4%B9%8B%E6%96%B0%E5%A5%91%E7%B4%84%E6%A1%88%E4%BB%B6%EF%BC%8C%E6%95%AC%E8%AB%8B%E5%8D%94%E5%8A%A9%E7%A2%BA%E8%AA%8D%E5%90%84%E6%A1%88%E4%BB%B6%E4%B9%8B%E5%B8%B3%E5%8B%99%E7%8B%80%E6%B3%81%EF%BC%8C%E8%AC%9D%E8%AC%9D%E3%80%82%22;let%20textSettings={content:A17_PARA1+'\n\n'+A17_PARA2_TEMPLATE+'\n\n'+A17_PARA3,fontSize:10.5,lineHeight:1.5};function%20loadTextSettings(){const%20saved=localStorage.getItem('qt_a17_text_settings');if(saved)try{textSettings={...textSettings,...JSON.parse(saved)}}catch(e){}}function%20saveTextSettings(){localStorage.setItem('qt_a17_text_settings',JSON.stringify(textSettings))}function%20escapeHtml(s){return%20s===undefined||s===null?'':String(s).replace(/[&%3C%22']/g,m=%3E({'&':'&','%3C':'<','%22':'
＊＊＊＊＊第23段程式碼結束/17X /＊＊＊＊＊




＊＊＊＊＊第24段程式碼開始/ID /＊＊＊＊＊
javascript:(function(){if(document.getElementById('id-gen-pro')){return}const P={primary:'#0057FF',text:'#212529',bg:'#FFFFFF',panelBg:'#F0F2F5',border:'#DEE2E6',subtleText:'#6C757D',success:'#198754'};const%20CITIES={'A':'%E8%87%BA%E5%8C%97%E5%B8%82','B':'%E8%87%BA%E4%B8%AD%E5%B8%82','C':'%E5%9F%BA%E9%9A%86%E5%B8%82','D':'%E8%87%BA%E5%8D%97%E5%B8%82','E':'%E9%AB%98%E9%9B%84%E5%B8%82','F':'%E6%96%B0%E5%8C%97%E5%B8%82','G':'%E5%AE%9C%E8%98%AD%E7%B8%A3','H':'%E6%A1%83%E5%9C%92%E5%B8%82','I':'%E5%98%89%E7%BE%A9%E5%B8%82','J':'%E6%96%B0%E7%AB%B9%E7%B8%A3','K':'%E8%8B%97%E6%A0%97%E7%B8%A3','L':'%E8%87%BA%E4%B8%AD%E7%B8%A3(%E5%81%9C)','M':'%E5%8D%97%E6%8A%95%E7%B8%A3','N':'%E5%BD%B0%E5%8C%96%E7%B8%A3','O':'%E6%96%B0%E7%AB%B9%E5%B8%82','P':'%E9%9B%B2%E6%9E%97%E7%B8%A3','Q':'%E5%98%89%E7%BE%A9%E7%B8%A3','R':'%E8%87%BA%E5%8D%97%E7%B8%A3(%E5%81%9C)','S':'%E9%AB%98%E9%9B%84%E7%B8%A3(%E5%81%9C)','T':'%E5%B1%8F%E6%9D%B1%E7%B8%A3','U':'%E8%8A%B1%E8%93%AE%E7%B8%A3','V':'%E8%87%BA%E6%9D%B1%E7%B8%A3','W':'%E9%87%91%E9%96%80%E7%B8%A3','X':'%E6%BE%8E%E6%B9%96%E7%B8%A3','Y':'%E9%99%BD%E6%98%8E%E5%B1%B1(%E5%81%9C)','Z':'%E9%80%A3%E6%B1%9F%E7%B8%A3'};const%20CITY_CODES={'A':10,'B':11,'C':12,'D':13,'E':14,'F':15,'G':16,'H':17,'I':34,'J':18,'K':19,'L':20,'M':21,'N':22,'O':35,'P':23,'Q':24,'R':25,'S':26,'T':27,'U':28,'V':29,'W':32,'X':30,'Y':31,'Z':33};function%20generate(city,gender){let%20s='';for(let%20i=0;i%3C7;i++){s+=Math.floor(Math.random()*10)}const%20code=CITY_CODES[city].toString();const%20d1=parseInt(code[0]||code);const%20d2=parseInt(code[1]||0);const%20body=[d1,d2,parseInt(gender),...s.split('').map(Number)];const%20weights=[1,9,8,7,6,5,4,3,2,1];let%20sum=0;for(let%20i=0;i%3Cbody.length;i++){sum+=body[i]*weights[i]}const%20chk=(10-(sum%10))%10;return%20city+gender.toString()+s+chk.toString()}const%20card=document.createElement('div');card.id='id-gen-pro';card.style.cssText=%60%20%20%20%20%20%20%20%20position:%20fixed;%20%20%20%20%20%20%20%20top:%2050%;%20%20%20%20%20%20%20%20left:%2050%;%20%20%20%20%20%20%20%20transform:%20translate(-50%,%20-50%);%20%20%20%20%20%20%20%20background:%20${P.bg};%20%20%20%20%20%20%20%20color:%20${P.text};%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20box-shadow:%200%208px%2020px%20rgba(0,0,0,0.15);%20%20%20%20%20%20%20%20font-family:%20-apple-system,%20BlinkMacSystemFont,%20%22Segoe%20UI%22,%20Roboto,%20%22Helvetica%20Neue%22,%20Arial,%20sans-serif;%20%20%20%20%20%20%20%20width:%20400px;%20%20%20%20%20%20%20%20min-width:%20300px;%20%20%20%20%20%20%20%20max-width:%2095vw;%20%20%20%20%20%20%20%20font-size:%2013px;%20%20%20%20%20%20%20%20line-height:%201.4;%20%20%20%20%20%20%20%20box-sizing:%20border-box;%20%20%20%20%20%20%20%20z-index:%202147483647;%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%60;const%20header=document.createElement('div');header.style.cssText=%60%20%20%20%20%20%20%20%20padding:%208px%2016px;%20%20%20%20%20%20%20%20cursor:%20move;%20%20%20%20%20%20%20%20position:%20relative;%20%20%20%20%20%20%20%20border-bottom:%201px%20solid%20${P.border};%20%20%20%20%60;const%20title=document.createElement('h2');title.textContent='ID%20%E7%94%A2%E7%94%9F%E5%99%A8';title.style.cssText=%60%20%20%20%20%20%20%20%20margin:%200;%20%20%20%20%20%20%20%20color:%20${P.text};%20%20%20%20%20%20%20%20text-align:%20center;%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20font-weight:%20600;%20%20%20%20%60;const%20closeBtn=document.createElement('span');closeBtn.innerHTML='×';closeBtn.style.cssText=%60%20%20%20%20%20%20%20%20position:%20absolute;%20%20%20%20%20%20%20%20top:%2050%;%20%20%20%20%20%20%20%20right:%2012px;%20%20%20%20%20%20%20%20transform:%20translateY(-50%);%20%20%20%20%20%20%20%20font-size:%2020px;%20%20%20%20%20%20%20%20color:%20${P.subtleText};%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20font-weight:%20300;%20%20%20%20%20%20%20%20line-height:%201;%20%20%20%20%20%20%20%20transition:%20color%20.2s;%20%20%20%20%60;const%20content=document.createElement('div');content.style.cssText=%60%20%20%20%20%20%20%20%20padding:%2012px;%20%20%20%20%20%20%20%20flex-grow:%201;%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%60;const%20formContainer=document.createElement('div');formContainer.style.cssText=%60%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20align-items:%20end;%20%20%20%20%20%20%20%20gap:%2010px;%20%20%20%20%20%20%20%20margin-bottom:%208px;%20%20%20%20%60;const%20createField=(label,input)=%3E{const%20field=document.createElement('div');field.style.cssText='flex:%201;';const%20l=document.createElement('label');l.textContent=label;l.style.cssText=%60%20%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%203px;%20%20%20%20%20%20%20%20%20%20%20%20font-weight:%20500;%20%20%20%20%20%20%20%20%20%20%20%20color:%20${P.subtleText};%20%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%60;input.style.cssText=%60%20%20%20%20%20%20%20%20%20%20%20%20width:%20100%;%20%20%20%20%20%20%20%20%20%20%20%20padding:%206px%208px;%20%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${P.border};%20%20%20%20%20%20%20%20%20%20%20%20border-radius:%206px;%20%20%20%20%20%20%20%20%20%20%20%20font-size:%2013px;%20%20%20%20%20%20%20%20%20%20%20%20background:%20${P.bg};%20%20%20%20%20%20%20%20%20%20%20%20box-sizing:%20border-box;%20%20%20%20%20%20%20%20%60;field.appendChild(l);field.appendChild(input);return%20field};const%20citySel=document.createElement('select');Object.keys(CITIES).sort().forEach(L=%3E{citySel.add(new%20Option(%60${L}%20|%20${CITIES[L]}%60,L))});const%20genderSel=document.createElement('select');genderSel.add(new%20Option('%E9%9A%A8%E6%A9%9F','random'));genderSel.add(new%20Option('%E7%94%B7%20(1)','1'));genderSel.add(new%20Option('%E5%A5%B3%20(2)','2'));const%20countIn=document.createElement('input');countIn.type='number';countIn.value='6';countIn.min='1';countIn.max='99';const%20genBtn=document.createElement('button');genBtn.textContent='%E7%94%A2%E7%94%9FID';genBtn.style.cssText=%60%20%20%20%20%20%20%20%20padding:%208px%2016px;%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20border-radius:%206px;%20%20%20%20%20%20%20%20background:%20${P.primary};%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20font-size:%2013px;%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20height:%20fit-content;%20%20%20%20%20%20%20%20white-space:%20nowrap;%20%20%20%20%60;const%20resultsGrid=document.createElement('div');resultsGrid.style.cssText=%60%20%20%20%20%20%20%20%20display:%20grid;%20%20%20%20%20%20%20%20grid-template-columns:%20repeat(3,%201fr);%20%20%20%20%20%20%20%20gap:%206px;%20%20%20%20%20%20%20%20margin-top:%208px;%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20background:%20${P.panelBg};%20%20%20%20%20%20%20%20border-radius:%206px;%20%20%20%20%20%20%20%20min-height:%2080px;%20%20%20%20%20%20%20%20max-height:%20250px;%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%60;const%20resizeHandle=document.createElement('div');resizeHandle.style.cssText=%60%20%20%20%20%20%20%20%20position:%20absolute;%20%20%20%20%20%20%20%20right:%200;%20%20%20%20%20%20%20%20bottom:%200;%20%20%20%20%20%20%20%20width:%2012px;%20%20%20%20%20%20%20%20height:%2012px;%20%20%20%20%20%20%20%20cursor:%20se-resize;%20%20%20%20%60;header.appendChild(title);header.appendChild(closeBtn);formContainer.appendChild(createField('%E7%B8%A3%E5%B8%82',citySel));formContainer.appendChild(createField('%E6%80%A7%E5%88%A5',genderSel));formContainer.appendChild(createField('%E7%94%A2%E7%94%9F%E7%B5%84%E6%95%B8',countIn));formContainer.appendChild(genBtn);content.appendChild(formContainer);content.appendChild(resultsGrid);card.appendChild(header);card.appendChild(content);card.appendChild(resizeHandle);document.body.appendChild(card);genBtn.addEventListener('click',()=%3E{resultsGrid.innerHTML='';const%20city=citySel.value;const%20genderOpt=genderSel.value;const%20count=parseInt(countIn.value,10)||6;const%20ids=[];for(let%20i=0;i%3Ccount;i++){let%20g=genderOpt==='random'?Math.floor(Math.random()*2)+1:parseInt(genderOpt);const%20id=generate(city,g);ids.push(id)}ids.sort((a,b)=%3Ea.localeCompare(b));ids.forEach(id=%3E{const%20idBox=document.createElement('div');idBox.textContent=id;idBox.style.cssText=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background:%20${P.bg};%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${P.border};%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text-align:%20center;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transition:%20all%20.2s%20ease;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20%20%60;idBox.addEventListener('click',()=%3E{navigator.clipboard.writeText(id).then(()=%3E{const%20originalText=idBox.textContent;const%20originalBg=idBox.style.backgroundColor;idBox.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD!';idBox.style.background=P.success;idBox.style.color='#fff';setTimeout(()=%3E{idBox.textContent=originalText;idBox.style.background=originalBg;idBox.style.color=P.text},1500)})});resultsGrid.appendChild(idBox)})});let%20isDragging=!1,isResizing=!1;let%20offsetX,offsetY,startWidth,startHeight;header.addEventListener('mousedown',e=%3E{if(e.target!==closeBtn){isDragging=!0;offsetX=e.clientX-card.offsetLeft;offsetY=e.clientY-card.offsetTop;card.style.userSelect='none'}});resizeHandle.addEventListener('mousedown',e=%3E{isResizing=!0;startWidth=card.offsetWidth;startHeight=card.offsetHeight;offsetX=e.clientX;offsetY=e.clientY;card.style.userSelect='none'});document.addEventListener('mousemove',e=%3E{if(isDragging){card.style.left=%60${e.clientX%20-%20offsetX}px%60;card.style.top=%60${e.clientY%20-%20offsetY}px%60}if(isResizing){const%20newWidth=startWidth+(e.clientX-offsetX);const%20newHeight=startHeight+(e.clientY-offsetY);card.style.width=%60${newWidth}px%60;card.style.height=%60${newHeight}px%60}});document.addEventListener('mouseup',()=%3E{isDragging=!1;isResizing=!1;card.style.userSelect='auto'});closeBtn.addEventListener('click',()=%3E{document.body.removeChild(card)})})()
＊＊＊＊＊第24段程式碼結束/ID /＊＊＊＊＊




＊＊＊＊＊第25段程式碼開始/A17正式 /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),loadSheetJS=()=>new Promise((r,o)=>{if(window.XLSX)return r();const s=document.createElement('script');s.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';s.onload=r;s.onerror=o;document.body.appendChild(s);});await loadSheetJS();const token=localStorage.getItem('euisToken');if(!token)return void alert('%E6%89%BE%E4%B8%8D%E5%88%B0token%EF%BC%8C%E8%AB%8B%E5%85%88%E7%99%BB%E5%85%A5%E7%B3%BB%E7%B5%B1%EF%BC%81');const input=prompt('%E8%BC%B8%E5%85%A5%E5%96%AE%E8%99%9F%EF%BC%88%E9%80%97%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89%EF%BC%9A');if(!input)return;const numbers=input.split(/\n|,/).map(x=>x.trim()).filter(Boolean),fields=[
＊＊＊＊＊第25段程式碼結束/A17正式 /＊＊＊＊＊




＊＊＊＊＊第26段程式碼開始/174yahoo /＊＊＊＊＊
javascript:(function()%7Basync%20function%20queryData(e)%7Bconst%20t=%22https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query%22;let%20n=document.createElement(%22div%22);n.style.cssText=%22position:fixed;top:10px;left:10px;background:white;padding:10px;border:1px%20solid%20black;z-index:10000;width:600px;font-size:14px%22;const%20a=%5B%22mainStatus%22,%22applyNumber%22,%22policyNumber%22,%22insured%22%5D,o=%7BmainStatus:%22%E7%8B%80%E6%85%8B%22,applyNumber:%22%E7%94%B3%E8%AB%8B%E8%99%9F%E7%A2%BC%22,policyNumber:%22%E4%BF%9D%E5%96%AE%E8%99%9F%E7%A2%BC%22,insured:%22%E8%A2%AB%E4%BF%9D%E9%9A%AA%E4%BA%BA%22%7D;let%20i='%3Ctable%20border=%221%22%20style=%22border-collapse:collapse;width:100%25%22%3E%3Ctr%3E'+a.map(e=%3E%60%3Cth%20style=%22padding:3px%22%3E$%7Bo%5Be%5D%7D%3C/th%3E%60).join(%22%22)+%22%3C/tr%3E%22;for(let%20n%20of%20e)try%7Bconst%20e=await%20fetch(t,%7Bmethod:%22POST%22,headers:%7B%22Content-Type%22:%22application/json%22,Accept:%22application/json,%20text/plain,%20*/*%22%7D,body:JSON.stringify(%7Breciptnumber:n%7D)%7D),o=await%20e.json();o.records&&o.records.length%3E0&&o.records.forEach(e=%3E%7Bi+=%22%3Ctr%3E%22+a.map(t=%3E%60%3Ctd%20style=%22padding:3px%22%3E$%7Be%5Bt%5D%7C%7C%22%22%7D%3C/td%3E%60).join(%22%22)+%22%3C/tr%3E%22%7D)%7Dcatch(e)%7Bconsole.error(%60Error:%20$%7Bn%7D%60,e)%7Di+=%22%3C/table%3E%22,n.innerHTML=i;const%20r=document.createElement(%22button%22);r.innerHTML=%22%E9%97%9C%E9%96%89%22,r.style.cssText=%22margin-top:5px;padding:3px%2010px%22,r.onclick=()=%3En.remove(),n.appendChild(r),document.body.appendChild(n)%7Dconst%20input=prompt(%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E9%80%81%E9%87%91%E5%96%AE%E8%99%9F%E7%A2%BC%EF%BC%88%E7%94%A8%E9%80%97%E8%99%9F%E5%88%86%E9%9A%94%EF%BC%89%22);input&&queryData(input.split(%22,%22).map(e=%3Ee.trim()))%7D)();
＊＊＊＊＊第26段程式碼結束/174yahoo /＊＊＊＊＊




＊＊＊＊＊第27段程式碼開始/175白名單 /＊＊＊＊＊
javascript:(function(){var e=document.getElementById('url-generator-bookmarklet');if(e)document.body.removeChild(e);var t=document.createElement('div');t.id='url-generator-bookmarklet',t.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:999999;overflow:auto;';var n=document.createElement('div');n.style.cssText='margin:20px auto;background:#fff;padding:20px;width:90%;max-width:500px;';var%20o=document.createElement('button');o.textContent='%E9%97%9C%E9%96%89',o.onclick=function(){document.body.removeChild(t)};n.innerHTML=%60%3Ch1%3EURL%E7%94%9F%E6%88%90%E5%99%A8%3C/h1%3E%3Clabel%3E%E6%89%8B%E6%A9%9F:%3Cinput%20type=%22text%22%20id=%22userPhone%22%20placeholder=%22%E6%89%8B%E6%A9%9F%E8%99%9F%E7%A2%BC%22%3E%3C/label%3E%3Clabel%3EEMAIL:%3Cinput%20type=%22text%22%20id=%22userEmail%22%20placeholder=%22%E9%9B%BB%E5%AD%90%E9%83%B5%E4%BB%B6%22%3E%3C/label%3E%3Ch2%3E%E6%B8%AC%E8%A9%A6%E8%B3%87%E6%96%99%3C/h2%3E%3Clabel%3E%E8%A1%8C%E6%95%B8:%3Cinput%20type=%22number%22%20id=%22rowCountInput%22%20value=%221%22%20min=%221%22%3E%3C/label%3E%3Cbutton%20id=%22generateRowsBtn%22%3E%E7%94%9F%E6%88%90%E8%A1%8C%3C/button%3E%3Ctable%20id=%22testDataTable%22%3E%3Cthead%3E%3Ctr%3E%3Cth%3E%E5%A7%93%E5%90%8D%3C/th%3E%3Cth%3EID%3C/th%3E%3Cth%3E%E6%93%8D%E4%BD%9C%3C/th%3E%3C/tr%3E%3C/thead%3E%3Ctbody%3E%3C/tbody%3E%3C/table%3E%3Cbutton%20id=%22generateUrlBtn%22%3E%E7%94%9F%E6%88%90URL%3C/button%3E%3Cdiv%20id=%22resultContainer%22%3E%3C/div%3E%60;n.appendChild(o),t.appendChild(n),document.body.appendChild(t),document.getElementById('generateRowsBtn').onclick=function(){const%20e=parseInt(document.getElementById('rowCountInput').value,10)||1,t=document.querySelector('#testDataTable%20tbody');t.innerHTML='',Array.from({length:e}).forEach(()=%3EaddNewRow())},function%20addNewRow(){const%20e=document.querySelector('#testDataTable%20tbody'),t=e.insertRow();t.innerHTML=%60%3Ctd%3E%3Cinput%20placeholder=%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E5%A7%93%E5%90%8D%22%3E%3C/td%3E%3Ctd%3E%3Cinput%20placeholder=%22%E8%AB%8B%E8%BC%B8%E5%85%A5ID%22%3E%3C/td%3E%3Ctd%3E%3Cbutton%20onclick=%22this.closest('tr').remove()%22%3E%E5%88%AA%E9%99%A4%3C/button%3E%3C/td%3E%60},document.getElementById('generateUrlBtn').onclick=function(){const%20e=document.getElementById('userPhone').value.trim(),t=document.getElementById('userEmail').value.trim(),n=document.querySelector('#testDataTable%20tbody'),o=document.getElementById('resultContainer');o.innerHTML='',Array.from(n.rows).forEach(function(n){const%20r=n.cells[0].querySelector('input').value.trim(),s=n.cells[1].querySelector('input').value.trim();if(r&&s){const%20n=generateUrl(t,e,s,'phone'),c=generateUrl(t,e,s,'email');o.innerHTML+=%60%3Cdiv%3E%3Ca%20href=%22${n}%22%20onclick=%22copyToClipboard('${n}')%22%3E%E6%89%8B%E6%A9%9FURL%3C/a%3E%3Ca%20href=%22${c}%22%20onclick=%22copyToClipboard('${c}')%22%3EEMAIL%20URL%3C/a%3E%3C/div%3E%60}})},function%20generateUrl(t,e,n,o){const%20r=o==='phone'?'0':'3';return%60https://example.com?email=${encodeURIComponent(t)}&phone=${encodeURIComponent(e)}&id=${encodeURIComponent(n)}&type=${r}%60},window.copyToClipboard=function(t){const%20e=document.createElement('input');e.value=t,document.body.appendChild(e),e.select(),document.execCommand('copy'),document.body.removeChild(e),alert('%E5%B7%B2%E8%A4%87%E8%A3%BD%E5%88%B0%E5%89%AA%E8%B2%BC%E7%B0%BF:%20'+t)}})();
＊＊＊＊＊第27段程式碼結束/175白名單 /＊＊＊＊＊




＊＊＊＊＊第28段程式碼開始/176UAT /＊＊＊＊＊
javascript:(async()=>{const sleep=t=>new Promise(r=>setTimeout(r,t)),loadScript=(src)=>new Promise((r,o)=>{const s=document.createElement('script');s.src=src;s.onload=r;s.onerror=o;document.body.appendChild(s);});await loadScript('https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js');const findToken=()=>{const url=new URL(location.href);return localStorage.getItem('euisToken')||url.searchParams.get('code')||prompt('%E6%89%BE%E4%B8%8D%E5%88%B0Token%EF%BC%8C%E8%AB%8B%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5');},token=findToken();if(!token)return alert('%E2%9D%8C %E6%89%BE%E4%B8%8D%E5%88%B0token%EF%BC%81%E8%AB%8B%E7%99%BB%E5%85%A5%E7%B3%BB%E7%B5%B1%E6%88%96%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5');const defaultAPI='https://euis-uat.apps.tocp4.kgilife.com.tw/euisw/euisb/api/caseQuery/query';let apiURL=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2API%E7%B6%B2%E5%9D%80%EF%BC%9A',defaultAPI)||defaultAPI;const input=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%E5%96%AE%E8%99%9F%EF%BC%88%E9%80%97%E8%99%9F%E6%88%96%E6%8F%9B%E8%A1%8C%E5%88%86%E9%9A%94%EF%BC%89%EF%BC%9A');if(!input)return alert('%E2%9A%A0%EF%B8%8F %E6%B2%92%E6%9C%89%E8%BC%B8%E5%85%A5%E4%BB%BB%E4%BD%95%E5%96%AE%E8%99%9F');const numbers=input.split(/\n|,/).map(x=>x.trim()).filter(Boolean),fields=[
＊＊＊＊＊第28段程式碼結束/176UAT /＊＊＊＊＊




＊＊＊＊＊第29段程式碼開始/179查詢a pi2 /＊＊＊＊＊
javascript:(function(){let apiInfo={endpoints:[],tokens:[],page:window.location.href,title:document.title,timestamp:new Date().toISOString()};const initUI=()=>{const existingContainer=document.getElementById('api-analyzer-container');if(existingContainer)existingContainer.remove();const container=document.createElement('div');container.id='api-analyzer-container';container.style.cssText='position:fixed;top:20px;right:20px;width:380px;max-height:80vh;background-color:#fff;border-radius:8px;box-shadow:0%200%2020px%20rgba(0,0,0,0.3);z-index:9999999;font-family:Arial,sans-serif;overflow:hidden;display:flex;flex-direction:column;';const%20header=document.createElement('div');header.style.cssText='display:flex;justify-content:space-between;align-items:center;padding:10px%2015px;background-color:#4a6cf7;color:white;font-weight:bold;cursor:move;user-select:none;';header.innerHTML='API%20%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7';const%20closeButton=document.createElement('button');closeButton.innerHTML='%E2%9C%95';closeButton.style.cssText='background:none;border:none;color:white;font-size:16px;cursor:pointer;padding:0%205px;';closeButton.onclick=()=%3Econtainer.remove();header.appendChild(closeButton);container.appendChild(header);const%20content=document.createElement('div');content.style.cssText='padding:15px;overflow-y:auto;flex-grow:1;max-height:calc(80vh%20-%2060px);';const%20actionArea=document.createElement('div');actionArea.style.cssText='display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;';const%20analyzeButton=createButton('%E5%88%86%E6%9E%90%E9%A0%81%E9%9D%A2API',analyzePageAPIs);const%20downloadButton=createButton('%E4%B8%8B%E8%BC%89%E9%81%B8%E5%8F%96API',downloadSelectedAPIs);actionArea.appendChild(analyzeButton);actionArea.appendChild(downloadButton);content.appendChild(actionArea);const%20resultArea=document.createElement('div');resultArea.id='api-analyzer-results';resultArea.style.cssText='width:100%;min-height:100px;max-height:400px;overflow-y:auto;border:1px%20solid%20#ddd;border-radius:5px;padding:10px;font-family:monospace;font-size:12px;margin-bottom:15px;white-space:pre-wrap;word-break:break-all;';content.appendChild(resultArea);container.appendChild(content);document.body.appendChild(container);makeDraggable(container,header);};const%20createButton=(text,onClick)=%3E{const%20btn=document.createElement('button');btn.innerText=text;btn.style.cssText='padding:6px%2012px;background-color:#4a6cf7;color:white;border:none;border-radius:4px;cursor:pointer;font-size:12px;';btn.onclick=onClick;return%20btn;};const%20makeDraggable=(element,handle)=%3E{let%20pos1=0,pos2=0,pos3=0,pos4=0;handle.onmousedown=(e)=%3E{e.preventDefault();pos3=e.clientX;pos4=e.clientY;document.onmouseup=closeDragElement;document.onmousemove=elementDrag;};const%20elementDrag=(e)=%3E{e.preventDefault();pos1=pos3-e.clientX;pos2=pos4-e.clientY;pos3=e.clientX;pos4=e.clientY;element.style.top=(element.offsetTop-pos2)+'px';element.style.left=(element.offsetLeft-pos1)+'px';};const%20closeDragElement=()=%3E{document.onmouseup=null;document.onmousemove=null;};};const%20analyzePageAPIs=()=%3E{apiInfo.endpoints=[];const%20originalXHROpen=XMLHttpRequest.prototype.open;const%20originalXHRSend=XMLHttpRequest.prototype.send;const%20originalFetch=window.fetch;XMLHttpRequest.prototype.open=function(method,url){this._method=method;this._url=url;return%20originalXHROpen.apply(this,arguments);};XMLHttpRequest.prototype.send=function(data){const%20xhr=this;xhr._requestData=data;xhr.addEventListener('load',function(){collectEndpoint(xhr._method,xhr._url,xhr._requestData,xhr.status,xhr.getAllResponseHeaders(),xhr.responseText);});return%20originalXHRSend.apply(this,arguments);};window.fetch=async%20function(input,init){const%20url=typeof%20input==='string'?input:input.url;const%20method=init&&init.method||'GET';const%20requestData=init&&init.body;const%20response=await%20originalFetch.apply(this,arguments);collectEndpoint(method,url,requestData,response.status,await%20response.headers,await%20response.clone().text());return%20response;};updateResults();};const%20collectEndpoint=(method,url,requestData,status,headers,responseText)=%3E{apiInfo.endpoints.push({method,url,requestData,status,headers,responseText});updateResults();};const%20updateResults=()=%3E{const%20resultArea=document.getElementById('api-analyzer-results');resultArea.innerHTML='';apiInfo.endpoints.forEach((endpoint,index)=%3E{const%20div=document.createElement('div');const%20checkbox=document.createElement('input');checkbox.type='checkbox';checkbox.id=%60api-${index}%60;checkbox.checked=true;const%20label=document.createElement('label');label.htmlFor=%60api-${index}%60;label.innerText=%60${endpoint.method}%20${endpoint.url}%60;div.appendChild(checkbox);div.appendChild(label);resultArea.appendChild(div);});};const%20downloadSelectedAPIs=()=%3E{let%20content='Method,URL,Status\n';apiInfo.endpoints.forEach((endpoint,index)=%3E{const%20checkbox=document.getElementById(%60api-${index}%60);if(checkbox&&checkbox.checked){content+=%60${endpoint.method},${endpoint.url},${endpoint.status}\n%60;}});const%20blob=new%20Blob([content],{type:'text/csv'});const%20link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download=%60selected-api-analysis-${new%20Date().toISOString().slice(0,10)}.csv%60;document.body.appendChild(link);link.click();document.body.removeChild(link);};initUI();})();
＊＊＊＊＊第29段程式碼結束/179查詢a pi2 /＊＊＊＊＊
