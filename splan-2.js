＊＊＊＊＊第46段程式碼開始/90PLANNEW /＊＊＊＊＊
javascript:(async function(){'use strict';const STYLE_ID='planCodeBookmarkletStyle';if(!document.getElementById(STYLE_ID)){const style=document.createElement('style');style.id=STYLE_ID;style.innerHTML=`      .pct-modal-mask { position:fixed;z-index:99999;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.18);}      .pct-modal { font-family:Arial,sans-serif; background:#fff;%20border-radius:10px;%20box-shadow:0%204px%2024px%20#0002;%20padding:0;%20min-width:410px;%20max-width:98vw;%20position:fixed;%20top:60px;%20left:50%;%20transform:translateX(-50%);%20z-index:100000;}%20%20%20%20%20%20.pct-modal-header%20{%20padding:16px%2020px%208px%2020px;%20font-size:20px;%20font-weight:bold;%20border-bottom:1px%20solid%20#eee;%20cursor:move;%20user-select:none;}%20%20%20%20%20%20.pct-modal-body%20{%20padding:16px%2020px%208px%2020px;}%20%20%20%20%20%20.pct-modal-footer%20{%20padding:12px%2020px%2016px%2020px;%20text-align:right;%20border-top:1px%20solid%20#eee;}%20%20%20%20%20%20.pct-btn%20{%20display:inline-block;%20margin:0%206px%200%200;%20padding:7px%2018px;%20font-size:15px;%20border-radius:6px;%20border:none;%20background:#1967d2;%20color:#fff;%20cursor:pointer;%20transition:background%20.2s;}%20%20%20%20%20%20.pct-btn:hover%20{%20background:#1250a6;}%20%20%20%20%20%20.pct-btn-secondary%20{%20background:#e0e0e0;%20color:#333;}%20%20%20%20%20%20.pct-btn-secondary:hover%20{%20background:#bdbdbd;}%20%20%20%20%20%20.pct-btn-danger%20{%20background:#e53935;%20color:#fff;}%20%20%20%20%20%20.pct-btn-danger:hover%20{%20background:#b71c1c;}%20%20%20%20%20%20.pct-btn-cancel%20{%20background:#fd7e14;%20color:#fff;}%20%20%20%20%20%20.pct-btn-cancel:hover%20{%20background:#c66900;}%20%20%20%20%20%20.pct-input%20{%20width:100%;%20font-size:16px;%20padding:7px%2012px;%20border-radius:5px;%20border:1px%20solid%20#bbb;%20box-sizing:border-box;}%20%20%20%20%20%20.pct-input:disabled%20{%20background:#f5f5f5;%20color:#aaa;}%20%20%20%20%20%20.pct-error%20{%20color:#e53935;%20font-size:14px;%20margin:8px%200%200%200;}%20%20%20%20%20%20.pct-table-wrap%20{%20max-height:70vh;%20overflow:auto;%20margin:10px%200;}%20%20%20%20%20%20.pct-table%20{%20border-collapse:collapse;%20width:100%;%20font-size:15px;}%20%20%20%20%20%20.pct-table%20th,%20.pct-table%20td%20{%20border:1px%20solid%20#ddd;%20padding:7px%208px;%20text-align:left;}%20%20%20%20%20%20.pct-table%20th%20{%20background:#343a40;%20color:#fff;%20cursor:pointer;%20position:sticky;%20top:0;%20z-index:1;}%20%20%20%20%20%20.pct-table%20th:hover%20{%20background:#495057;}%20%20%20%20%20%20.pct-table%20tr.special-row%20{%20background:#fffde7;}%20%20%20%20%20%20.pct-table%20tr:hover%20{%20background:#e3f2fd;}%20%20%20%20%20%20.pct-status-onsale%20{%20color:#1976d2;%20font-weight:bold;}%20%20%20%20%20%20.pct-status-offsale%20{%20color:#e53935;}%20%20%20%20%20%20.pct-status-special%20{%20background:#fffde7;}%20%20%20%20%20%20.pct-toast%20{%20position:fixed;%20left:50%;%20top:30px;%20transform:translateX(-50%);%20background:#323232;%20color:#fff;%20padding:10px%2022px;%20border-radius:8px;%20font-size:16px;%20z-index:100001;%20opacity:0;%20pointer-events:none;%20transition:opacity%20.3s;}%20%20%20%20%20%20.pct-toast.pct-toast-show%20{%20opacity:1;%20pointer-events:auto;}%20%20%20%20%20%20.pct-summary%20{%20font-size:15px;%20margin-bottom:10px;%20}%20%20%20%20%20%20.pct-filter-btn%20{%20font-size:14px;%20padding:4px%2012px;%20background:#fffde7;%20color:#a67c00;%20border:1px%20solid%20#ffe082;%20border-radius:5px;%20margin-left:8px;%20cursor:pointer;}%20%20%20%20%20%20.pct-filter-btn:hover%20{%20background:#ffe082;}%20%20%20%20%20%20.pct-filter-group%20{%20margin:0%208px;%20display:inline-block;}%20%20%20%20%20%20.pct-filter-btn.active%20{%20background:#007bff;%20color:#fff;%20border-color:#007bff;%20font-weight:bold;}%20%20%20%20%20%20.pct-table%20td.copyable%20{%20cursor:pointer;%20transition:background%200.2s;}%20%20%20%20%20%20.pct-table%20td.copyable:hover%20{%20background:#e3f2fd;}%20%20%20%20%60;document.head.appendChild(style)}const%20State={env:detectEnv(),apiBase:'',token:'',tokenCheckEnabled:!0,allData:[],pageNo:1,pageSize:50,totalRecords:0,filterSpecial:!1,sortKey:'',sortAsc:!0,cacheDetail:new%20Map(),cacheChannel:new%20Map(),filters:{},isShowingAll:!1,queryMode:'planCode',queryInput:'',apiAbortController:null,modalDrag:{dragging:!1,offsetX:0,offsetY:0}};function%20detectEnv(){const%20host=window.location.host.toLowerCase();if(host.includes('uat')||host.includes('test'))return'UAT';return'PROD'}function%20envLabel(){return%20State.env==='PROD'?'%E6%AD%A3%E5%BC%8F':'%E6%B8%AC%E8%A9%A6'}function%20formatToday(){const%20d=new%20Date();return%20%60${d.getFullYear()}${('0'%20+%20(d.getMonth()%20+%201)).slice(-2)}${('0'%20+%20d.getDate()).slice(-2)}%60}function%20formatDate(dt){if(!dt)return'';return%20dt.replace(/[-%20:]/g,'').slice(0,8)}function%20getSaleStatus(today,saleStart,saleEnd){if(!saleStart||!saleEnd)return'';if(saleEnd==='99991231'||saleEnd==='9999-12-31'||saleEnd==='9999-12-31%2000:00:00')return'%E7%8F%BE%E5%94%AE%E4%B8%AD';const%20t=Number(today),s=Number(formatDate(saleStart)),e=Number(formatDate(saleEnd));if(t%3Ee)return'%E5%81%9C%E5%94%AE';if(t%3E=s&&t%3C=e)return'%E7%8F%BE%E5%94%AE%E4%B8%AD';return'%E6%9C%AA%E9%96%8B%E5%A7%8B'}function%20currencyConvert(val){if(val===1||val==='1')return'TWD';if(val===2||val==='2')return'USD';return%20val||''}function%20unitConvert(val){if(!val)return'';if(val==='A1')return'%E5%85%83';if(val==='A4')return'%E8%90%AC%E5%85%83';return%20val}function%20coverageTypeConvert(val){if(val==='M')return'%E4%B8%BB%E7%B4%84';if(val==='R')return'%E9%99%84%E7%B4%84';return%20val||''}function%20channelCodeConvert(code){if(!code)return'';return%20code==='OT'?'BK':code}function%20toHalfWidth(str){if(typeof%20str!==%22string%22)return%20str;return%20str.replace(/[\uff01-\uff5e]/g,(char)=%3EString.fromCharCode(char.charCodeAt(0)-0xfee0)).replace(/\u3000/g,%22%20%22)}const%20Api={async%20call(endpoint,params,signal){const%20url=%60${State.apiBase}${endpoint}%60;const%20headers={'Content-Type':'application/json','SSO-TOKEN':State.token};const%20res=await%20fetch(url,{method:'POST',headers,body:JSON.stringify(params),signal});if(!res.ok)throw%20new%20Error(%60API%20%E8%AB%8B%E6%B1%82%E5%A4%B1%E6%95%97%20(${res.status})%60);return%20res.json()},async%20verifyToken(token){try{const%20testApi='/planCodeController/query';const%20url=%60${State.apiBase}${testApi}%60;const%20headers={'Content-Type':'application/json','SSO-TOKEN':token};const%20res=await%20fetch(url,{method:'POST',headers,body:JSON.stringify({planCode:'5105',pageNo:1,pageSize:1})});const%20data=await%20res.json();return!!data.records}catch{return!1}}};let%20pctModal=null;function%20showModal({title,body,footer,onOpen}){closeModal();const%20mask=document.createElement('div');mask.className='pct-modal-mask';const%20modal=document.createElement('div');modal.className='pct-modal';modal.innerHTML=%60%20%20%20%20%20%20%3Cdiv%20class=%22pct-modal-header%22%20id=%22pct-modal-header%22%3E${title}%3C/div%3E%20%20%20%20%20%20%3Cdiv%20class=%22pct-modal-body%22%3E${body}%3C/div%3E%20%20%20%20%20%20%3Cdiv%20class=%22pct-modal-footer%22%3E${footer%20||%20''}%3C/div%3E%20%20%20%20%60;document.body.appendChild(mask);document.body.appendChild(modal);pctModal={mask,modal};const%20header=modal.querySelector('.pct-modal-header');if(header){header.onmousedown=function(e){State.modalDrag.dragging=!0;State.modalDrag.offsetX=e.clientX-modal.offsetLeft;State.modalDrag.offsetY=e.clientY-modal.offsetTop;document.onmousemove=function(e2){if(!State.modalDrag.dragging)return;modal.style.left=(e2.clientX-State.modalDrag.offsetX)+'px';modal.style.top=(e2.clientY-State.modalDrag.offsetY)+'px';modal.style.transform=''};document.onmouseup=function(){State.modalDrag.dragging=!1;document.onmousemove=null;document.onmouseup=null}}}if(onOpen)setTimeout(onOpen,10);}function%20closeModal(){if(pctModal){pctModal.mask.remove();pctModal.modal.remove();pctModal=null}}function%20showToast(msg,type='info'){let%20el=document.getElementById('pct-toast');if(!el){el=document.createElement('div');el.id='pct-toast';el.className='pct-toast';document.body.appendChild(el)}el.textContent=msg;el.classList.add('pct-toast-show');setTimeout(()=%3Eel.classList.remove('pct-toast-show'),1800)}function%20showError(msg){const%20el=document.getElementById('pct-error');if(el){el.textContent=msg;el.style.display=''}else{showToast(msg,'error')}}function%20modeLabel(mode){switch(mode){case%20'planCode':return'%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F';case%20'planCodeName':return'%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1%E9%97%9C%E9%8D%B5%E5%AD%97';case%20'allPlans':return'%E6%9F%A5%E5%85%A8%E9%83%A8';case%20'inSale':return'%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81';default:return%20mode}}async%20function%20main(){State.apiBase=State.env==='PROD'?'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api':'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api';State.token=localStorage.getItem('SSO-TOKEN')||'';State.tokenCheckEnabled=!0;State.allData=[];State.pageNo=1;State.filterSpecial=!1;State.sortKey='';State.sortAsc=!0;State.cacheDetail.clear();State.cacheChannel.clear();State.filters={};State.isShowingAll=!1;await%20showTokenDialog()}async%20function%20showTokenDialog(){return%20new%20Promise((resolve)=%3E{showModal({title:%60%E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E5%B0%8F%E5%B7%A5%E5%85%B7%EF%BC%88${envLabel()}%EF%BC%89%60,body:%60%20%20%20%20%20%20%20%20%20%20%3Cdiv%3E%E8%AB%8B%E8%BC%B8%E5%85%A5%20SSO-TOKEN%EF%BC%9A%3C/div%3E%20%20%20%20%20%20%20%20%20%20%3Cinput%20class=%22pct-input%22%20id=%22pct-token-input%22%20type=%22text%22%20value=%22${State.token%20||%20''}%22%20autocomplete=%22off%22%20/%3E%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22pct-error%22%20id=%22pct-error%22%20style=%22display:none%22%3E%3C/div%3E%20%20%20%20%20%20%20%20%60,footer:%60%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-token-ok%22%3E%E7%A2%BA%E8%AA%8D%3C/button%3E%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-token-skip%22%3E%E7%95%A5%E9%81%8E%E9%A9%97%E8%AD%89%3C/button%3E%20%20%20%20%20%20%20%20%60,onOpen:()=%3E{document.getElementById('pct-token-input').focus();document.getElementById('pct-token-ok').onclick=async()=%3E{const%20val=document.getElementById('pct-token-input').value.trim();if(!val){showError('%E8%AB%8B%E8%BC%B8%E5%85%A5%20Token');return}showToast('%E6%AA%A2%E6%9F%A5%20Token%20%E4%B8%AD...');State.token=val;localStorage.setItem('SSO-TOKEN',val);if(State.tokenCheckEnabled){const%20ok=await%20Api.verifyToken(val);if(ok){closeModal();showToast('Token%20%E9%A9%97%E8%AD%89%E6%88%90%E5%8A%9F');await%20showQueryDialog();resolve()}else{showError('Token%20%E9%A9%97%E8%AD%89%E5%A4%B1%E6%95%97%EF%BC%8C%E8%AB%8B%E9%87%8D%E6%96%B0%E8%BC%B8%E5%85%A5')}}else{closeModal();await%20showQueryDialog();resolve()}};document.getElementById('pct-token-skip').onclick=async()=%3E{State.tokenCheckEnabled=!1;closeModal();await%20showQueryDialog();resolve()}}})})}async%20function%20showQueryDialog(){return%20new%20Promise((resolve)=%3E{showModal({title:'%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6%E8%A8%AD%E5%AE%9A',body:%60%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22margin-bottom:8px;%22%3E%E6%9F%A5%E8%A9%A2%E6%A8%A1%E5%BC%8F%EF%BC%9A%3C/div%3E%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22pct-mode-wrap%22%20style=%22display:flex;gap:8px;margin-bottom:12px;%22%3E%20%20%20%20%20%20%20%20%20%20%20%20${['planCode',%20'planCodeName',%20'allPlans',%20'inSale'].map(mode%20=%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%60%3Cdiv%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-mode-${mode}%22%20data-mode=%22${mode}%22%20style=%22flex:1%22%3E${modeLabel(mode)}%3C/div%3E%60%20%20%20%20%20%20%20%20%20%20%20%20).join('')}%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%3Cinput%20class=%22pct-input%22%20id=%22pct-query-input%22%20type=%22text%22%20placeholder=%22%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2%E5%85%A7%E5%AE%B9%22%20autocomplete=%22off%22%20style=%22margin-bottom:8px;%22%20/%3E%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22pct-error%22%20id=%22pct-error%22%20style=%22display:none%22%3E%3C/div%3E%20%20%20%20%20%20%20%20%60,footer:%60%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-query-ok%22%3E%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-query-cancel%22%3E%E5%8F%96%E6%B6%88%3C/button%3E%20%20%20%20%20%20%20%20%60,onOpen:()=%3E{let%20mode='planCode';updateModeUI();document.getElementById('pct-query-input').focus();document.getElementById('pct-query-input').disabled=!1;Array.from(document.querySelectorAll('#pct-mode-wrap%20.pct-btn')).forEach(btn=%3E{btn.onclick=()=%3E{mode=btn.dataset.mode;updateModeUI();if(mode==='allPlans'||mode==='inSale'){document.getElementById('pct-query-input').disabled=!0;document.getElementById('pct-query-input').value=''}else{document.getElementById('pct-query-input').disabled=!1;document.getElementById('pct-query-input').focus()}}});function%20updateModeUI(){Array.from(document.querySelectorAll('#pct-mode-wrap%20.pct-btn')).forEach(btn=%3E{btn.style.background=btn.dataset.mode===mode?'#1967d2':'#e0e0e0';btn.style.color=btn.dataset.mode===mode?'#fff':'#333';btn.style.fontWeight=btn.dataset.mode===mode?'bold':'normal'})}document.getElementById('pct-query-ok').onclick=async()=%3E{let%20value=document.getElementById('pct-query-input').value.trim();if((mode==='planCode'||mode==='planCodeName')&&!value){showError('%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9F%A5%E8%A9%A2%E5%85%A7%E5%AE%B9');return}closeModal();State.queryMode=mode;State.queryInput=value;State.pageNo=1;State.filterSpecial=!1;State.filters={};await%20doQuery();resolve()};document.getElementById('pct-query-cancel').onclick=()=%3E{closeModal();resolve()}}})})}async%20function%20doQuery(){showToast('%E6%9F%A5%E8%A9%A2%E4%B8%AD...');let%20params;switch(State.queryMode){case%20'planCode':params={planCode:State.queryInput,pageNo:State.pageNo,pageSize:State.pageSize};break;case%20'planCodeName':params={planCodeName:State.queryInput,pageNo:State.pageNo,pageSize:State.pageSize};break;case%20'allPlans':params={planCodeName:'',pageNo:State.pageNo,pageSize:State.pageSize};break;case%20'inSale':params={saleEndDate:'9999-12-31%2000:00:00',pageNo:State.pageNo,pageSize:State.pageSize};break;default:showToast('%E6%9C%AA%E7%9F%A5%E6%9F%A5%E8%A9%A2%E6%A8%A1%E5%BC%8F','error');return}try{State.apiAbortController=new%20AbortController();const%20signal=State.apiAbortController.signal;const%20result=await%20Api.call('/planCodeController/query',params,signal);if(!result.records||result.records.length===0){showError('%E6%9F%A5%E7%84%A1%E8%B3%87%E6%96%99');return}State.allData=await%20Promise.all(result.records.map(async(item,idx)=%3E{let%20polpln='';if(State.cacheDetail.has(item.planCode)){polpln=State.cacheDetail.get(item.planCode)}else{try{const%20detail=await%20Api.call('/planCodeController/queryDetail',{planCode:item.planCode,pageNo:1,pageSize:20},signal);polpln=(detail.records||[]).map(r=%3Er.polpln).join(',%20');State.cacheDetail.set(item.planCode,polpln)}catch{polpln=''}}let%20channels=[];if(State.cacheChannel.has(item.planCode)){channels=State.cacheChannel.get(item.planCode)}else{try{const%20sale=await%20Api.call('/planCodeSaleDateController/query',{planCode:item.planCode,pageNo:1,pageSize:50},signal);channels=(sale.planCodeSaleDates?.records||[]).map(r=%3E({channel:channelCodeConvert(r.channel),saleEndDate:formatDate(r.saleEndDate),status:getSaleStatus(formatToday(),r.saleStartDate,r.saleEndDate),rawEnd:r.saleEndDate}));State.cacheChannel.set(item.planCode,channels)}catch{channels=[]}}const%20mainStatus=getSaleStatus(formatToday(),item.saleStartDate,item.saleEndDate);const%20special=(mainStatus==='%E5%81%9C%E5%94%AE'&&channels.some(c=%3Ec.status==='%E7%8F%BE%E5%94%AE%E4%B8%AD'))||channels.some(c=%3ENumber(formatDate(item.saleEndDate))%3CNumber(formatDate(c.saleEndDate)));return{no:idx+1,planCode:item.planCode,shortName:item.shortName,currency:currencyConvert(item.currency),unit:unitConvert(item.reportInsuranceAmountUnit||item.insuranceAmountUnit),coverageType:coverageTypeConvert(item.coverageType),saleStartDate:formatDate(item.saleStartDate),saleEndDate:formatDate(item.saleEndDate),mainStatus,polpln,channels,special}}));State.totalRecords=result.totalRecords||State.allData.length;renderTable()}catch(e){showError('%E6%9F%A5%E8%A9%A2%20API%20%E5%A4%B1%E6%95%97%EF%BC%9A'+e.message)}}function%20renderTable(){showModal({title:%60%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%EF%BC%88${envLabel()}%EF%BC%89%60,body:renderSummary()+renderTableHTML(),footer:%60%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-detail%22%3E%E4%B8%80%E9%8D%B5%E6%9F%A5%E8%A9%A2%E5%85%A8%E9%83%A8%E8%A9%B3%E7%B4%B0%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-copy%22%3E%E4%B8%80%E9%8D%B5%E8%A4%87%E8%A3%BD%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-prev%22%3E%E4%B8%8A%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-next%22%3E%E4%B8%8B%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-filter%22%3E%E7%AF%A9%E9%81%B8%E7%89%B9%E6%AE%8A%E7%8B%80%E6%85%8B%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-table-showall%22%3E${State.isShowingAll%20?%20'%E5%88%86%E9%A0%81%E9%A1%AF%E7%A4%BA'%20:%20'%E5%85%A8%E9%83%A8%E9%A1%AF%E7%A4%BA'}%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%22%20id=%22pct-table-requery%22%3E%E9%87%8D%E6%96%B0%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pct-btn%20pct-btn-secondary%22%20id=%22pct-table-close%22%3E%E9%97%9C%E9%96%89%3C/button%3E%20%20%20%20%20%20%60,onOpen:()=%3E{document.getElementById('pct-table-detail').onclick=async()=%3E{showToast('%E6%89%B9%E6%AC%A1%E6%9F%A5%E8%A9%A2%E8%A9%B3%E7%B4%B0%E8%B3%87%E6%96%99%E4%B8%AD...');await%20doQuery()};document.getElementById('pct-table-copy').onclick=()=%3E{copyTableData()};document.getElementById('pct-table-prev').onclick=()=%3E{if(State.pageNo%3E1){State.pageNo--;doQuery()}};document.getElementById('pct-table-next').onclick=()=%3E{if(State.pageNo*State.pageSize%3CState.totalRecords){State.pageNo++;doQuery()}};document.getElementById('pct-table-filter').onclick=()=%3E{State.filterSpecial=!State.filterSpecial;renderTable()};document.getElementById('pct-table-showall').onclick=()=%3E{State.isShowingAll=!State.isShowingAll;renderTable()};document.getElementById('pct-table-requery').onclick=()=%3E{closeModal();main()};document.getElementById('pct-table-close').onclick=()=%3E{closeModal()};Array.from(document.querySelectorAll('.pct-table%20th')).forEach(th=%3E{th.onclick=()=%3E{const%20key=th.dataset.key;if(!key)return;if(State.sortKey===key)State.sortAsc=!State.sortAsc;else{State.sortKey=key;State.sortAsc=!0}State.allData.sort((a,b)=%3E{if(a[key]%3Eb[key])return%20State.sortAsc?1:-1;if(a[key]%3Cb[key])return%20State.sortAsc?-1:1;return%200});renderTable()}});Array.from(document.querySelectorAll('.pct-table%20td.copyable')).forEach(td=%3E{td.onclick=function(){copyTextToClipboard(td.textContent.trim())}})}})}function%20renderSummary(){const%20specialCount=State.allData.filter(r=%3Er.special).length;let%20html=%60%3Cdiv%20class=%22pct-summary%22%3E%E5%85%B1%20${State.allData.length}%20%E7%AD%86%60;if(specialCount%3E0){html+=%60%EF%BC%8C%E4%B8%BB%E7%B4%84%E5%81%9C%E5%94%AE%E4%BD%86%E9%80%9A%E8%B7%AF%E7%8F%BE%E5%94%AE/%E7%9F%9B%E7%9B%BE%EF%BC%9A%3Cb%3E${specialCount}%3C/b%3E%20%E7%AD%86%60;html+=%60%3Cbutton%20class=%22pct-filter-btn%22%20id=%22pct-table-filter%22%3E${State.filterSpecial%20?%20'%E9%A1%AF%E7%A4%BA%E5%85%A8%E9%83%A8'%20:%20'%E5%8F%AA%E9%A1%AF%E7%A4%BA%E7%89%B9%E6%AE%8A'}%3C/button%3E%60}html+=%60%3C/div%3E%60;return%20html}function%20renderTableHTML(){let%20data=State.filterSpecial?State.allData.filter(r=%3Er.special):State.allData;if(!State.isShowingAll){const%20start=(State.pageNo-1)*State.pageSize;data=data.slice(start,start+State.pageSize)}let%20html=%60%3Cdiv%20class=%22pct-table-wrap%22%3E%3Ctable%20class=%22pct-table%22%3E%3Cthead%3E%3Ctr%3E%20%20%20%20%20%20%3Cth%20data-key=%22no%22%3ENo%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22planCode%22%3E%E4%BB%A3%E8%99%9F%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22shortName%22%3E%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22currency%22%3E%E5%B9%A3%E5%88%A5%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22unit%22%3E%E5%96%AE%E4%BD%8D%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22coverageType%22%3E%E9%A1%9E%E5%9E%8B%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22saleStartDate%22%3E%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5%3C/th%3E%20%20%20%20%20%20%3Cth%20data-key=%22saleEndDate%22%3E%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5%3C/th%3E%20%20%20%20%20%20%3Cth%3E%E4%B8%BB%E7%B4%84%E7%8B%80%E6%85%8B%3C/th%3E%20%20%20%20%20%20%3Cth%3EPOLPLN%3C/th%3E%20%20%20%20%20%20%3Cth%3E%E9%80%9A%E8%B7%AF%E8%B3%87%E8%A8%8A%3C/th%3E%20%20%20%20%3C/tr%3E%3C/thead%3E%3Ctbody%3E%60;data.forEach(row=%3E{html+=%60%3Ctr${row.special%20?%20'%20class=%22special-row%22'%20:%20''}%3E%20%20%20%20%20%20%20%20%3Ctd%3E${row.no}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.planCode}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%20title=%22${row.shortName}%22%3E${row.shortName}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.currency}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.unit}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.coverageType}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.saleStartDate}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.saleEndDate}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22${row.mainStatus%20===%20'%E7%8F%BE%E5%94%AE%E4%B8%AD'%20?%20'pct-status-onsale'%20:%20row.mainStatus%20===%20'%E5%81%9C%E5%94%AE'%20?%20'pct-status-offsale'%20:%20''}%22%3E${row.mainStatus}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20class=%22copyable%22%3E${row.polpln%20||%20''}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%3E${row.channels.map(c%20=%3E%20%20%20%20%20%20%20%20%20%20%60%3Cspan%20class=%22${c.status%20===%20'%E7%8F%BE%E5%94%AE%E4%B8%AD'%20?%20'pct-status-onsale'%20:%20'pct-status-offsale'}%22%3E${c.channel}:${c.saleEndDate}%EF%BC%88${c.status}%EF%BC%89%3C/span%3E%60%20%20%20%20%20%20%20%20).join('%3Cbr%3E')}%3C/td%3E%20%20%20%20%20%20%3C/tr%3E%60});html+=%60%3C/tbody%3E%3C/table%3E%3C/div%3E%60;return%20html}function%20copyTableData(){let%20data=State.filterSpecial?State.allData.filter(r=%3Er.special):State.allData;if(!State.isShowingAll){const%20start=(State.pageNo-1)*State.pageSize;data=data.slice(start,start+State.pageSize)}let%20txt='No\t%E4%BB%A3%E8%99%9F\t%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1\t%E5%B9%A3%E5%88%A5\t%E5%96%AE%E4%BD%8D\t%E9%A1%9E%E5%9E%8B\t%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5\t%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5\t%E4%B8%BB%E7%B4%84%E7%8B%80%E6%85%8B\tPOLPLN\t%E9%80%9A%E8%B7%AF%E8%B3%87%E8%A8%8A\n';data.forEach(row=%3E{let%20channelStr=row.channels.map(c=%3E%60${c.channel}:${c.saleEndDate}%EF%BC%88${c.status}%EF%BC%89%60).join('%20/%20');txt+=%60${row.no}\t${row.planCode}\t${row.shortName}\t${row.currency}\t${row.unit}\t${row.coverageType}\t${row.saleStartDate}\t${row.saleEndDate}\t${row.mainStatus}\t${row.polpln}\t${channelStr}\n%60});copyTextToClipboard(txt)}function%20copyTextToClipboard(text){const%20ta=document.createElement('textarea');ta.value=text;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);showToast('%E5%B7%B2%E8%A4%87%E8%A3%BD:%20'+(text.length%3E40?text.slice(0,40)+'...':text))}main()})()
＊＊＊＊＊第46段程式碼結束/90PLANNEW /＊＊＊＊＊




＊＊＊＊＊第47段程式碼開始/98h h h h h /＊＊＊＊＊
javascript:(async function(){%C2%A0 %C2%A0 'use strict';%C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 const state={%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentPage:1,totalPages:1,allDataArray:[],recordsPerPage:100,currentToken:null,%C2%A0 %C2%A0 %C2%A0 %C2%A0 displayedDataArray:[],isShowingAllData:!1,queriedDataCache:new Map(),%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentSortColumn:null,currentSortDirection:'asc',apiAbortController:null,%C2%A0 %C2%A0 %C2%A0 %C2%A0 currentFilters:{},errorMessage:null %C2%A0 %C2%A0};%C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 %C2%A0 const API_URLS={%C2%A0 %C2%A0 %C2%A0 %C2%A0 PLANCODE_QUERY:
＊＊＊＊＊第47段程式碼結束/98h h h h h /＊＊＊＊＊




＊＊＊＊＊第48段程式碼開始/162A /＊＊＊＊＊
javascript:(function(){const state={allDataArray:[],displayedDataArray:[],currentPage:1,sortColumn:null,sortDirection:'asc',currentToken:null,currentFilters:{isStillSelling:''},showAllMode:!1,isBatchQueryCancelled:!1};const UI={createDialog(title,message,inputs,buttons){const dialog=document.createElement('div');dialog.id='pcrDialog';dialog.style.position='fixed';dialog.style.top='50%';dialog.style.left='50%';dialog.style.transform='translate(-50%, -50%)';dialog.style.background='#fff';dialog.style.border='1px%20solid%20#ddd';dialog.style.borderRadius='5px';dialog.style.padding='20px';dialog.style.zIndex='1001';dialog.style.boxShadow='0%202px%2010px%20rgba(0,0,0,0.1)';dialog.style.maxWidth='400px';let%20inputsHtml=inputs.map(input=%3E%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22margin-bottom:%2010px;%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20style=%22display:%20inline-block;%20width:%20100px;%20text-align:%20right;%20margin-right:%2010px;%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${input.label}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/label%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${input.type%20===%20'text'%20?%20%60%3Cinput%20type=%22text%22%20id=%22${input.id}%22%20style=%22width:%20200px;%20padding:%205px;%22%3E%60%20:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20input.type%20===%20'checkbox'%20?%20%60%3Cinput%20type=%22checkbox%22%20id=%22${input.id}%22%20${input.value?'checked':''}%3E%60%20:%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20''}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60).join('');let%20buttonsHtml=buttons.map(button=%3E%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style=%22margin:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%22%20onclick=%22${button.onclick}%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${button.label}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%60).join('');dialog.innerHTML=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch3%20style=%22margin:%200%200%2010px;%22%3E${title}%3C/h3%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20style=%22margin:%200%200%2010px;%22%3E${message}%3C/p%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${inputsHtml}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22text-align:%20right;%22%3E${buttonsHtml}%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60;document.body.appendChild(dialog);const%20firstInput=dialog.querySelector('input[type=%22text%22]');if(firstInput){firstInput.focus();firstInput.addEventListener('keypress',e=%3E{if(e.key==='Enter'){dialog.querySelector('button').click()}})}},showNotification(message,isError=!1){const%20notification=document.createElement('div');notification.style.position='fixed';notification.style.top='20px';notification.style.right='20px';notification.style.background=isError?'#f8d7da':'#e7f3ff';notification.style.border=isError?'1px%20solid%20#f5c6cb':'1px%20solid%20#b3d4fc';notification.style.padding='10px';notification.style.borderRadius='5px';notification.style.zIndex='1002';notification.textContent=message;document.body.appendChild(notification);setTimeout(()=%3Enotification.remove(),2000)},showProgressNotification(totalItems){const%20progressContainer=document.createElement('div');progressContainer.id='pcrProgressContainer';progressContainer.style.position='fixed';progressContainer.style.top='20px';progressContainer.style.right='20px';progressContainer.style.background='#e7f3ff';progressContainer.style.border='1px%20solid%20#b3d4fc';progressContainer.style.padding='10px';progressContainer.style.borderRadius='5px';progressContainer.style.zIndex='1002';progressContainer.style.boxShadow='0%202px%205px%20rgba(0,0,0,0.1)';progressContainer.innerHTML=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%3E%E6%AD%A3%E5%9C%A8%E6%9F%A5%E8%A9%A2%E9%80%9A%E8%B7%AF%E8%B3%87%E6%96%99...%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%22pcrProgressText%22%3E%E7%AC%AC%200%20%E6%89%B9%20/%20%E5%85%B1%20${Math.ceil(totalItems%20/%2050)}%20%E6%89%B9%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22pcrCancelBatch%22%20style=%22margin-top:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%22%3E%E5%8F%96%E6%B6%88%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%60;document.body.appendChild(progressContainer);document.getElementById('pcrCancelBatch').onclick=()=%3E{state.isBatchQueryCancelled=!0;UI.showNotification('%E6%AD%A3%E5%9C%A8%E5%8F%96%E6%B6%88%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2...')}},updateProgressNotification(currentBatch,totalBatches){const%20progressText=document.getElementById('pcrProgressText');if(progressText){progressText.textContent=%60%E7%AC%AC%20${currentBatch}%20%E6%89%B9%20/%20%E5%85%B1%20${totalBatches}%20%E6%89%B9%60}},removeProgressNotification(){const%20progressContainer=document.getElementById('pcrProgressContainer');if(progressContainer){progressContainer.remove()}}};const%20ApiManager={async%20callApi(token,params,retryCount=0){const%20maxRetries=3;const%20retryDelay=2000;const%20endpoint=params.saleChannel?'/planCodeSaleDateController/query':params.polpln?'/planCodeController/queryDetail':'/planCodeController/query';const%20headers={'Authorization':%60Bearer%20${token}%60,'Content-Type':'application/json'};const%20requestOptions={method:'POST',headers,body:JSON.stringify(params)};try{const%20response=await%20fetch(endpoint,requestOptions);if(!response.ok){throw%20new%20Error(%60HTTP%20${response.status}%60)}const%20data=await%20response.json();return%20data}catch(err){if(retryCount%3CmaxRetries){console.warn(%60API%20%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97%EF%BC%8C%E7%AC%AC%20${retryCount%20+%201}%20%E6%AC%A1%E9%87%8D%E8%A9%A6:%20${err.message}%60);await%20new%20Promise(resolve=%3EsetTimeout(resolve,retryDelay));return%20this.callApi(token,params,retryCount+1)}else{console.error('API%20%E6%9F%A5%E8%A9%A2%E6%9C%80%E7%B5%82%E5%A4%B1%E6%95%97:',err);throw%20new%20Error(%60%E7%84%A1%E6%B3%95%E9%80%A3%E7%B7%9A%E5%88%B0%E4%BC%BA%E6%9C%8D%E5%99%A8:%20${err.message}%60)}}},async%20queryBatchInfo(token,codes){const%20params={codes,pageSize:codes.length};return%20this.callApi(token,params)}};const%20TokenManager={async%20getStoredToken(){const%20possibleKeys=['euisPlanCodeToken','euisToken'];for(const%20key%20of%20possibleKeys){const%20token=localStorage.getItem(key);if(token&&await%20this.isValidToken(token)){state.currentToken=token;return%20token}}return%20null},async%20promptForToken(attempts=0){if(attempts%3E=3){UI.showNotification('%E5%B7%B2%E9%81%94%E6%9C%80%E5%A4%A7%E5%98%97%E8%A9%A6%E6%AC%A1%E6%95%B8%EF%BC%8C%E8%AB%8B%E7%A8%8D%E5%BE%8C%E9%87%8D%E8%A9%A6',!0);return%20null}UI.createDialog('%E8%BC%B8%E5%85%A5%20TOKEN','%E8%AB%8B%E8%BC%B8%E5%85%A5%E6%9C%89%E6%95%88%E7%9A%84%20TOKEN',[{label:'TOKEN:',type:'text',id:'tokenInput'}],[{label:'%E7%A2%BA%E8%AA%8D',onclick:%60(()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20token%20=%20document.getElementById('tokenInput').value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!token.trim())%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UI.showNotification('%E8%AB%8B%E8%BC%B8%E5%85%A5%20TOKEN',%20true);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById('pcrDialog').remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.bookmarkletFuncs.validateAndStoreToken('${attempts%20+%201}',%20token);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20})()%60},{label:'%E5%8F%96%E6%B6%88',onclick:%60(()%20=%3E%20{%20document.getElementById('pcrDialog').remove();%20})()%60}])},async%20validateAndStoreToken(attempt,token){const%20cleanToken=Utils.toHalfWidth(token.trim());if(await%20this.isValidToken(cleanToken)){try{localStorage.setItem('euisPlanCodeToken',cleanToken);state.currentToken=cleanToken;UI.showNotification('TOKEN%20%E9%A9%97%E8%AD%89%E6%88%90%E5%8A%9F');ProductQueryManager.startQuery()}catch(err){console.warn('%E5%84%B2%E5%AD%98%20TOKEN%20%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E5%84%B2%E5%AD%98%20TOKEN%20%E5%A4%B1%E6%95%97%EF%BC%8C%E8%AB%8B%E9%87%8D%E8%A9%A6',!0)}}else{UI.showNotification('%E7%84%A1%E6%95%88%20TOKEN%EF%BC%8C%E8%AB%8B%E9%87%8D%E8%A9%A6',!0);this.promptForToken(parseInt(attempt))}},async%20isValidToken(token){try{const%20response=await%20ApiManager.callApi(token,{planCodeName:''});return!!response}catch(err){console.warn('TOKEN%20%E9%A9%97%E8%AD%89%E5%A4%B1%E6%95%97:',err);return!1}}};const%20ProductQueryManager={async%20startQuery(){UI.createDialog('%E6%9F%A5%E8%A9%A2%E5%95%86%E5%93%81','%E8%BC%B8%E5%85%A5%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F%EF%BC%88%E5%A4%9A%E7%AD%86%E8%AB%8B%E7%94%A8%E9%80%97%E8%99%9F%E6%88%96%E7%A9%BA%E7%99%BD%E5%88%86%E9%9A%94%EF%BC%89',[{label:'%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F:',type:'text',id:'planCodeInput'},{label:'%E5%83%85%E6%9F%A5%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81:',type:'checkbox',id:'inSaleOnly',value:!1}],[{label:'%E7%A2%BA%E8%AA%8D',onclick:%60(()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20input%20=%20document.getElementById('planCodeInput').value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20inSaleOnly%20=%20document.getElementById('inSaleOnly').checked;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!input.trim())%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UI.showNotification('%E8%AB%8B%E8%BC%B8%E5%85%A5%E5%95%86%E5%93%81%E4%BB%A3%E8%99%9F',%20true);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20codes%20=%20input.split(/[\s,]+/).map(code%20=%3E%20Utils.toHalfWidth(code.trim())).filter(Boolean);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(codes.length%20===%200%20&&%20!input.toUpperCase().startsWith('ALL'))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20UI.showNotification('%E8%BC%B8%E5%85%A5%E6%A0%BC%E5%BC%8F%E7%84%A1%E6%95%88%EF%BC%8C%E8%AB%8B%E6%AA%A2%E6%9F%A5',%20true);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById('pcrDialog').remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.bookmarkletFuncs.handleQuery(input,%20inSaleOnly);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20})()%60},{label:'%E5%8F%96%E6%B6%88',onclick:%60(()%20=%3E%20{%20document.getElementById('pcrDialog').remove();%20})()%60},{label:'%E9%87%8D%E8%A8%AD%20TOKEN',onclick:%60(()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById('pcrDialog').remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20localStorage.removeItem('euisPlanCodeToken');%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20localStorage.removeItem('euisToken');%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20startMainFlow();%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20})()%60}])},async%20handleQuery(input,inSaleOnly){const%20codes=input.toUpperCase().startsWith('ALL')?['ALL']:input.split(/[\s,]+/).map(code=%3EUtils.toHalfWidth(code.trim())).filter(Boolean);let%20allData=[];const%20pageSize=1000;try{for(const%20code%20of%20codes){let%20page=1;while(!0){const%20params={planCode:code,pageNo:page,pageSize};if(inSaleOnly){params.saleEndDate='9999-12-31%2000:00:00'}const%20response=await%20ApiManager.callApi(state.currentToken,params);if(!response||!response.records||response.records.length===0){break}allData=allData.concat(response.records.map(DataFormatter.formatItemData));if(response.records.length%3CpageSize){break}page++}}state.allDataArray=allData;FilterManager.applyFilters();TableRenderer.render();UI.showNotification(%60%E6%9F%A5%E8%A9%A2%E5%AE%8C%E6%88%90%EF%BC%8C%E5%85%B1%20${allData.length}%20%E7%AD%86%60)}catch(err){console.error('%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:',err);UI.showNotification(%60%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:%20${err.message}%60,!0)}},async%20queryInSale(){try{const%20params={saleEndDate:'9999-12-31%2000:00:00',pageNo:1,pageSize:1000};const%20response=await%20ApiManager.callApi(state.currentToken,params);if(response&&response.records){state.allDataArray=response.records.map(DataFormatter.formatItemData);FilterManager.applyFilters();TableRenderer.render();UI.showNotification(%60%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E5%AE%8C%E6%88%90%EF%BC%8C%E5%85%B1%20${state.allDataArray.length}%20%E7%AD%86%60)}else{UI.showNotification('%E7%84%A1%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81%E8%B3%87%E6%96%99',!0)}}catch(err){console.error('%E7%8F%BE%E5%94%AE%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:',err);UI.showNotification(%60%E7%8F%BE%E5%94%AE%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:%20${err.message}%60,!0)}},async%20batchQueryInfo(){const%20itemsToQuery=state.displayedDataArray.filter(item=%3E!item.isQueried);if(itemsToQuery.length%3E50){const%20userConfirm=confirm(%60%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%E5%85%B1%20${itemsToQuery.length}%20%E7%AD%86%EF%BC%8C%E8%B6%85%E9%81%8E50%E7%AD%86%E5%B0%87%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2%E9%80%9A%E8%B7%AF%EF%BC%8C%E6%98%AF%E5%90%A6%E7%B9%BC%E7%BA%8C%EF%BC%9F%60);if(!userConfirm){UI.showNotification('%E6%93%8D%E4%BD%9C%E5%B7%B2%E5%8F%96%E6%B6%88');return}}state.isBatchQueryCancelled=!1;UI.showProgressNotification(itemsToQuery.length);const%20batchSize=50;const%20batches=[];for(let%20i=0;i%3CitemsToQuery.length;i+=batchSize){batches.push(itemsToQuery.slice(i,i+batchSize))}for(let%20batchIndex=0;batchIndex%3Cbatches.length;batchIndex++){if(state.isBatchQueryCancelled){UI.showNotification('%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2%E5%B7%B2%E5%8F%96%E6%B6%88');UI.removeProgressNotification();break}const%20batch=batches[batchIndex];const%20codes=batch.map(item=%3Eitem.code);try{const%20response=await%20ApiManager.queryBatchInfo(state.currentToken,codes);if(response&&response.records){response.records.forEach(record=%3E{const%20targetItem=state.displayedDataArray.find(item=%3Eitem.code===record.planCode);if(targetItem){targetItem.polpln=record.polpln||'-';targetItem.saleChannel=record.saleChannel||'-';targetItem.isQueried=!0}})}UI.updateProgressNotification(batchIndex+1,batches.length);TableRenderer.render()}catch(err){console.warn('%E5%88%86%E6%89%B9%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:',err);UI.showNotification(%60%E7%AC%AC%20${batchIndex%20+%201}%20%E6%89%B9%E6%9F%A5%E8%A9%A2%E5%A4%B1%E6%95%97:%20${err.message}%60,!0)}}if(!state.isBatchQueryCancelled){UI.showNotification('%E9%80%9A%E8%B7%AF%E6%9F%A5%E8%A9%A2%E5%AE%8C%E6%88%90');UI.removeProgressNotification()}}};const%20DataFormatter={formatItemData(item){return{code:item.planCode||'-',commodityCode:item.commodityCode||'-',name:item.planCodeName||'-',cur:item.currency||'-',unit:item.unit||'-',type:item.type||'-',start:Utils.formatDateToYYYYMMDDString(item.saleStartDate)||'-',end:Utils.formatDateToYYYYMMDDString(item.saleEndDate)||'-',isStillSelling:Utils.isStillSelling(item.saleEndDate),polpln:'-',saleChannel:'-',isQueried:!1}}};const%20Utils={toHalfWidth(str){return%20str.replace(/[%EF%BC%A1-%EF%BC%BA%EF%BD%81-%EF%BD%9A%EF%BC%90-%EF%BC%99]/g,c=%3EString.fromCharCode(c.charCodeAt(0)-0xFEE0))},formatDateToYYYYMMDDString(dateStr){if(!dateStr)return'';const%20date=new%20Date(dateStr);if(isNaN(date))return%20dateStr;return%20%60${date.getFullYear()}${('0'%20+%20(date.getMonth()%20+%201)).slice(-2)}${('0'%20+%20date.getDate()).slice(-2)}%60},getTodayYYYYMMDDString(){const%20today=new%20Date();return%20%60${today.getFullYear()}${('0'%20+%20(today.getMonth()%20+%201)).slice(-2)}${('0'%20+%20today.getDate()).slice(-2)}%60},isStillSelling(saleEndDate){const%20today=this.getTodayYYYYMMDDString();const%20endDate=this.formatDateToYYYYMMDDString(saleEndDate);return%20endDate==='99991231'||endDate%3E=today}};const%20FilterManager={applyFilters(){let%20filteredData=[...state.allDataArray];if(state.currentFilters.isStillSelling){filteredData=filteredData.filter(item=%3Eitem.isStillSelling===(state.currentFilters.isStillSelling==='Y'))}state.displayedDataArray=filteredData;state.currentPage=1;UI.showNotification(%60%E7%AF%A9%E9%81%B8%E5%BE%8C%E9%A1%AF%E7%A4%BA%20${filteredData.length}%20%E7%AD%86%E5%95%86%E5%93%81%60)}};const%20SortManager={toggleSort(column){if(state.sortColumn===column){state.sortDirection=state.sortDirection==='asc'?'desc':'asc'}else{state.sortColumn=column;state.sortDirection='asc'}this.applySort()},applySort(){state.displayedDataArray.sort((a,b)=%3E{let%20valA=a[state.sortColumn]||'';let%20valB=b[state.sortColumn]||'';if(state.sortColumn==='end'){valA=a.isStillSelling?'99991231':a[state.sortColumn]||'';valB=b.isStillSelling?'99991231':b[state.sortColumn]||''}if(typeof%20valA==='string')valA=valA.toLowerCase();if(typeof%20valB==='string')valB=valB.toLowerCase();return%20state.sortDirection==='asc'?(valA%3EvalB?1:-1):(valA%3CvalB?1:-1)});TableRenderer.render()}};const%20TableRenderer={render(){let%20container=document.getElementById('pcrContainer');if(!container){container=document.createElement('div');container.id='pcrContainer';container.style.position='fixed';container.style.top='10px';container.style.left='10px';container.style.right='10px';container.style.bottom='10px';container.style.background='#fff';container.style.border='1px%20solid%20#ddd';container.style.padding='10px';container.style.zIndex='1000';container.style.overflow='auto';document.body.appendChild(container)}const%20itemsPerPage=50;const%20startIndex=(state.currentPage-1)*itemsPerPage;const%20endIndex=Math.min(startIndex+itemsPerPage,state.displayedDataArray.length);const%20visibleData=state.displayedDataArray.slice(startIndex,endIndex);container.innerHTML=%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cstyle%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20{%20width:%20100%;%20border-collapse:%20collapse;%20font-size:%2012px;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20th,%20#pcrTable%20td%20{%20border:%201px%20solid%20#ddd;%20padding:%208px;%20text-align:%20left;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20th%20{%20background:%20#f4f4f4;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20tr:nth-child(even)%20{%20background:%20#f9f9f9;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20#pcrTable%20tr:hover%20{%20background:%20#f0f0f0;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.pcr-btn%20{%20margin:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter-btn-group%20{%20margin:%2010px%200;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter-btn%20{%20margin-right:%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter-btn.active%20{%20background:%20#007bff;%20color:%20white;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.polpln-text%20{%20color:%20green;%20font-size:%2010px;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.pagination%20{%20margin-top:%2010px;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.pagination%20button%20{%20margin:%200%205px;%20padding:%205px%2010px;%20cursor:%20pointer;%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/style%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${this.generateFilterControls()}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22ProductQueryManager.startQuery()%22%3E%E9%87%8D%E6%96%B0%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22ProductQueryManager.batchQueryInfo()%22%3E%E6%9F%A5%E8%A9%A2%E9%80%9A%E8%B7%AF%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22ProductQueryManager.queryInSale()%22%3E%E7%8F%BE%E5%94%AE%E5%95%86%E5%93%81%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22TableRenderer.toggleShowAllMode()%22%3E${state.showAllMode%20?%20'%E7%B8%AE%E6%B8%9B%E9%A1%AF%E7%A4%BA'%20:%20'%E6%9F%A5%E7%9C%8B%E5%85%A8%E9%83%A8'}%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22pcr-btn%22%20onclick=%22TableRenderer.copyAll()%22%3E%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%22max-height:%20600px;%20overflow-y:%20auto;%22%20id=%22pcrTableContainer%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctable%20id=%22pcrTable%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${this.generateTableHeader()}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctbody%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${visibleData.map(item%20=%3E%20this.generateTableRow(item)).join('')}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/tbody%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/table%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${this.generatePaginationControls()}%20%20%20%20%20%20%20%20%20%20%20%20%60;this.bindCopyEvents()},generateFilterControls(){return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22filter-btn-group%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22filter-btn%20${!state.currentFilters.isStillSelling%20?%20'active'%20:%20''}%22%20onclick=%22window.bookmarkletFuncs.applyFilter('isStillSelling',%20'')%22%3E%E5%85%A8%E9%83%A8%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22filter-btn%20${state.currentFilters.isStillSelling%20===%20'Y'%20?%20'active'%20:%20''}%22%20onclick=%22window.bookmarkletFuncs.applyFilter('isStillSelling',%20'Y')%22%3E%E7%8F%BE%E5%94%AE%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%22filter-btn%20${state.currentFilters.isStillSelling%20===%20'N'%20?%20'active'%20:%20''}%22%20onclick=%22window.bookmarkletFuncs.applyFilter('isStillSelling',%20'N')%22%3E%E5%81%9C%E5%94%AE%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},generateTableHeader(){const%20columns=[{key:'code',label:'%E4%BB%A3%E8%99%9F'},{key:'commodityCode',label:'%E5%95%86%E5%93%81%E7%A2%BC'},{key:'name',label:'%E5%90%8D%E7%A8%B1'},{key:'cur',label:'%E5%B9%A3%E5%88%A5'},{key:'unit',label:'%E5%96%AE%E4%BD%8D'},{key:'type',label:'%E9%A1%9E%E5%9E%8B'},{key:'start',label:'%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5'},{key:'end',label:'%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5'}];return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cthead%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctr%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${columns.map(col%20=%3E%20%60%3Cth%20onclick=%22window.bookmarkletFuncs.toggleSort('${col.key}')%22%3E${col.label}${state.sortColumn===col.key?(state.sortDirection==='asc'?'%E2%86%91':'%E2%86%93'):''}%3C/th%3E%60).join('')}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/tr%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/thead%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},generateTableRow(item){return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctr%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyRow('${item.code}')%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${item.code}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20${item.polpln%20!==%20'-'%20?%20%60%3Cdiv%20class=%22polpln-text%22%3E${item.polpln}%3C/div%3E%60%20:%20''}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.commodityCode}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.name}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.cur}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.unit}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.type}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.start}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%20onclick=%22TableRenderer.copyCell(this)%22%3E${item.end}%3C/td%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/tr%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},generatePaginationControls(){const%20totalPages=Math.ceil(state.displayedDataArray.length/50);return%20%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22pagination%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20onclick=%22TableRenderer.changePage(${state.currentPage%20-%201})%22%20${state.currentPage%20===%201%20?%20'disabled'%20:%20''}%3E%E4%B8%8A%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%3E%E7%AC%AC%20${state.currentPage}%20%E9%A0%81%20/%20%E5%85%B1%20${totalPages}%20%E9%A0%81%3C/span%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20onclick=%22TableRenderer.changePage(${state.currentPage%20+%201})%22%20${state.currentPage%20===%20totalPages%20?%20'disabled'%20:%20''}%3E%E4%B8%8B%E4%B8%80%E9%A0%81%3C/button%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%20%20%20%20%20%20%20%20%20%20%20%20%60},changePage(page){const%20totalPages=Math.ceil(state.displayedDataArray.length/50);if(page%3E=1&&page%3C=totalPages){state.currentPage=page;this.render()}},bindCopyEvents(){const%20cells=document.querySelectorAll('#pcrTable%20td');cells.forEach(cell=%3E{cell.addEventListener('click',()=%3E{if(cell.onclick)return;this.copyCell(cell)})})},copyCell(cell){const%20text=cell.textContent.trim();navigator.clipboard.writeText(text).then(()=%3E{UI.showNotification(%60%E5%B7%B2%E8%A4%87%E8%A3%BD:%20${text}%60)}).catch(err=%3E{console.warn('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97',!0)})},copyRow(code){const%20item=state.displayedDataArray.find(item=%3Eitem.code===code);if(!item)return;const%20text=Object.values(item).slice(0,8).join('\t');navigator.clipboard.writeText(text).then(()=%3E{UI.showNotification(%60%E5%B7%B2%E8%A4%87%E8%A3%BD%E6%95%B4%E5%88%97:%20${item.code}%60)}).catch(err=%3E{console.warn('%E8%A4%87%E8%A3%BD%E6%95%B4%E5%88%97%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E8%A4%87%E8%A3%BD%E6%95%B4%E5%88%97%E5%A4%B1%E6%95%97',!0)})},copyAll(){const%20headers=['%E4%BB%A3%E8%99%9F','%E5%95%86%E5%93%81%E7%A2%BC','%E5%90%8D%E7%A8%B1','%E5%B9%A3%E5%88%A5','%E5%96%AE%E4%BD%8D','%E9%A1%9E%E5%9E%8B','%E9%8A%B7%E5%94%AE%E8%B5%B7%E6%97%A5','%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5'];const%20rows=state.displayedDataArray.map(item=%3EObject.values(item).slice(0,8).join('\t'));const%20text=[headers.join('\t'),...rows].join('\n');navigator.clipboard.writeText(text).then(()=%3E{UI.showNotification('%E5%B7%B2%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%E8%B3%87%E6%96%99')}).catch(err=%3E{console.warn('%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%E5%A4%B1%E6%95%97:',err);UI.showNotification('%E8%A4%87%E8%A3%BD%E5%85%A8%E9%83%A8%E5%A4%B1%E6%95%97',!0)})},toggleShowAllMode(){state.showAllMode=!state.showAllMode;this.render()}};window.bookmarkletFuncs={handleQuery:ProductQueryManager.handleQuery,applyFilter:(key,value)=%3E{state.currentFilters[key]=value;FilterManager.applyFilters();TableRenderer.render()},toggleSort:SortManager.toggleSort,validateAndStoreToken:TokenManager.validateAndStoreToken};async%20function%20startMainFlow(){const%20token=await%20TokenManager.getStoredToken();if(token){ProductQueryManager.startQuery()}else{TokenManager.promptForToken()}}startMainFlow()})()
＊＊＊＊＊第48段程式碼結束/162A /＊＊＊＊＊




＊＊＊＊＊第49段程式碼開始/166LJ /＊＊＊＊＊
javascript:(async function(){let currentPage=1;let totalPages=1;let allDataArray=[];const recordsPerPage=100;let currentToken;let displayedDataArray=[];let isShowingAllData=!1;const API_URL_PLANCODE_QUERY=
＊＊＊＊＊第49段程式碼結束/166LJ /＊＊＊＊＊




＊＊＊＊＊第50段程式碼開始/169W /＊＊＊＊＊
javascript:(()=>{'use strict';const APP_ID='query-app-container';const STYLE_ID='query-app-styles';const VERSION='2025-06-14';if(window.__KGI_QUERY_APP__){const $app=document.getElementById(APP_ID);$app.style.display=$app.style.display==='none'?%27flex%27:%27none%27;return}window.__KGI_QUERY_APP__=VERSION;const%20STYLE_TEXT=`:root{%20--font-family:%27Microsoft%20JhengHei%27,-apple-system,BlinkMacSystemFont,%22Segoe%20UI%22,Roboto,%22Helvetica%20Neue%22,Arial,%22Noto%20Sans%22,sans-serif;%20--primary:#007bff;--success:#28a745;--warning:#ffc107;--danger:#dc3545;--secondary:#6c757d;%20--light:#f8f9fa;--dark:#343a40;--border:#dee2e6;--shadow:0%206px%2024px%20rgba(0,0,0,.15);%20--radius:8px;--z-app:2147483630;--z-overlay:2147483640;--z-toast:2147483647;--speed:.25s;}#${APP_ID}{display:none;position:fixed;z-index:var(--z-app);left:50%;top:40px;transform:translateX(-50%);%20width:95%;max-width:1100px;max-height:90vh;background:#fff;border:1px%20solid%20var(--border);%20border-radius:var(--radius);box-shadow:var(--shadow);font-family:var(--font-family);%20display:flex;flex-direction:column;font-size:12px;}#${APP_ID}.show{display:flex;}.app-header{background:var(--dark);color:#fff;padding:12px%2020px;border-radius:var(--radius)%20var(--radius)%200%200;%20display:flex;align-items:center;gap:12px;cursor:grab;}.app-header%20h3{flex:1;margin:0;font-size:16px;font-weight:600;text-align:center;}.app-header%20.close-btn{background:none;border:none;color:#fff;font-size:24px;cursor:pointer;opacity:.85;}.app-controls{display:flex;flex-wrap:wrap;align-items:center;gap:14px;padding:12px%2020px;background:var(--light);%20border-bottom:1px%20solid%20var(--border);}.query-area{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-right:auto;}.query-area%20label{font-size:12px;display:flex;gap:4px;align-items:center;}.query-area%20input,.query-area%20select{padding:4px%208px;border:1px%20solid%20#ccc;border-radius:4px;font-size:12px;}.app-info{font-size:14px;font-weight:500;}.app-info%20strong{color:var(--primary);}.btn{border:none;padding:6px%2012px;border-radius:5px;font-size:12px;font-weight:600;cursor:pointer;%20transition:opacity%20var(--speed),transform%20.12s;}.btn:disabled{opacity:.5;cursor:not-allowed;}.btn-primary{background:var(--primary);color:#fff;}.btn-success{background:var(--success);color:#fff;}.btn-secondary{background:var(--secondary);color:#fff;}.btn-danger{background:var(--danger);color:#fff;}.table-wrap{flex:1;overflow:auto;border:1px%20solid%20var(--border);border-radius:6px;margin:0%2020px%2020px;}table{width:100%;border-collapse:collapse;font-size:12px;}th{background:var(--dark);color:#fff;padding:10px%2012px;text-align:center;position:sticky;top:0;%20user-select:none;cursor:pointer;border-bottom:2px%20solid%20#454d55;}td{padding:8px%2012px;border:1px%20solid%20var(--border);text-align:center;white-space:nowrap;}tbody%20tr:nth-child(even){background:#f8f9fa;}.row-error{background:#ffebee%20!important;color:#c62828;}.bg-y{background:yellow%20!important;}.pagination{display:flex;align-items:center;gap:6px;}.toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);padding:8px%2016px;border-radius:5px;%20color:#fff;font-size:13px;z-index:var(--z-toast);box-shadow:0%202px%208px%20rgba(0,0,0,.15);opacity:0;%20transition:opacity%20.5s,top%20.3s;}.toast.show{opacity:1;top:40px;}.toast.success{background:rgba(0,123,255,.9);}.toast.error{background:rgba(220,53,69,.9);}%60;const%20TEMPLATE=%60%3Cdiv%20class=%22app-header%22%3E%20%20%3Ch3%3E%E5%87%B1%E5%9F%BA%E4%BA%BA%E5%A3%BD%20%E5%95%86%E5%93%81%E6%9F%A5%E8%A9%A2%E5%B7%A5%E5%85%B7%3C/h3%3E%20%20%3Cbutton%20class=%22close-btn%22%20title=%22Close%22%3E×%3C/button%3E%3C/div%3E%3Cdiv%20class=%22app-controls%22%3E%20%20%3Cdiv%20class=%22query-area%22%3E%20%20%20%20%3Clabel%3E%E7%92%B0%E5%A2%83%20%20%20%20%20%20%3Cselect%20id=%22kgi-env%22%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22prod%22%3EPROD%3C/option%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22uat%22%3EUAT%3C/option%3E%20%20%20%20%20%20%3C/select%3E%20%20%20%20%3C/label%3E%20%20%20%20%3Clabel%3E%E9%8A%B7%E5%94%AE%E8%BF%84%E6%97%A5%20%20%20%20%20%20%3Cinput%20type=%22date%22%20id=%22kgi-end%22%20/%3E%20%20%20%20%3C/label%3E%20%20%20%20%3Clabel%3E%E5%95%86%E5%93%81%E9%A1%9E%E5%9E%8B%20%20%20%20%20%20%3Cselect%20id=%22kgi-type%22%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22%22%3E%E5%85%A8%E9%83%A8%3C/option%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22M%22%3E%E4%B8%BB%E7%B4%84%3C/option%3E%20%20%20%20%20%20%20%20%3Coption%20value=%22R%22%3E%E9%99%84%E7%B4%84%3C/option%3E%20%20%20%20%20%20%3C/select%3E%20%20%20%20%3C/label%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-primary%22%20id=%22btn-query%22%3E%E6%9F%A5%E8%A9%A2%3C/button%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-secondary%22%20id=%22btn-token%22%3E%E7%99%BB%E9%8C%84%E6%86%91%E8%AD%89%3C/button%3E%20%20%3C/div%3E%20%20%3Cdiv%20class=%22app-info%22%3E%E7%B8%BD%E5%85%B1%20%3Cstrong%3E0%3C/strong%3E%20%E7%AD%86%3C/div%3E%20%20%3Cdiv%20class=%22pagination%22%20id=%22pg%22%20hidden%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-secondary%22%20data-d=%22-1%22%3E%E2%9F%AA%3C/button%3E%20%20%20%20%3Cspan%20id=%22pg-text%22%3E%3C/span%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-secondary%22%20data-d=%221%22%3E%E2%9F%AB%3C/button%3E%20%20%3C/div%3E%20%20%3Cdiv%20style=%22display:flex;gap:8px;%22%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-success%22%20id=%22btn-copy%22%3E%E4%B8%80%E9%8D%B5%E8%A4%87%E8%A3%BD%3C/button%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-primary%22%20id=%22btn-detail%22%3E%E6%9C%AC%E9%A0%81%E8%A9%B3%E6%83%85%3C/button%3E%20%20%20%20%3Cbutton%20class=%22btn%20btn-danger%22%20id=%22btn-close%22%3E%E9%97%9C%E9%96%89%3C/button%3E%20%20%3C/div%3E%3C/div%3E%3Cdiv%20class=%22table-wrap%22%3E%20%20%3Ctable%3E%20%20%20%20%3Cthead%3E%3C/thead%3E%20%20%20%20%3Ctbody%3E%3C/tbody%3E%20%20%3C/table%3E%3C/div%3E%60;document.getElementById(APP_ID)?.remove();document.getElementById(STYLE_ID)?.remove();const%20styleEl=document.createElement('style');styleEl.id=STYLE_ID;styleEl.textContent=STYLE_TEXT;document.head.appendChild(styleEl);const%20$app=document.createElement('div');$app.id=APP_ID;$app.innerHTML=TEMPLATE;document.body.appendChild($app);$app.classList.add('show');const%20$=(sel,ctx=$app)=%3Ectx.querySelector(sel);const%20$$=(sel,ctx=$app)=%3EArray.from(ctx.querySelectorAll(sel));const%20today=()=%3Enew%20Date().toISOString().slice(0,10).replace(/-/g,'');const%20toast=(msg,type='success',ms=2500)=%3E{const%20n=document.createElement('div');n.className=%60toast%20${type}%60;n.textContent=msg;document.body.appendChild(n);void%20n.offsetWidth;n.classList.add('show');if(ms)setTimeout(()=%3E{n.classList.remove('show');n.addEventListener('transitionend',()=%3En.remove())},ms)};const%20escapeHtml=(s='')=%3E{const%20p=document.createElement('p');p.textContent=s;return%20p.innerHTML};const%20BATCH=50;const%20CFG={API:{prod:{query:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',detail:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',sale:'https://euisv.apps.ocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'},uat:{query:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/query',detail:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',sale:'https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeSaleDateController/query'}},STORE:{TOKEN:'kgiToken',ENV:'kgiEnv'},MAX:{SIZE:5000},MAP:{CUR:{1:'TWD',2:'USD',3:'AUD',4:'CNT',5:'USD'},UNIT:{A1:'%E5%85%83',A3:'%E4%BB%9F%E5%85%83',A4:'%E8%90%AC%E5%85%83',B1:'%E8%A8%88%E7%95%AB',C1:'%E5%96%AE%E4%BD%8D'},TYPE:{M:'%E4%B8%BB%E7%B4%84',R:'%E9%99%84%E7%B4%84'}}};const%20state={env:localStorage.getItem(CFG.STORE.ENV)||'prod',token:localStorage.getItem(CFG.STORE.TOKEN)||'',rows:[],total:0,page:1,pages:1,sort:{key:'_idx',dir:1}};$('#kgi-env').value=state.env;const%20info=$('.app-info');const%20tbody=$('tbody');const%20thead=$('thead');const%20pgWrap=$('#pg');const%20pgText=$('#pg-text');const%20api=async(k,body)=%3E{const%20url=CFG.API[state.env][k];try{const%20res=await%20fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...(state.token&&{'SSO-TOKEN':state.token})},body:JSON.stringify(body)});if(!res.ok)throw%20new%20Error(res.status);return%20res.json()}catch(e){return{error:!0,message:e.message}}};const%20COLS=[{key:'_idx',title:'No',sort:1},{key:'code',title:'%E4%BB%A3%E8%99%9F',sort:1},{key:'name',title:'%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1',sort:1},{key:'cur',title:'%E5%B9%A3%E5%88%A5',sort:1},{key:'unit',title:'%E5%96%AE%E4%BD%8D',sort:1},{key:'type',title:'%E9%A1%9E%E5%9E%8B',sort:1},{key:'start',title:'%E9%8A%B7%E5%94%AE%E8%B5%B7',sort:1},{key:'disp',title:'%E9%8A%B7%E5%94%AE%E8%BF%84%20/%20%E9%80%9A%E8%B7%AF'}];const%20buildHead=()=%3E{thead.innerHTML='';const%20tr=document.createElement('tr');COLS.forEach(c=%3E{const%20th=document.createElement('th');th.textContent=c.title;if(c.sort){if(state.sort.key===c.key)th.textContent+=state.sort.dir===1?'%20%E2%96%B2':'%20%E2%96%BC';th.dataset.key=c.key;th.onclick=()=%3Esort(c.key)}tr.appendChild(th)});thead.appendChild(tr)};const%20render=()=%3E{info.innerHTML=%60%E7%B8%BD%E5%85%B1%20%3Cstrong%3E${state.total}%3C/strong%3E%20%E7%AD%86%60;state.pages=Math.max(1,Math.ceil(state.rows.length/BATCH));pgWrap.hidden=state.pages===1;if(!pgWrap.hidden){pgText.textContent=%60%E7%AC%AC%20${state.page}/${state.pages}%20%E9%A0%81%60;$$('[data-d]',pgWrap).forEach(b=%3E{b.disabled=(state.page===1&&b.dataset.d==='-1')||(state.page===state.pages&&b.dataset.d==='1')})}const%20start=(state.page-1)*BATCH;const%20view=state.rows.slice(start,start+BATCH);tbody.innerHTML=view.map(r=%3E{const%20cls=[r.error?'row-error':'',r.yellow?'bg-y':''].join('%20');return%20%60%3Ctr%20class=%22${cls}%22%20data-i=%22${r._idx}%22%3E%20%20%20%20%20%20%20%20%3Ctd%3E${r._idx%20+%201}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.codePlain}%22%20class=%22copy%22%3E${r.code}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.name}%22%20%20%20%20%20class=%22copy%22%20style=%22text-align:left;white-space:normal;%22%3E${r.name}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%3E${r.cur}%3C/td%3E%3Ctd%3E${r.unit}%3C/td%3E%3Ctd%3E${r.type}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.start}%22%20%20%20%20class=%22copy%22%3E${r.start}%3C/td%3E%20%20%20%20%20%20%20%20%3Ctd%20data-copy=%22${r.copyDisp}%22%20class=%22copy%22%20style=%22text-align:left;white-space:normal;%22%3E${r.disp}%3C/td%3E%20%20%20%20%20%20%3C/tr%3E%60}).join('')};const%20sort=key=%3E{state.sort.dir=state.sort.key===key?-state.sort.dir:1;state.sort.key=key;const%20dir=state.sort.dir;state.rows.sort((a,b)=%3E(''+(a[key]??'')).localeCompare(''+(b[key]??''),'zh-Hant-TW',{numeric:!0})*dir);state.page=1;buildHead();render()};const%20polText=recs=%3E{if(!recs?.length)return%20null;const%20vals=[...new%20Set(recs.map(r=%3E(r.polpln||'').replace(/^\d+|\d+$/g,'').replace(/%%$/,'').trim()).filter(Boolean))];return%20vals.length?vals.join('%E3%80%81'):null};const%20channelInfo=(data,baseHtml,selling,row)=%3E{if(data?.error)return{html:%60${baseHtml}%3Cbr%3E%3Cspan%20style=%22color:orange;%22%3E${data.message}%3C/span%3E%60,txt:baseHtml};const%20todayStr=today();const%20recs=data?.planCodeSaleDates?.records||[];const%20arr=recs.map(r=%3E{const%20end=(r.saleEndDate||'').replace(/-/g,'');const%20start=(r.saleStartDate||'').replace(/-/g,'');const%20on=!end||end==='99991231'||end%3E=todayStr;const%20ch=escapeHtml(r.channel||'%E6%9C%AA%E7%9F%A5');const%20title=%60${ch}%20%E5%8F%AF%E5%94%AE%20${start||'%E6%9C%AA%E7%9F%A5'}~${end==='99991231'?'%E6%8C%81%E7%BA%8C%E9%8A%B7%E5%94%AE':end||'%E6%9C%AA%E7%9F%A5'}%60;return{on,html:%60%3Cspan%20title=%22${title}%22%20style=%22color:${on?'blue':'red'};%22%3E${ch}${on?'':%60(${end})%60}%3C/span%3E%60,plain:%60${ch}${on?'':%60(${end})%60}%60}});if(!arr.length)return{html:%60${baseHtml}%3Cbr%3E%3Ci%20style=%22color:#777%22%3E(%E7%84%A1%E9%80%9A%E8%B7%AF%E8%B3%87%E6%96%99)%3C/i%3E%60,txt:%60${baseHtml}\n(%E7%84%A1%E9%80%9A%E8%B7%AF%E8%B3%87%E6%96%99)%60};const%20ons=arr.filter(a=%3Ea.on);const%20offs=arr.filter(a=%3E!a.on);let%20html=baseHtml+'%3Cdiv%20style=%22text-align:left;margin-top:4px%22%3E';if(ons.length)html+='%E5%8F%AF%E5%94%AE%EF%BC%9A'+ons.map(a=%3Ea.html).join('%E3%80%81')+'%3Cbr%3E';if(offs.length)html+='%E5%81%9C%E5%94%AE%EF%BC%9A'+offs.map(a=%3Ea.html).join('%E3%80%81');html+='%3C/div%3E';const%20txt=['%E5%8F%AF%E5%94%AE%EF%BC%9A'+ons.map(a=%3Ea.plain).join('%E3%80%81'),offs.length?'%E5%81%9C%E5%94%AE%EF%BC%9A'+offs.map(a=%3Ea.plain).join('%E3%80%81'):''].filter(Boolean).join('\n');if(!selling&&ons.length)row.yellow=!0;return{html,txt}};const%20fetchDetail=async%20row=%3E{if(row._loaded||row.error)return;row._loaded=!0;const%20tr=tbody.querySelector(%60tr[data-i=%22${row._idx}%22]%60);if(tr)tr.classList.add('loading');try{const[pd,sd]=await%20Promise.all([api('detail',{planCode:row.codePlain,pageNo:1,pageSize:20}),api('sale',{planCode:row.codePlain,pageNo:1,pageSize:50})]);const%20pol=polText(pd?.records);if(pol)row.code=%60${row.code}%3Cbr%3E%3Cspan%20style=%22color:green;font-weight:bold;%22%3E${escapeHtml(pol)}%3C/span%3E%60;const%20chan=channelInfo(sd,row.baseHtml,row.selling,row);row.disp=chan.html;row.copyDisp=chan.txt}catch{}render()};const%20transform=(rec,i)=%3E{const%20st=(rec.saleStartDate||'').replace(/-/g,'')||'-';const%20ed=(rec.saleEndDate||'').replace(/-/g,'')||'-';const%20selling=ed==='99991231'||ed%3E=today();const%20baseHtml=selling?'%3Cspan%20style=%22color:blue;font-weight:bold;%22%3E%E7%8F%BE%E5%94%AE%E4%B8%AD%3C/span%3E':ed!=='-'?%60%3Cspan%20style=%22color:red;%22%3E${ed}%3C/span%3E%60:'-';return{_idx:i,codePlain:rec.planCode,code:escapeHtml(rec.planCode),name:escapeHtml((rec.shortName||'').trim()||'N/A'),cur:CFG.MAP.CUR[rec.currency]||'-',unit:CFG.MAP.UNIT[(rec.reportInsuranceAmountUnit||'').toUpperCase()]||'-',type:CFG.MAP.TYPE[rec.coverageType]||'-',start:st,disp:baseHtml,baseHtml,copyDisp:baseHtml.replace(/%3C[^%3E]*%3E/g,''),selling}};const%20query=async()=%3E{state.rows=[];toast('%E6%9F%A5%E8%A9%A2%E4%B8%AD%E2%80%A6','success',0);const%20end=$('#kgi-end').value||'9999-12-31';const%20type=$('#kgi-type').value;const%20res=await%20api('query',{pageSize:CFG.MAX.SIZE,saleEndDate:end,...(type&&{coverageType:type})});if(res.error){toast(res.message,'error');return}state.rows=(res.records||[]).map(transform);state.total=state.rows.length;state.page=1;buildHead();render();toast(%60%E5%8F%96%E5%BE%97%20${state.total}%20%E7%AD%86%E8%B3%87%E6%96%99%60)};$('#btn-query').onclick=query;$('#kgi-env').onchange=e=%3E{state.env=e.target.value;localStorage.setItem(CFG.STORE.ENV,state.env)};$('#btn-token').onclick=async()=%3E{const%20t=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5%20SSO%20TOKEN',state.token);if(t!==null){state.token=t.trim();localStorage.setItem(CFG.STORE.TOKEN,state.token);toast('%E6%86%91%E8%AD%89%E5%B7%B2%E6%9B%B4%E6%96%B0')}};$('#btn-close').onclick=()=%3E{$app.style.display='none'};$('.close-btn').onclick=()=%3E{$app.style.display='none'};$('#btn-copy').onclick=async()=%3E{let%20txt=COLS.map(c=%3Ec.title).join('\t')+'\n';state.rows.forEach(r=%3E{txt+=[r._idx+1,r.codePlain,r.name,r.cur,r.unit,r.type,r.start,r.copyDisp.replace(/%3C[^%3E]*%3E/g,'')].join('\t')+'\n'});try{await%20navigator.clipboard.writeText(txt);toast('%E8%A1%A8%E6%A0%BC%E5%B7%B2%E8%A4%87%E8%A3%BD%EF%BC%81')}catch{toast('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97','error')}};$('#btn-detail').onclick=async()=%3E{const%20start=(state.page-1)*BATCH;const%20list=state.rows.slice(start,start+BATCH).filter(r=%3E!r._loaded&&!r.error);if(!list.length){toast('%E5%B7%B2%E8%BC%89%E5%85%A5');return}toast(%60%E6%9F%A5%E8%A9%A2%20${list.length}%20%E7%AD%86%E8%A9%B3%E6%83%85%E2%80%A6%60,'success',0);for(const%20r%20of%20list)await%20fetchDetail(r);toast('%E5%AE%8C%E6%88%90')};tbody.onclick=e=%3E{const%20td=e.target.closest('.copy');if(td){navigator.clipboard.writeText(td.dataset.copy).then(()=%3Etoast('%E5%B7%B2%E8%A4%87%E8%A3%BD')).catch(()=%3Etoast('%E8%A4%87%E8%A3%BD%E5%A4%B1%E6%95%97','error'));return}const%20tr=e.target.closest('tr');if(tr)fetchDetail(state.rows[+tr.dataset.i]);};pgWrap.onclick=e=%3E{const%20d=+e.target.dataset.d;if(d){state.page+=d;render()}};(()=%3E{const%20hd=$('.app-header');let%20sx=0,sy=0,l=0,t=0,drag=!1;hd.onmousedown=e=%3E{if(e.target.closest('button'))return;drag=!0;sx=e.clientX;sy=e.clientY;const%20r=$app.getBoundingClientRect();l=r.left;t=r.top;hd.style.cursor='grabbing';document.onmousemove=m=%3E{if(!drag)return;$app.style.left=l+m.clientX-sx+'px';$app.style.top=t+m.clientY-sy+'px';$app.style.transform='none'};document.onmouseup=()=%3E{drag=!1;hd.style.cursor='grab';document.onmousemove=null}}})();document.onkeydown=e=%3E{if(e.key==='Escape')$app.style.display='none'};query()})()
＊＊＊＊＊第50段程式碼結束/169W /＊＊＊＊＊




＊＊＊＊＊第51段程式碼開始/200Failed /＊＊＊＊＊
javascript:(function(){async function() {    // %E5%AE%9A%E7%BE%A9API URL%E5%B8%B8%E6%95%B8    const API_URL = {        PLANCODE_QUERY:
＊＊＊＊＊第51段程式碼結束/200Failed /＊＊＊＊＊




＊＊＊＊＊第52段程式碼開始/205商品n /＊＊＊＊＊
javascript:(async()=>{var t=localStorage.getItem('euisPlanCodeToken')||prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5 SSO-TOKEN');if(!t)return;localStorage.setItem('euisPlanCodeToken',t);var e=prompt('%E8%AB%8B%E8%BC%B8%E5%85%A5 PlanCode%EF%BC%88%E5%A4%9A%E5%80%8B%E7%94%A8%E7%A9%BA%E6%A0%BC/%E9%80%97%E8%99%9F%E5%88%86%E9%9A%94%EF%BC%89');if(!e)return;var n=e.split(/[\s,;]+/).map(e=>e.trim().toUpperCase()).filter(e=>e);var o=[];var seenKeys=new Set();for(var p of n){try{var res=await fetch('https://euisv-uat.apps.tocp4.kgilife.com.tw/euisw/euisbq/api/planCodeController/queryDetail',{method:'POST',headers:{'Content-Type':'application/json','SSO-TOKEN':t},body:JSON.stringify({planCode:p})});var data=await res.json();if(data.records&&data.records.length>0){data.records.forEach(rec=>{var parts=rec.polpln.match(/(\d+)|([A-Za-z]+)/g)||[];var key=`${rec.planCode}-${parts[0]||''}-${parts[1]||''}`;if(!seenKeys.has(key)){seenKeys.add(key);o.push({PlanCode:rec.planCode,%E5%B9%B4%E6%9C%9F:parts[0]||'',%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1:parts[1]||''})}})}}catch(err){console.error(`%E6%9F%A5%E8%A9%A2PlanCode ${p} %E6%99%82%E7%99%BC%E7%94%9F%E9%8C%AF%E8%AA%A4:`, err);}}var makeCSV=()=>[['PlanCode','%E5%B9%B4%E6%9C%9F','%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1'],...o.map(r=>[r.PlanCode,r.%E5%B9%B4%E6%9C%9F,r.%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1])].map(r=>r.join(',')).join('\n');var c=document.createElement('div');c.id='planCodeResult';var isDragging=false,offsetX,offsetY;c.style='position:fixed;top:50px;left:50%;transform:translateX(-50%);z-index:99999;background:#fff;padding:20px;border-radius:8px;box-shadow:0%205px%2015px%20rgba(0,0,0,0.3);max-width:80vw;max-height:80vh;overflow:auto;font-family:Arial;resize:both;min-width:400px;min-height:200px;border:1px%20solid%20#ccc;';c.addEventListener('mousedown',ev=%3E{if(ev.target.tagName!=='TD'&&ev.target.tagName!=='TH'){isDragging=true;offsetX=ev.clientX-c.getBoundingClientRect().left;offsetY=ev.clientY-c.getBoundingClientRect().top;c.style.cursor='grabbing'}});document.addEventListener('mousemove',ev=%3E{if(isDragging){c.style.left=%60${ev.clientX-offsetX}px%60;c.style.top=%60${ev.clientY-offsetY}px%60;c.style.transform='none'}});document.addEventListener('mouseup',()=%3E{isDragging=false;c.style.cursor='grab'});document.addEventListener('keydown',ev=%3E{if(ev.key==='Escape')c.remove()});c.innerHTML=%60%3Cdiv%20style=%22margin-bottom:15px;display:flex;justify-content:space-between;align-items:center;cursor:move%22%3E%3Ch3%20style=%22margin:0%22%3E%E4%BF%9D%E5%96%AE%E8%A8%88%E5%8A%83%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%3C/h3%3E%3Cdiv%3E%3Cbutton%20id=%22downloadBtn%22%20style=%22background:#2ecc71;color:white;border:none;padding:8px%2015px;border-radius:4px;cursor:pointer;margin-right:10px%22%3E%E4%B8%8B%E8%BC%89%20CSV%3C/button%3E%3Cbutton%20onclick=%22this.parentNode.parentNode.parentNode.remove()%22%20style=%22background:#e74c3c;color:white;border:none;padding:8px%2015px;border-radius:4px;cursor:pointer%22%3E%E9%97%9C%E9%96%89%3C/button%3E%3C/div%3E%3C/div%3E%3Ctable%20style=%22border-collapse:collapse;width:100%%22%3E%3Cthead%3E%3Ctr%20style=%22background:#3498db;color:white%22%3E%3Cth%20style=%22padding:8px%2012px;text-align:left%22%3EPlanCode%3C/th%3E%3Cth%20style=%22padding:8px%2012px;text-align:left%22%3E%E5%B9%B4%E6%9C%9F%3C/th%3E%3Cth%20style=%22padding:8px%2012px;text-align:left%22%3E%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1%3C/th%3E%3C/tr%3E%3C/thead%3E%3Ctbody%3E${o.map(r=%3E%60%3Ctr%20style=%22border-bottom:1px%20solid%20#eee%22%3E%3Ctd%20onclick=%22navigator.clipboard.writeText('${r.PlanCode}').then(()=%3E{var%20msg=document.createElement('div');msg.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD';msg.style='position:fixed;background:rgba(0,0,0,0.7);color:white;padding:2px%205px;border-radius:3px;z-index:999999;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;';document.body.appendChild(msg);setTimeout(()=%3Emsg.remove(),1000)})%22%20style=%22padding:8px%2012px;cursor:pointer%22%3E${r.PlanCode||''}%3C/td%3E%3Ctd%20onclick=%22navigator.clipboard.writeText('${r.%E5%B9%B4%E6%9C%9F}').then(()=%3E{var%20msg=document.createElement('div');msg.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD';msg.style='position:fixed;background:rgba(0,0,0,0.7);color:white;padding:2px%205px;border-radius:3px;z-index:999999;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;';document.body.appendChild(msg);setTimeout(()=%3Emsg.remove(),1000)})%22%20style=%22padding:8px%2012px;cursor:pointer%22%3E${r.%E5%B9%B4%E6%9C%9F||''}%3C/td%3E%3Ctd%20onclick=%22navigator.clipboard.writeText('${r.%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1}').then(()=%3E{var%20msg=document.createElement('div');msg.textContent='%E5%B7%B2%E8%A4%87%E8%A3%BD';msg.style='position:fixed;background:rgba(0,0,0,0.7);color:white;padding:2px%205px;border-radius:3px;z-index:999999;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;';document.body.appendChild(msg);setTimeout(()=%3Emsg.remove(),1000)})%22%20style=%22padding:8px%2012px;cursor:pointer%22%3E${r.%E5%95%86%E5%93%81%E5%90%8D%E7%A8%B1||''}%3C/td%3E%3C/tr%3E%60).join('')}%3C/tbody%3E%3C/table%3E%60;document.body.appendChild(c);var%20downloadButton=c.querySelector('#downloadBtn');downloadButton.addEventListener('click',()=%3E{var%20csvData=makeCSV();var%20a=document.createElement('a');a.href='data:text/csv;charset=utf-8,\ufeff'+encodeURIComponent(csvData);a.download='%E4%BF%9D%E5%96%AE%E8%A8%88%E5%8A%83%E6%9F%A5%E8%A9%A2_'+new%20Date().toISOString().slice(0,10)+'.csv';document.body.appendChild(a);a.click();setTimeout(()=%3Ea.remove(),250);});})();
＊＊＊＊＊第52段程式碼結束/205商品n /＊＊＊＊＊




＊＊＊＊＊第53段程式碼開始/183優化版本 /＊＊＊＊＊
javascript:(function(){   // %E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE   const CONFIG = {     maxApiEntries: 100,       // %E6%9C%80%E5%A4%A7API%E8%A8%98%E9%8C%84%E6%95%B8%E9%87%8F     maxTokenDisplay: 10,      // %E4%BB%A4%E7%89%8C%E9%A1%AF%E7%A4%BA%E9%95%B7%E5%BA%A6     refreshInterval: 1000,    // UI%E6%9B%B4%E6%96%B0%E9%96%93%E9%9A%94(ms)     theme: {       light: {         bg: '#fff',%20%20%20%20%20%20%20%20%20text:%20'#333',%20%20%20%20%20%20%20%20%20primary:%20'#4a6cf7',%20%20%20%20%20%20%20%20%20secondary:%20'#f0f2f5',%20%20%20%20%20%20%20%20%20border:%20'#ddd'%20%20%20%20%20%20%20},%20%20%20%20%20%20%20dark:%20{%20%20%20%20%20%20%20%20%20bg:%20'#1f2937',%20%20%20%20%20%20%20%20%20text:%20'#f3f4f6',%20%20%20%20%20%20%20%20%20primary:%20'#3b82f6',%20%20%20%20%20%20%20%20%20secondary:%20'#374151',%20%20%20%20%20%20%20%20%20border:%20'#4b5563'%20%20%20%20%20%20%20}%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20%E5%85%A8%E5%B1%80%E7%8B%80%E6%85%8B%20%20%20const%20STATE%20=%20{%20%20%20%20%20apiInfo:%20{%20%20%20%20%20%20%20endpoints:%20[],%20%20%20%20%20%20%20tokens:%20[],%20%20%20%20%20%20%20page:%20window.location.href,%20%20%20%20%20%20%20title:%20document.title,%20%20%20%20%20%20%20timestamp:%20new%20Date().toISOString()%20%20%20%20%20},%20%20%20%20%20settings:%20{%20%20%20%20%20%20%20darkMode:%20window.matchMedia('(prefers-color-scheme:%20dark)').matches,%20%20%20%20%20%20%20maskTokens:%20true,%20%20%20%20%20%20%20filterText:%20'',%20%20%20%20%20%20%20showOnlyErrors:%20false,%20%20%20%20%20%20%20sortBy:%20'time',%20//%20'time',%20'url',%20'method',%20'status'%20%20%20%20%20%20%20groupBy:%20'none',%20//%20'none',%20'endpoint',%20'status'%20%20%20%20%20%20%20activeTab:%20'endpoints'%20//%20'endpoints',%20'tokens',%20'visualization',%20'settings'%20%20%20%20%20},%20%20%20%20%20wsConnections:%20new%20Set(),%20%20%20%20%20interceptedWebsockets:%200,%20%20%20%20%20interceptedXHR:%200,%20%20%20%20%20interceptedFetch:%200,%20%20%20%20%20showLabels:%20true,%20%20%20%20%20showHeaders:%20false,%20%20%20%20%20expandedItems:%20new%20Set(),%20%20%20%20%20selectedRequestForReplay:%20null%20%20%20};%20%20%20%20//%20%E5%B7%A5%E5%85%B7%E9%A1%9E%E5%87%BD%E6%95%B8%20%20%20const%20Utils%20=%20{%20%20%20%20%20//%20DOM%E6%93%8D%E4%BD%9C%20%20%20%20%20createEl(tag,%20attributes%20=%20{},%20styles%20=%20{},%20innerHTML%20=%20'')%20{%20%20%20%20%20%20%20const%20el%20=%20document.createElement(tag);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%B1%AC%E6%80%A7%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(attributes))%20{%20%20%20%20%20%20%20%20%20if%20(key%20===%20'className')%20{%20%20%20%20%20%20%20%20%20%20%20el.className%20=%20value;%20%20%20%20%20%20%20%20%20}%20else%20if%20(key%20===%20'dataset')%20{%20%20%20%20%20%20%20%20%20%20%20for%20(const%20[dataKey,%20dataValue]%20of%20Object.entries(value))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20el.dataset[dataKey]%20=%20dataValue;%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20el.setAttribute(key,%20value);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(styles))%20{%20%20%20%20%20%20%20%20%20el.style[key]%20=%20value;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%85%A7%E5%AE%B9%20%20%20%20%20%20%20if%20(innerHTML)%20{%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20innerHTML;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20el;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E4%BA%8B%E4%BB%B6%E7%9B%A3%E8%81%BD%E7%B0%A1%E5%8C%96%E7%89%88%20%20%20%20%20on(el,%20event,%20handler)%20{%20%20%20%20%20%20%20el.addEventListener(event,%20handler);%20%20%20%20%20%20%20return%20()%20=%3E%20el.removeEventListener(event,%20handler);%20//%20%E8%BF%94%E5%9B%9E%E7%A7%BB%E9%99%A4%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%87%BD%E6%95%B8%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E5%BA%A6%E8%A4%87%E8%A3%BD%E5%B0%8D%E8%B1%A1%20%20%20%20%20deepClone(obj)%20{%20%20%20%20%20%20%20return%20JSON.parse(JSON.stringify(obj));%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%A5%E6%9C%9F%20%20%20%20%20formatDate(date)%20{%20%20%20%20%20%20%20return%20new%20Date(date).toLocaleString();%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%89%E5%85%A8%E5%9C%B0%E8%A7%A3%E6%9E%90JSON%20%20%20%20%20parseJSON(str)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20return%20JSON.parse(str);%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20str;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96JSON%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20formatJSON(obj)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(typeof%20obj%20===%20'string')%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(JSON.parse(obj),%20null,%202);%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(obj,%20null,%202);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20String(obj);%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%88%AA%E6%96%B7%E9%95%B7%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20truncate(str,%20length%20=%20100)%20{%20%20%20%20%20%20%20if%20(!str)%20return%20'';%20%20%20%20%20%20%20str%20=%20String(str);%20%20%20%20%20%20%20return%20str.length%20%3C=%20length%20?%20str%20:%20%60${str.substring(0,%20length)}...%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%81%AE%E8%94%BD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%20%20%20%20%20maskSensitive(str,%20showChars%20=%204)%20{%20%20%20%20%20%20%20if%20(!str%20||%20str.length%20%3C=%20showChars%20*%202)%20return%20str;%20%20%20%20%20%20%20return%20%60${str.substring(0,%20showChars)}...${str.substring(str.length%20-%20showChars)}%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96URL%EF%BC%88%E7%A7%BB%E9%99%A4%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%EF%BC%89%20%20%20%20%20formatURL(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20return%20%60${urlObj.origin}${urlObj.pathname}%60;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20url;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%8F%90%E5%8F%96URL%E7%9A%84%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%20%20%20%20%20getURLParams(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20params%20=%20{};%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20urlObj.searchParams.entries())%20{%20%20%20%20%20%20%20%20%20%20%20params[key]%20=%20value;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20params;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20{};%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%AB%98%E4%BA%AEJSON%20%20%20%20%20syntaxHighlight(json)%20{%20%20%20%20%20%20%20if%20(!json)%20return%20'';%20%20%20%20%20%20%20json%20=%20json.replace(/&/g,%20'&').replace(/%3C/g,%20'<').replace(/%3E/g,%20'>');%20%20%20%20%20%20%20return%20json.replace(/(%22(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\%22])*%22(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,%20function%20(match)%20{%20%20%20%20%20%20%20%20%20let%20cls%20=%20'number';%20%20%20%20%20%20%20%20%20if%20(/^%22/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20if%20(/:$/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'key';%20%20%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'string';%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20if%20(/true|false/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'boolean';%20%20%20%20%20%20%20%20%20}%20else%20if%20(/null/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'null';%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20'%3Cspan%20class=%22'%20+%20cls%20+%20'%22%3E'%20+%20match%20+%20'%3C/span%3E';%20%20%20%20%20%20%20});%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BCJWT%E4%BB%A4%E7%89%8C%20%20%20%20%20decodeJWT(token)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(!token%20||%20typeof%20token%20!==%20'string'%20||%20!token.includes('.'))%20{%20%20%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%88%86%E5%89%B2%E4%BB%A4%E7%89%8C%20%20%20%20%20%20%20%20%20const%20parts%20=%20token.split('.');%20%20%20%20%20%20%20%20%20if%20(parts.length%20!==%203)%20return%20null;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BC%E6%AF%8F%E5%80%8B%E9%83%A8%E5%88%86%20%20%20%20%20%20%20%20%20const%20header%20=%20JSON.parse(atob(parts[0]));%20%20%20%20%20%20%20%20%20const%20payload%20=%20JSON.parse(atob(parts[1]));%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E9%81%8E%E6%9C%9F%E6%99%82%E9%96%93%20%20%20%20%20%20%20%20%20let%20isExpired%20=%20false;%20%20%20%20%20%20%20%20%20if%20(payload.exp)%20{%20%20%20%20%20%20%20%20%20%20%20isExpired%20=%20Date.now()%20%3E=%20payload.exp%20*%201000;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20%20%20header,%20%20%20%20%20%20%20%20%20%20%20payload,%20%20%20%20%20%20%20%20%20%20%20isExpired,%20%20%20%20%20%20%20%20%20%20%20expiresAt:%20payload.exp%20?%20new%20Date(payload.exp%20*%201000).toLocaleString()%20:%20'Unknown'%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20console.error('JWT%E8%A7%A3%E7%A2%BC%E5%A4%B1%E6%95%97:',%20e);%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E7%B0%A1%E5%96%AE%E7%9A%84%E5%9C%96%E8%A1%A8%20%20%20%20%20createBarChart(data,%20labels,%20options%20=%20{})%20{%20%20%20%20%20%20%20const%20{%20width%20=%20300,%20height%20=%20200,%20barColor%20=%20'#4a6cf7'%20}%20=%20options;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9C%80%E5%A4%A7%E5%80%BC%E8%A8%88%E7%AE%97%20%20%20%20%20%20%20const%20maxValue%20=%20Math.max(...data);%20%20%20%20%20%20%20const%20svg%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'svg');%20%20%20%20%20%20%20svg.setAttribute('width',%20width);%20%20%20%20%20%20%20svg.setAttribute('height',%20height);%20%20%20%20%20%20%20svg.style.overflow%20=%20'visible';%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%88%E7%AE%97bar%E7%9A%84%E5%AF%AC%E5%BA%A6%E5%92%8C%E9%96%93%E8%B7%9D%20%20%20%20%20%20%20const%20barWidth%20=%20(width%20/%20data.length)%20*%200.7;%20%20%20%20%20%20%20const%20barGap%20=%20(width%20/%20data.length)%20*%200.3;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BD%E6%AF%8F%E5%80%8Bbar%20%20%20%20%20%20%20data.forEach((value,%20i)%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20barHeight%20=%20(value%20/%20maxValue)%20*%20(height%20-%2030);%20%20%20%20%20%20%20%20%20const%20x%20=%20i%20*%20(barWidth%20+%20barGap);%20%20%20%20%20%20%20%20%20const%20y%20=%20height%20-%20barHeight%20-%2020;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BDbar%20%20%20%20%20%20%20%20%20const%20bar%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'rect');%20%20%20%20%20%20%20%20%20bar.setAttribute('x',%20x);%20%20%20%20%20%20%20%20%20bar.setAttribute('y',%20y);%20%20%20%20%20%20%20%20%20bar.setAttribute('width',%20barWidth);%20%20%20%20%20%20%20%20%20bar.setAttribute('height',%20barHeight);%20%20%20%20%20%20%20%20%20bar.setAttribute('fill',%20barColor);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%95%B8%E5%80%BC%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20text%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20text.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20text.setAttribute('y',%20y%20-%205);%20%20%20%20%20%20%20%20%20text.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20text.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20text.textContent%20=%20value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0x%E8%BB%B8%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20label%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20label.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20label.setAttribute('y',%20height%20-%205);%20%20%20%20%20%20%20%20%20label.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20label.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20label.textContent%20=%20labels[i]%20||%20'';%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg.appendChild(bar);%20%20%20%20%20%20%20%20%20svg.appendChild(text);%20%20%20%20%20%20%20%20%20svg.appendChild(label);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20svg;%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20UI%E6%A7%8B%E5%BB%BA%E5%99%A8%20%20%20const%20UI%20=%20{%20%20%20%20%20//%20%E5%9F%BA%E6%9C%ACUI%E5%85%83%E7%B4%A0%E6%A8%A3%E5%BC%8F%20%20%20%20%20getStyles(darkMode)%20{%20%20%20%20%20%20%20const%20theme%20=%20darkMode%20?%20CONFIG.theme.dark%20:%20CONFIG.theme.light;%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20container:%20%60%20%20%20%20%20%20%20%20%20%20%20position:%20fixed;%20%20%20%20%20%20%20%20%20%20%20top:%2020px;%20%20%20%20%20%20%20%20%20%20%20right:%2020px;%20%20%20%20%20%20%20%20%20%20%20width:%20400px;%20%20%20%20%20%20%20%20%20%20%20max-height:%2080vh;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20border-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20box-shadow:%200%200%2020px%20rgba(0,0,0,0.3);%20%20%20%20%20%20%20%20%20%20%20z-index:%209999999;%20%20%20%20%20%20%20%20%20%20%20font-family:%20sans-serif;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.3s%20ease;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20header:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%2015px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20cursor:%20move;%20%20%20%20%20%20%20%20%20%20%20user-select:%20none;%20%20%20%20%20%20%20%20%20%20%20border-top-left-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20border-top-right-radius:%208px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20content:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2015px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20flex-grow:%201;%20%20%20%20%20%20%20%20%20%20%20max-height:%20calc(80vh%20-%20110px);%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabs:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tab:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2015px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTab:%20%60%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%202px%20solid%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20button:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20smallButton:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%202px%208px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panel:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelHeader:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelContent:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20line-height:%201.5;%20%20%20%20%20%20%20%20%20%20%20border-top:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20input:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%2095%;%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20select:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20label:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20checkbox:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20jsonView:%20%60%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20font-size:%2011px;%20%20%20%20%20%20%20%20%20%20%20padding:%205px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%203px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20200px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20badge:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20actionBar:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-wrap:%20wrap;%20%20%20%20%20%20%20%20%20%20%20gap:%208px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20none;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%200;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20resultText:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%20100%;%20%20%20%20%20%20%20%20%20%20%20min-height:%20100px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20400px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20infoRow:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20chip:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20margin-right:%204px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%204px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20//%20%E8%AA%9E%E6%B3%95%E9%AB%98%E4%BA%AE%20%20%20%20%20%20%20%20%20syntaxHighlight:%20%60%20%20%20%20%20%20%20%20%20%20%20.string%20{%20color:%20#28a745;%20}%20%20%20%20%20%20%20%20%20%20%20.number%20{%20color:%20#17a2b8;%20}%20%20%20%20%20%20%20%20%20%20%20.boolean%20{%20color:%20#6f42c1;%20}%20%20%20%20%20%20%20%20%20%20%20.null%20{%20color:%20#dc3545;%20}%20%20%20%20%20%20%20%20%20%20%20.key%20{%20color:%20#007bff;%20}%20%20%20%20%20%20%20%20%20%60%20%20%20%20%20%20%20};%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E8%A6%81UI%20%20%20%20%20createMainUI()%20{%20%20%20%20%20%20%20const%20styles%20=%20this.getStyles(STATE.settings.darkMode);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E6%98%AF%E5%90%A6%E5%B7%B2%E7%B6%93%E5%AD%98%E5%9C%A8%20%20%20%20%20%20%20if%20(document.getElementById('api-analyzer-container'))%20{%20%20%20%20%20%20%20%20%20document.getElementById('api-analyzer-container').remove();%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20container%20=%20Utils.createEl('div',%20{%20id:%20'api-analyzer-container'%20});%20%20%20%20%20%20%20container.style.cssText%20=%20styles.container;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%A8%A3%E5%BC%8F%E8%A1%A8%20%20%20%20%20%20%20const%20styleSheet%20=%20Utils.createEl('style',%20{%20id:%20'api-analyzer-styles'%20});%20%20%20%20%20%20%20styleSheet.textContent%20=%20styles.syntaxHighlight;%20%20%20%20%20%20%20container.appendChild(styleSheet);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E9%A1%8C%E6%AC%84%20%20%20%20%20%20%20const%20header%20=%20Utils.createEl('div',%20{},%20{},%20'API%20%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7');%20%20%20%20%20%20%20header.style.cssText%20=%20styles.header;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%8C%89%E9%88%95%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20buttonGroup%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'8px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E8%89%B2%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8F%9B%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20themeButton%20=%20Utils.createEl('button',%20{},%20{},%20STATE.settings.darkMode%20?%20'%E2%98%80%EF%B8%8F'%20:%20'%F0%9F%8C%99');%20%20%20%20%20%20%20themeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20themeButton.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.darkMode%20=%20!STATE.settings.darkMode;%20%20%20%20%20%20%20%20%20this.updateTheme();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E9%97%9C%E9%96%89%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20closeButton%20=%20Utils.createEl('button',%20{},%20{},%20'%E2%9C%95');%20%20%20%20%20%20%20closeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20closeButton.onclick%20=%20()%20=%3E%20container.remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%8C%89%E9%88%95%E5%88%B0%E6%8C%89%E9%88%95%E7%B5%84%20%20%20%20%20%20%20buttonGroup.appendChild(themeButton);%20%20%20%20%20%20%20buttonGroup.appendChild(closeButton);%20%20%20%20%20%20%20header.appendChild(buttonGroup);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%E6%AC%84%20%20%20%20%20%20%20const%20tabs%20=%20Utils.createEl('div');%20%20%20%20%20%20%20tabs.style.cssText%20=%20styles.tabs;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%9A%E7%BE%A9%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20const%20tabDefs%20=%20[%20%20%20%20%20%20%20%20%20{%20id:%20'endpoints',%20label:%20'API%E7%AB%AF%E9%BB%9E'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'tokens',%20label:%20'%E4%BB%A4%E7%89%8C'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'visualization',%20label:%20'%E8%A6%96%E8%A6%BA%E5%8C%96'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'settings',%20label:%20'%E8%A8%AD%E5%AE%9A'%20}%20%20%20%20%20%20%20];%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20tabDefs.forEach(tabDef%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20tab%20=%20Utils.createEl('div',%20{%20id:%20%60tab-${tabDef.id}%60%20},%20{},%20tabDef.label);%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20if%20(STATE.settings.activeTab%20===%20tabDef.id)%20{%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20+=%20styles.activeTab;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20tab.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20STATE.settings.activeTab%20=%20tabDef.id;%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E6%A8%99%E7%B1%A4%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22tab-%22]').forEach(t%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20t.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab%20+%20styles.activeTab;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22content-%22]').forEach(c%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20c.style.display%20=%20'none';%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20document.getElementById(%60content-${tabDef.id}%60).style.display%20=%20'block';%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20tabs.appendChild(tab);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20const%20content%20=%20Utils.createEl('div');%20%20%20%20%20%20%20content.style.cssText%20=%20styles.content;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B5%90%E6%9E%9C%E9%A1%AF%E7%A4%BA%E5%8D%80%E5%9F%9F%20(endpoints)%20%20%20%20%20%20%20const%20endpointsContent%20=%20Utils.createEl('div',%20{%20id:%20'content-endpoints'%20});%20%20%20%20%20%20%20endpointsContent.style.cssText%20=%20STATE.settings.activeTab%20===%20'endpoints'%20?%20styles.tabContent%20+%20styles.activeTabContent%20:%20styles.tabContent;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E5%92%8C%E9%81%8E%E6%BF%BE%E6%A2%9D%E4%BB%B6%20%20%20%20%20%20%20const%20filterBar%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'10px',%20marginBottom:%20'10px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E6%A1%86%20%20%20%20%20%20%20const%20searchInput%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'text',%20%20%20%20%20%20%20%20%20%20placeholder:%20'%E6%90%9C%E5%B0%8BAPI%E7%AB%AF%E9%BB%9E...',%20%20%20%20%20%20%20%20%20value:%20STATE.settings.filterText%20%20%20%20%20%20%20});%20%20%20%20%20%20%20searchInput.style.cssText%20=%20styles.input;%20%20%20%20%20%20%20searchInput.style.flex%20=%20'1';%20%20%20%20%20%20%20searchInput.onkeyup%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.filterText%20=%20e.target.value;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4%E9%81%B8%E9%A0%85%20%20%20%20%20%20%20const%20errorFilterContainer%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20alignItems:%20'center'%20});%20%20%20%20%20%20%20const%20errorFilterCheck%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'checkbox',%20%20%20%20%20%20%20%20%20id:%20'show-errors-only',%20%20%20%20%20%20%20%20%20checked:%20STATE.settings.showOnlyErrors%20%20%20%20%20%20%20});%20%20%20%20%20%20%20errorFilterCheck.style.cssText%20=%20styles.checkbox;%20%20%20%20%20%20%20errorFilterCheck.onchange%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.showOnlyErrors%20=%20e.target.checked;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20errorFilterLabel%20=%20Utils.createEl('label',%20{%20for:%20'show-errors-only'%20},%20{},%20'%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4');%20%20%20%20%20%20%20errorFilterLabel.style.cssText%20=%20styles.label;%20%20%20%20%20%20%20errorFilterLabel.style.marginBottom%20=%20'0';%20%20%20%20%20%20%20%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterCheck);%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterLabel);%20%20%20%20%20%20%20%20%20%20%20%20%20%20filterBar.appendChild(searchInput);%20%20%20%20%20%20%20filterBar.appendChild(errorFilterContainer);%20%20%20%20%20%20%20%20%20%20%20%20%20%20endpointsContent.appendChild(filterBar);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20API%E7%AB%AF%E9%BB%9E%E5%88%97%E8%A1%A8%20%20%20%20%20%20%20const%20endpointsList%20=%20Utils.createEl('div',%20{%20id:%20'endpoints-list'%20});%20%20%20%20%20%20%20endpointsC
＊＊＊＊＊第53段程式碼結束/183優化版本 /＊＊＊＊＊




＊＊＊＊＊第54段程式碼開始/184優化版本 /＊＊＊＊＊
javascript:(function(){   // %E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE   const CONFIG = {     maxApiEntries: 100,       // %E6%9C%80%E5%A4%A7API%E8%A8%98%E9%8C%84%E6%95%B8%E9%87%8F     maxTokenDisplay: 10,      // %E4%BB%A4%E7%89%8C%E9%A1%AF%E7%A4%BA%E9%95%B7%E5%BA%A6     refreshInterval: 1000,    // UI%E6%9B%B4%E6%96%B0%E9%96%93%E9%9A%94(ms)     theme: {       light: {         bg: '#fff',%20%20%20%20%20%20%20%20%20text:%20'#333',%20%20%20%20%20%20%20%20%20primary:%20'#4a6cf7',%20%20%20%20%20%20%20%20%20secondary:%20'#f0f2f5',%20%20%20%20%20%20%20%20%20border:%20'#ddd'%20%20%20%20%20%20%20},%20%20%20%20%20%20%20dark:%20{%20%20%20%20%20%20%20%20%20bg:%20'#1f2937',%20%20%20%20%20%20%20%20%20text:%20'#f3f4f6',%20%20%20%20%20%20%20%20%20primary:%20'#3b82f6',%20%20%20%20%20%20%20%20%20secondary:%20'#374151',%20%20%20%20%20%20%20%20%20border:%20'#4b5563'%20%20%20%20%20%20%20}%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20%E5%85%A8%E5%B1%80%E7%8B%80%E6%85%8B%20%20%20const%20STATE%20=%20{%20%20%20%20%20apiInfo:%20{%20%20%20%20%20%20%20endpoints:%20[],%20%20%20%20%20%20%20tokens:%20[],%20%20%20%20%20%20%20page:%20window.location.href,%20%20%20%20%20%20%20title:%20document.title,%20%20%20%20%20%20%20timestamp:%20new%20Date().toISOString()%20%20%20%20%20},%20%20%20%20%20settings:%20{%20%20%20%20%20%20%20darkMode:%20window.matchMedia('(prefers-color-scheme:%20dark)').matches,%20%20%20%20%20%20%20maskTokens:%20true,%20%20%20%20%20%20%20filterText:%20'',%20%20%20%20%20%20%20showOnlyErrors:%20false,%20%20%20%20%20%20%20sortBy:%20'time',%20//%20'time',%20'url',%20'method',%20'status'%20%20%20%20%20%20%20groupBy:%20'none',%20//%20'none',%20'endpoint',%20'status'%20%20%20%20%20%20%20activeTab:%20'endpoints'%20//%20'endpoints',%20'tokens',%20'visualization',%20'settings'%20%20%20%20%20},%20%20%20%20%20wsConnections:%20new%20Set(),%20%20%20%20%20interceptedWebsockets:%200,%20%20%20%20%20interceptedXHR:%200,%20%20%20%20%20interceptedFetch:%200,%20%20%20%20%20showLabels:%20true,%20%20%20%20%20showHeaders:%20false,%20%20%20%20%20expandedItems:%20new%20Set(),%20%20%20%20%20selectedRequestForReplay:%20null%20%20%20};%20%20%20%20//%20%E5%B7%A5%E5%85%B7%E9%A1%9E%E5%87%BD%E6%95%B8%20%20%20const%20Utils%20=%20{%20%20%20%20%20//%20DOM%E6%93%8D%E4%BD%9C%20%20%20%20%20createEl(tag,%20attributes%20=%20{},%20styles%20=%20{},%20innerHTML%20=%20'')%20{%20%20%20%20%20%20%20const%20el%20=%20document.createElement(tag);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%B1%AC%E6%80%A7%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(attributes))%20{%20%20%20%20%20%20%20%20%20if%20(key%20===%20'className')%20{%20%20%20%20%20%20%20%20%20%20%20el.className%20=%20value;%20%20%20%20%20%20%20%20%20}%20else%20if%20(key%20===%20'dataset')%20{%20%20%20%20%20%20%20%20%20%20%20for%20(const%20[dataKey,%20dataValue]%20of%20Object.entries(value))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20el.dataset[dataKey]%20=%20dataValue;%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20el.setAttribute(key,%20value);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20Object.entries(styles))%20{%20%20%20%20%20%20%20%20%20el.style[key]%20=%20value;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%AD%E7%BD%AE%E5%85%A7%E5%AE%B9%20%20%20%20%20%20%20if%20(innerHTML)%20{%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20innerHTML;%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20el;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E4%BA%8B%E4%BB%B6%E7%9B%A3%E8%81%BD%E7%B0%A1%E5%8C%96%E7%89%88%20%20%20%20%20on(el,%20event,%20handler)%20{%20%20%20%20%20%20%20el.addEventListener(event,%20handler);%20%20%20%20%20%20%20return%20()%20=%3E%20el.removeEventListener(event,%20handler);%20//%20%E8%BF%94%E5%9B%9E%E7%A7%BB%E9%99%A4%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%87%BD%E6%95%B8%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E5%BA%A6%E8%A4%87%E8%A3%BD%E5%B0%8D%E8%B1%A1%20%20%20%20%20deepClone(obj)%20{%20%20%20%20%20%20%20return%20JSON.parse(JSON.stringify(obj));%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%A5%E6%9C%9F%20%20%20%20%20formatDate(date)%20{%20%20%20%20%20%20%20return%20new%20Date(date).toLocaleString();%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%89%E5%85%A8%E5%9C%B0%E8%A7%A3%E6%9E%90JSON%20%20%20%20%20parseJSON(str)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20return%20JSON.parse(str);%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20str;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96JSON%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20formatJSON(obj)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(typeof%20obj%20===%20'string')%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(JSON.parse(obj),%20null,%202);%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20return%20JSON.stringify(obj,%20null,%202);%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20String(obj);%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%88%AA%E6%96%B7%E9%95%B7%E5%AD%97%E7%AC%A6%E4%B8%B2%20%20%20%20%20truncate(str,%20length%20=%20100)%20{%20%20%20%20%20%20%20if%20(!str)%20return%20'';%20%20%20%20%20%20%20str%20=%20String(str);%20%20%20%20%20%20%20return%20str.length%20%3C=%20length%20?%20str%20:%20%60${str.substring(0,%20length)}...%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%81%AE%E8%94%BD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%20%20%20%20%20maskSensitive(str,%20showChars%20=%204)%20{%20%20%20%20%20%20%20if%20(!str%20||%20str.length%20%3C=%20showChars%20*%202)%20return%20str;%20%20%20%20%20%20%20return%20%60${str.substring(0,%20showChars)}...${str.substring(str.length%20-%20showChars)}%60;%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%A0%BC%E5%BC%8F%E5%8C%96URL%EF%BC%88%E7%A7%BB%E9%99%A4%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%EF%BC%89%20%20%20%20%20formatURL(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20return%20%60${urlObj.origin}${urlObj.pathname}%60;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20url;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E6%8F%90%E5%8F%96URL%E7%9A%84%E6%9F%A5%E8%A9%A2%E5%8F%83%E6%95%B8%20%20%20%20%20getURLParams(url)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20const%20params%20=%20{};%20%20%20%20%20%20%20%20%20const%20urlObj%20=%20new%20URL(url);%20%20%20%20%20%20%20%20%20for%20(const%20[key,%20value]%20of%20urlObj.searchParams.entries())%20{%20%20%20%20%20%20%20%20%20%20%20params[key]%20=%20value;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20params;%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20return%20{};%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E9%AB%98%E4%BA%AEJSON%20%20%20%20%20syntaxHighlight(json)%20{%20%20%20%20%20%20%20if%20(!json)%20return%20'';%20%20%20%20%20%20%20json%20=%20json.replace(/&/g,%20'&').replace(/%3C/g,%20'%3C').replace(/%3E/g,%20'%3E');%20%20%20%20%20%20%20return%20json.replace(/(%22(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\%22])*%22(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,%20function%20(match)%20{%20%20%20%20%20%20%20%20%20let%20cls%20=%20'number';%20%20%20%20%20%20%20%20%20if%20(/^%22/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20if%20(/:$/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'key';%20%20%20%20%20%20%20%20%20%20%20}%20else%20{%20%20%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'string';%20%20%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20}%20else%20if%20(/true|false/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'boolean';%20%20%20%20%20%20%20%20%20}%20else%20if%20(/null/.test(match))%20{%20%20%20%20%20%20%20%20%20%20%20cls%20=%20'null';%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20return%20'%3Cspan%20class=%22'%20+%20cls%20+%20'%22%3E'%20+%20match%20+%20'%3C/span%3E';%20%20%20%20%20%20%20});%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BCJWT%E4%BB%A4%E7%89%8C%20%20%20%20%20decodeJWT(token)%20{%20%20%20%20%20%20%20try%20{%20%20%20%20%20%20%20%20%20if%20(!token%20||%20typeof%20token%20!==%20'string'%20||%20!token.includes('.'))%20{%20%20%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%88%86%E5%89%B2%E4%BB%A4%E7%89%8C%20%20%20%20%20%20%20%20%20const%20parts%20=%20token.split('.');%20%20%20%20%20%20%20%20%20if%20(parts.length%20!==%203)%20return%20null;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A7%A3%E7%A2%BC%E6%AF%8F%E5%80%8B%E9%83%A8%E5%88%86%20%20%20%20%20%20%20%20%20const%20header%20=%20JSON.parse(atob(parts[0]));%20%20%20%20%20%20%20%20%20const%20payload%20=%20JSON.parse(atob(parts[1]));%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E9%81%8E%E6%9C%9F%E6%99%82%E9%96%93%20%20%20%20%20%20%20%20%20let%20isExpired%20=%20false;%20%20%20%20%20%20%20%20%20if%20(payload.exp)%20{%20%20%20%20%20%20%20%20%20%20%20isExpired%20=%20Date.now()%20%3E=%20payload.exp%20*%201000;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20%20%20header,%20%20%20%20%20%20%20%20%20%20%20payload,%20%20%20%20%20%20%20%20%20%20%20isExpired,%20%20%20%20%20%20%20%20%20%20%20expiresAt:%20payload.exp%20?%20new%20Date(payload.exp%20*%201000).toLocaleString()%20:%20'Unknown'%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20}%20catch%20(e)%20{%20%20%20%20%20%20%20%20%20console.error('JWT%E8%A7%A3%E7%A2%BC%E5%A4%B1%E6%95%97:',%20e);%20%20%20%20%20%20%20%20%20return%20null;%20%20%20%20%20%20%20}%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E7%B0%A1%E5%96%AE%E7%9A%84%E5%9C%96%E8%A1%A8%20%20%20%20%20createBarChart(data,%20labels,%20options%20=%20{})%20{%20%20%20%20%20%20%20const%20{%20width%20=%20300,%20height%20=%20200,%20barColor%20=%20'#4a6cf7'%20}%20=%20options;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9C%80%E5%A4%A7%E5%80%BC%E8%A8%88%E7%AE%97%20%20%20%20%20%20%20const%20maxValue%20=%20Math.max(...data);%20%20%20%20%20%20%20const%20svg%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'svg');%20%20%20%20%20%20%20svg.setAttribute('width',%20width);%20%20%20%20%20%20%20svg.setAttribute('height',%20height);%20%20%20%20%20%20%20svg.style.overflow%20=%20'visible';%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E8%A8%88%E7%AE%97bar%E7%9A%84%E5%AF%AC%E5%BA%A6%E5%92%8C%E9%96%93%E8%B7%9D%20%20%20%20%20%20%20const%20barWidth%20=%20(width%20/%20data.length)%20*%200.7;%20%20%20%20%20%20%20const%20barGap%20=%20(width%20/%20data.length)%20*%200.3;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BD%E6%AF%8F%E5%80%8Bbar%20%20%20%20%20%20%20data.forEach((value,%20i)%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20barHeight%20=%20(value%20/%20maxValue)%20*%20(height%20-%2030);%20%20%20%20%20%20%20%20%20const%20x%20=%20i%20*%20(barWidth%20+%20barGap);%20%20%20%20%20%20%20%20%20const%20y%20=%20height%20-%20barHeight%20-%2020;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B9%AA%E8%A3%BDbar%20%20%20%20%20%20%20%20%20const%20bar%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'rect');%20%20%20%20%20%20%20%20%20bar.setAttribute('x',%20x);%20%20%20%20%20%20%20%20%20bar.setAttribute('y',%20y);%20%20%20%20%20%20%20%20%20bar.setAttribute('width',%20barWidth);%20%20%20%20%20%20%20%20%20bar.setAttribute('height',%20barHeight);%20%20%20%20%20%20%20%20%20bar.setAttribute('fill',%20barColor);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%95%B8%E5%80%BC%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20text%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20text.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20text.setAttribute('y',%20y%20-%205);%20%20%20%20%20%20%20%20%20text.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20text.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20text.textContent%20=%20value;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0x%E8%BB%B8%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20%20%20const%20label%20=%20document.createElementNS('http://www.w3.org/2000/svg',%20'text');%20%20%20%20%20%20%20%20%20label.setAttribute('x',%20x%20+%20barWidth%20/%202);%20%20%20%20%20%20%20%20%20label.setAttribute('y',%20height%20-%205);%20%20%20%20%20%20%20%20%20label.setAttribute('text-anchor',%20'middle');%20%20%20%20%20%20%20%20%20label.setAttribute('font-size',%20'10');%20%20%20%20%20%20%20%20%20label.textContent%20=%20labels[i]%20||%20'';%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20svg.appendChild(bar);%20%20%20%20%20%20%20%20%20svg.appendChild(text);%20%20%20%20%20%20%20%20%20svg.appendChild(label);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20svg;%20%20%20%20%20}%20%20%20};%20%20%20%20%20%20//%20UI%E6%A7%8B%E5%BB%BA%E5%99%A8%20%20%20const%20UI%20=%20{%20%20%20%20%20//%20%E5%9F%BA%E6%9C%ACUI%E5%85%83%E7%B4%A0%E6%A8%A3%E5%BC%8F%20%20%20%20%20getStyles(darkMode)%20{%20%20%20%20%20%20%20const%20theme%20=%20darkMode%20?%20CONFIG.theme.dark%20:%20CONFIG.theme.light;%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20{%20%20%20%20%20%20%20%20%20container:%20%60%20%20%20%20%20%20%20%20%20%20%20position:%20fixed;%20%20%20%20%20%20%20%20%20%20%20top:%2020px;%20%20%20%20%20%20%20%20%20%20%20right:%2020px;%20%20%20%20%20%20%20%20%20%20%20width:%20400px;%20%20%20%20%20%20%20%20%20%20%20max-height:%2080vh;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20border-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20box-shadow:%200%200%2020px%20rgba(0,0,0,0.3);%20%20%20%20%20%20%20%20%20%20%20z-index:%209999999;%20%20%20%20%20%20%20%20%20%20%20font-family:%20sans-serif;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-direction:%20column;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.3s%20ease;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20header:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%2015px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20cursor:%20move;%20%20%20%20%20%20%20%20%20%20%20user-select:%20none;%20%20%20%20%20%20%20%20%20%20%20border-top-left-radius:%208px;%20%20%20%20%20%20%20%20%20%20%20border-top-right-radius:%208px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20content:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2015px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20flex-grow:%201;%20%20%20%20%20%20%20%20%20%20%20max-height:%20calc(80vh%20-%20110px);%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabs:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tab:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2015px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTab:%20%60%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20border-bottom:%202px%20solid%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20button:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20smallButton:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%202px%208px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.primary};%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20transition:%20all%200.2s;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panel:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20overflow:%20hidden;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelHeader:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%208px%2012px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20align-items:%20center;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20panelContent:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20line-height:%201.5;%20%20%20%20%20%20%20%20%20%20%20border-top:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20input:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%2095%;%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20select:%20%60%20%20%20%20%20%20%20%20%20%20%20padding:%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%204px;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20label:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20checkbox:%20%60%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20jsonView:%20%60%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20font-size:%2011px;%20%20%20%20%20%20%20%20%20%20%20padding:%205px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%203px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20200px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20badge:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-weight:%20bold;%20%20%20%20%20%20%20%20%20%20%20margin-right:%205px;%20%20%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20actionBar:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20flex-wrap:%20wrap;%20%20%20%20%20%20%20%20%20%20%20gap:%208px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20tabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20none;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px%200;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20activeTabContent:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20block;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20resultText:%20%60%20%20%20%20%20%20%20%20%20%20%20width:%20100%;%20%20%20%20%20%20%20%20%20%20%20min-height:%20100px;%20%20%20%20%20%20%20%20%20%20%20max-height:%20400px;%20%20%20%20%20%20%20%20%20%20%20overflow-y:%20auto;%20%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20${theme.border};%20%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%20%20%20%20%20%20%20%20%20%20%20padding:%2010px;%20%20%20%20%20%20%20%20%20%20%20font-family:%20monospace;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2015px;%20%20%20%20%20%20%20%20%20%20%20white-space:%20pre-wrap;%20%20%20%20%20%20%20%20%20%20%20word-break:%20break-all;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.bg};%20%20%20%20%20%20%20%20%20%20%20color:%20${theme.text};%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20infoRow:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20flex;%20%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2012px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20chip:%20%60%20%20%20%20%20%20%20%20%20%20%20display:%20inline-block;%20%20%20%20%20%20%20%20%20%20%20padding:%202px%206px;%20%20%20%20%20%20%20%20%20%20%20background-color:%20${theme.secondary};%20%20%20%20%20%20%20%20%20%20%20border-radius:%2012px;%20%20%20%20%20%20%20%20%20%20%20font-size:%2010px;%20%20%20%20%20%20%20%20%20%20%20margin-right:%204px;%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%204px;%20%20%20%20%20%20%20%20%20%60,%20%20%20%20%20%20%20%20%20//%20%E8%AA%9E%E6%B3%95%E9%AB%98%E4%BA%AE%20%20%20%20%20%20%20%20%20syntaxHighlight:%20%60%20%20%20%20%20%20%20%20%20%20%20.string%20{%20color:%20#28a745;%20}%20%20%20%20%20%20%20%20%20%20%20.number%20{%20color:%20#17a2b8;%20}%20%20%20%20%20%20%20%20%20%20%20.boolean%20{%20color:%20#6f42c1;%20}%20%20%20%20%20%20%20%20%20%20%20.null%20{%20color:%20#dc3545;%20}%20%20%20%20%20%20%20%20%20%20%20.key%20{%20color:%20#007bff;%20}%20%20%20%20%20%20%20%20%20%60%20%20%20%20%20%20%20};%20%20%20%20%20},%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E8%A6%81UI%20%20%20%20%20createMainUI()%20{%20%20%20%20%20%20%20const%20styles%20=%20this.getStyles(STATE.settings.darkMode);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%AA%A2%E6%9F%A5%E6%98%AF%E5%90%A6%E5%B7%B2%E7%B6%93%E5%AD%98%E5%9C%A8%20%20%20%20%20%20%20if%20(document.getElementById('api-analyzer-container'))%20{%20%20%20%20%20%20%20%20%20document.getElementById('api-analyzer-container').remove();%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E4%B8%BB%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20container%20=%20Utils.createEl('div',%20{%20id:%20'api-analyzer-container'%20});%20%20%20%20%20%20%20container.style.cssText%20=%20styles.container;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%A8%A3%E5%BC%8F%E8%A1%A8%20%20%20%20%20%20%20const%20styleSheet%20=%20Utils.createEl('style',%20{%20id:%20'api-analyzer-styles'%20});%20%20%20%20%20%20%20styleSheet.textContent%20=%20styles.syntaxHighlight;%20%20%20%20%20%20%20container.appendChild(styleSheet);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E9%A1%8C%E6%AC%84%20%20%20%20%20%20%20const%20header%20=%20Utils.createEl('div',%20{},%20{},%20'API%20%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7');%20%20%20%20%20%20%20header.style.cssText%20=%20styles.header;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%8C%89%E9%88%95%E5%AE%B9%E5%99%A8%20%20%20%20%20%20%20const%20buttonGroup%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'8px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%B1%E8%89%B2%E6%A8%A1%E5%BC%8F%E5%88%87%E6%8F%9B%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20themeButton%20=%20Utils.createEl('button',%20{},%20{},%20STATE.settings.darkMode%20?%20'%E2%98%80%EF%B8%8F'%20:%20'%F0%9F%8C%99');%20%20%20%20%20%20%20themeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20themeButton.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.darkMode%20=%20!STATE.settings.darkMode;%20%20%20%20%20%20%20%20%20this.updateTheme();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E9%97%9C%E9%96%89%E6%8C%89%E9%88%95%20%20%20%20%20%20%20const%20closeButton%20=%20Utils.createEl('button',%20{},%20{},%20'%E2%9C%95');%20%20%20%20%20%20%20closeButton.style.cssText%20=%20%60%20%20%20%20%20%20%20%20%20background:%20none;%20%20%20%20%20%20%20%20%20border:%20none;%20%20%20%20%20%20%20%20%20color:%20white;%20%20%20%20%20%20%20%20%20font-size:%2016px;%20%20%20%20%20%20%20%20%20cursor:%20pointer;%20%20%20%20%20%20%20%20%20padding:%200%205px;%20%20%20%20%20%20%20%60;%20%20%20%20%20%20%20closeButton.onclick%20=%20()%20=%3E%20container.remove();%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%B7%BB%E5%8A%A0%E6%8C%89%E9%88%95%E5%88%B0%E6%8C%89%E9%88%95%E7%B5%84%20%20%20%20%20%20%20buttonGroup.appendChild(themeButton);%20%20%20%20%20%20%20buttonGroup.appendChild(closeButton);%20%20%20%20%20%20%20header.appendChild(buttonGroup);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%E6%AC%84%20%20%20%20%20%20%20const%20tabs%20=%20Utils.createEl('div');%20%20%20%20%20%20%20tabs.style.cssText%20=%20styles.tabs;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%AE%9A%E7%BE%A9%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20const%20tabDefs%20=%20[%20%20%20%20%20%20%20%20%20{%20id:%20'endpoints',%20label:%20'API%E7%AB%AF%E9%BB%9E'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'tokens',%20label:%20'%E4%BB%A4%E7%89%8C'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'visualization',%20label:%20'%E8%A6%96%E8%A6%BA%E5%8C%96'%20},%20%20%20%20%20%20%20%20%20{%20id:%20'settings',%20label:%20'%E8%A8%AD%E5%AE%9A'%20}%20%20%20%20%20%20%20];%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E6%A8%99%E7%B1%A4%20%20%20%20%20%20%20tabDefs.forEach(tabDef%20=%3E%20{%20%20%20%20%20%20%20%20%20const%20tab%20=%20Utils.createEl('div',%20{%20id:%20%60tab-${tabDef.id}%60%20},%20{},%20tabDef.label);%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20if%20(STATE.settings.activeTab%20===%20tabDef.id)%20{%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20+=%20styles.activeTab;%20%20%20%20%20%20%20%20%20}%20%20%20%20%20%20%20%20%20tab.onclick%20=%20()%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20STATE.settings.activeTab%20=%20tabDef.id;%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E6%A8%99%E7%B1%A4%E6%A8%A3%E5%BC%8F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22tab-%22]').forEach(t%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20t.style.cssText%20=%20styles.tab;%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20tab.style.cssText%20=%20styles.tab%20+%20styles.activeTab;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%9B%B4%E6%96%B0%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('[id^=%22content-%22]').forEach(c%20=%3E%20{%20%20%20%20%20%20%20%20%20%20%20%20%20c.style.display%20=%20'none';%20%20%20%20%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20document.getElementById(%60content-${tabDef.id}%60).style.display%20=%20'block';%20%20%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20tabs.appendChild(tab);%20%20%20%20%20%20%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%89%B5%E5%BB%BA%E5%85%A7%E5%AE%B9%E5%8D%80%E5%9F%9F%20%20%20%20%20%20%20const%20content%20=%20Utils.createEl('div');%20%20%20%20%20%20%20content.style.cssText%20=%20styles.content;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E7%B5%90%E6%9E%9C%E9%A1%AF%E7%A4%BA%E5%8D%80%E5%9F%9F%20(endpoints)%20%20%20%20%20%20%20const%20endpointsContent%20=%20Utils.createEl('div',%20{%20id:%20'content-endpoints'%20});%20%20%20%20%20%20%20endpointsContent.style.cssText%20=%20STATE.settings.activeTab%20===%20'endpoints'%20?%20styles.tabContent%20+%20styles.activeTabContent%20:%20styles.tabContent;%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E5%92%8C%E9%81%8E%E6%BF%BE%E6%A2%9D%E4%BB%B6%20%20%20%20%20%20%20const%20filterBar%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20gap:%20'10px',%20marginBottom:%20'10px'%20});%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E6%90%9C%E5%B0%8B%E6%A1%86%20%20%20%20%20%20%20const%20searchInput%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'text',%20%20%20%20%20%20%20%20%20%20placeholder:%20'%E6%90%9C%E5%B0%8BAPI%E7%AB%AF%E9%BB%9E...',%20%20%20%20%20%20%20%20%20value:%20STATE.settings.filterText%20%20%20%20%20%20%20});%20%20%20%20%20%20%20searchInput.style.cssText%20=%20styles.input;%20%20%20%20%20%20%20searchInput.style.flex%20=%20'1';%20%20%20%20%20%20%20searchInput.onkeyup%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.filterText%20=%20e.target.value;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4%E9%81%B8%E9%A0%85%20%20%20%20%20%20%20const%20errorFilterContainer%20=%20Utils.createEl('div',%20{},%20{%20display:%20'flex',%20alignItems:%20'center'%20});%20%20%20%20%20%20%20const%20errorFilterCheck%20=%20Utils.createEl('input',%20{%20%20%20%20%20%20%20%20%20%20type:%20'checkbox',%20%20%20%20%20%20%20%20%20id:%20'show-errors-only',%20%20%20%20%20%20%20%20%20checked:%20STATE.settings.showOnlyErrors%20%20%20%20%20%20%20});%20%20%20%20%20%20%20errorFilterCheck.style.cssText%20=%20styles.checkbox;%20%20%20%20%20%20%20errorFilterCheck.onchange%20=%20(e)%20=%3E%20{%20%20%20%20%20%20%20%20%20STATE.settings.showOnlyErrors%20=%20e.target.checked;%20%20%20%20%20%20%20%20%20this.renderEndpoints();%20%20%20%20%20%20%20};%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20errorFilterLabel%20=%20Utils.createEl('label',%20{%20for:%20'show-errors-only'%20},%20{},%20'%E5%8F%AA%E9%A1%AF%E7%A4%BA%E9%8C%AF%E8%AA%A4');%20%20%20%20%20%20%20errorFilterLabel.style.cssText%20=%20styles.label;%20%20%20%20%20%20%20errorFilterLabel.style.marginBottom%20=%20'0';%20%20%20%20%20%20%20%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterCheck);%20%20%20%20%20%20%20errorFilterContainer.appendChild(errorFilterLabel);%20%20%20%20%20%20%20%20%20%20%20%20%20%20filterBar.appendChild(searchInput);%20%20%20%20%20%20%20filterBar.appendChild(errorFilterContainer);%20%20%20%20%20%20%20%20%20%20%20%20%20%20endpointsContent.appendChild(filterBar);%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20API%E7%AB%AF%E9%BB%9E%E5%88%97%E8%A1%A8%20%20%20%20%20%20%20const%20endpointsList%20=%20Utils.createEl('div',%20{%20id:%20'endpoints-list'%20});%20%20%20%20%20%20%20endpoi
＊＊＊＊＊第54段程式碼結束/184優化版本 /＊＊＊＊＊
